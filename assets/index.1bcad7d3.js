var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,i=(e,i)=>{for(var s in i||(i={}))a.call(i,s)&&o(e,s,i[s]);if(t)for(var s of t(i))n.call(i,s)&&o(e,s,i[s]);return e};import{_ as s,d as r,c,r as l,w as d,a as p,g as u,n as m,t as w,m as h,l as v,G as g,o as y}from"./index.cb85f683.js";function f(e){return e.includes("风")?["龙卷风","狂爆风","飓风","热带风暴"].includes(e)?"龙卷风":"风":e.includes("霾")||e.includes("雾")?["重","大","浓","沙","尘"].some((t=>e.includes(t)))?"大雾":"小雾":e.includes("雨")?e.includes("雷")?"雷阵雨":e.includes("雪")?"雨夹雪":e.includes("大")||e.includes("暴")?"大雨":"小雨":e.includes("雪")?"雪":e}const S={"晴":"clear-day","少云":"cloudy","晴间多云":"overcast-day","多云":"overcast","阴":"overcast","平静":"overcast","风":"wind","龙卷风":"hurricane","大雾":"fog","小雾":"mist","雷阵雨":"thunderstorms-rain","大雨":"rain","小雨":"drizzle","雨夹雪":"sleet","雪":"snow","热":"high","冷":"low","未知":"new-moon"};const b=r({name:"Weather",props:{componentSetting:{type:Object,required:!0}},setup(e){const t=c((()=>h(e.componentSetting.position))),a=l(""),n=l(""),o=l("https://cdn.jsdelivr.net/gh/leon-kfd/weather-icons/production/line/all/clear-day.svg"),i=l("24"),s=l("未知"),r=async()=>{const e=await fetch(`${v}/tapi/amap/v3/weather/weatherInfo?extensions=base&city=${n.value}`),{status:t,lives:a}=await e.json();if("1"===t){const{weather:e,temperature:t}=a[0];o.value=function(e){const t=f(e)||"未知";return`https://cdn.jsdelivr.net/gh/leon-kfd/weather-icons/production/line/all/${S[t]||"new-moon"}.svg`}(e),s.value=f(e),i.value=t}};return d((()=>[e.componentSetting.weatherMode,e.componentSetting.cityName]),(async()=>{try{if(1===e.componentSetting.weatherMode){const e=await fetch(`${v}/tapi/amap/v3/ip`),{status:t,adcode:o,city:i}=await e.json();"1"===t&&(a.value=i.replace(/[市城区]/g,""),n.value=o)}else{const t=await fetch(`${v}/tapi/amap/v3/config/district?keywords=${e.componentSetting.cityName}&subdistrict=0`),{status:o,districts:i}=await t.json();if("1"===o&&i.length>0){const e=i.find((e=>"city"===e.level)),{adcode:t,name:o}=e;a.value=o.replace(/[市城区]/g,""),n.value=t}}}catch{g({title:"提示",type:"error",message:"无法识别出城市，请重新配置"})}r()}),{immediate:!0}),{positionCSS:t,cityName:a,adcode:n,weatherIcon:o,weatherText:s,temperature:i}}}),x={class:"weather-box"},j={class:"weather-icon-wrapper"},O=["src"],$={class:"weather-text-wrapper"},I={class:"temperature"},z={class:"city"};var N=s(b,[["render",function(e,t,a,n,o,s){return y(),p("div",{class:"wrapper",style:m(i({fontSize:e.componentSetting.baseFontSize+"px",color:e.componentSetting.textColor,textShadow:e.componentSetting.textShadow,padding:e.componentSetting.padding+"px",fontFamily:e.componentSetting.fontFamily},e.positionCSS))},[u("div",x,[u("div",j,[u("img",{src:e.weatherIcon,style:m({filter:`drop-shadow(${e.componentSetting.iconShadow})`}),alt:"weather icon"},null,12,O)]),u("div",$,[u("div",I,w(e.temperature)+"°",1),u("div",z,w(e.cityName)+" | "+w(e.weatherText),1)])])],4)}],["__scopeId","data-v-20aa69b7"]]);export{N as default};
