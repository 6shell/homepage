import{d as e,L as t,c as n,r,f as o,M as i,o as s,a,n as c,b as l,N as u,C as f,_ as d,u as p,w as h,i as m,E as v}from"./index.78b2041b.js";import{l as g}from"./color.556e4bcb.js";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function y(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(t){i(t)}}function a(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function b(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function w(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n}const k=(e,t)=>"function"==typeof t?"[Function]":t,x=e=>JSON.stringify(e,k),S=()=>new Error("Stack over flow, cannot pop on an empty stack."),C=()=>new Error("It seems that no theme found in editor, please make sure you have use theme in front of all plugins.\nIf you prefer to use an empty theme, you can use `themeFactory({})`."),M=()=>{const e=new Map;return{getSlice:t=>{const n=e.get(t.id);if(!n)throw r=t.sliceName,new Error(`Context "${r}" not found, do you forget to inject it?`);var r;return n},sliceMap:e}},O=(e,t)=>{const n=Symbol("Context"),r=(t,r=(e=>Array.isArray(e)?[...e]:"object"==typeof e?Object.assign({},e):e)(e))=>{let o=r;const i={id:n,set:e=>{o=e},get:()=>o,update:e=>{o=e(o)}};return t.set(n,i),i};return r.sliceName=t,r.id=n,r._typeInfo=()=>{throw new Error("Should not call a context out of the plugin.")},r};var A,E,T,N;class D{constructor(e,t){A.set(this,void 0),E.set(this,void 0),this.use=e=>b(this,A,"f").getSlice(e),this.get=e=>this.use(e).get(),this.set=(e,t)=>this.use(e).set(t),this.update=(e,t)=>this.use(e).update(t),this.timing=e=>b(this,E,"f").get(e),this.wait=e=>this.timing(e)(),this.done=e=>this.timing(e).done(),this.waitTimers=e=>y(this,void 0,void 0,(function*(){yield Promise.all(this.get(e).map((e=>this.wait(e))))})),w(this,A,e,"f"),w(this,E,t,"f")}}A=new WeakMap,E=new WeakMap;class z{constructor(e,t){T.set(this,void 0),N.set(this,void 0),this.inject=(e,t)=>(e(b(this,T,"f").sliceMap,t),this),this.record=e=>(e(b(this,N,"f").store),this),w(this,T,e,"f"),w(this,N,t,"f")}}T=new WeakMap,N=new WeakMap;const I=()=>{const e=new Map;return{store:e,get:t=>{const n=e.get(t.id);if(!n)throw new Error("Timer not found, do you forget to record it?");return n}}},$=(e,t=3e3)=>{const n=Symbol("Timer"),r=r=>{const o=Symbol(e),i=()=>new Promise(((n,r)=>{setTimeout((()=>{r(`Timing ${e} timeout.`)}),t),addEventListener(e,(e=>{e instanceof CustomEvent&&e.detail.id===o&&n(void 0)}))}));return i.done=()=>{const t=new CustomEvent(e,{detail:{id:o}});dispatchEvent(t)},r.set(n,i),i};return r.id=n,r},R=(e,t,n)=>t[n?"nodes":"marks"][e],F=()=>{const e=e=>e.elements.length,t=t=>t.elements[e(t)-1];return{size:e,top:t,push:e=>n=>{var r;null===(r=t(e))||void 0===r||r.push(n)},open:e=>t=>{e.elements.push(t)},close:e=>{const t=e.elements.pop();if(!t)throw S();return t}}};function P(e){this.content=e}P.prototype={constructor:P,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,o=r.find(e),i=r.content.slice();return-1==o?i.push(n||e,t):(i[o+1]=t,n&&(i[o]=n)),new P(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new P(n)},addToStart:function(e,t){return new P([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new P(n)},addBefore:function(e,t,n){var r=this.remove(t),o=r.content.slice(),i=r.find(e);return o.splice(-1==i?o.length:i,0,t,n),new P(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=P.from(e)).size?new P(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=P.from(e)).size?new P(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=P.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},get size(){return this.content.length>>1}},P.from=function(e){if(e instanceof P)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new P(t)};var _=P;function j(e,t,n){for(var r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;var o=e.child(r),i=t.child(r);if(o!=i){if(!o.sameMarkup(i))return n;if(o.isText&&o.text!=i.text){for(var s=0;o.text[s]==i.text[s];s++)n++;return n}if(o.content.size||i.content.size){var a=j(o.content,i.content,n+1);if(null!=a)return a}n+=o.nodeSize}else n+=o.nodeSize}}function B(e,t,n,r){for(var o=e.childCount,i=t.childCount;;){if(0==o||0==i)return o==i?null:{a:n,b:r};var s=e.child(--o),a=t.child(--i),c=s.nodeSize;if(s!=a){if(!s.sameMarkup(a))return{a:n,b:r};if(s.isText&&s.text!=a.text){for(var l=0,u=Math.min(s.text.length,a.text.length);l<u&&s.text[s.text.length-l-1]==a.text[a.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(s.content.size||a.content.size){var f=B(s.content,a.content,n-1,r-1);if(f)return f}n-=c,r-=c}else n-=c,r-=c}}var L=function(e,t){if(this.content=e,this.size=t||0,null==t)for(var n=0;n<e.length;n++)this.size+=e[n].nodeSize},V={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};L.prototype.nodesBetween=function(e,t,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<t;i++){var a=this.content[i],c=s+a.nodeSize;if(c>e&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,e-l),Math.min(a.content.size,t-l),n,r+l)}s=c}},L.prototype.descendants=function(e){this.nodesBetween(0,this.size,e)},L.prototype.textBetween=function(e,t,n,r){var o="",i=!0;return this.nodesBetween(e,t,(function(s,a){s.isText?(o+=s.text.slice(Math.max(e,a)-a,t-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},L.prototype.append=function(e){if(!e.size)return this;if(!this.size)return e;var t=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new L(r,this.size+e.size)},L.prototype.cut=function(e,t){if(null==t&&(t=this.size),0==e&&t==this.size)return this;var n=[],r=0;if(t>e)for(var o=0,i=0;i<t;o++){var s=this.content[o],a=i+s.nodeSize;a>e&&((i<e||a>t)&&(s=s.isText?s.cut(Math.max(0,e-i),Math.min(s.text.length,t-i)):s.cut(Math.max(0,e-i-1),Math.min(s.content.size,t-i-1))),n.push(s),r+=s.nodeSize),i=a}return new L(n,r)},L.prototype.cutByIndex=function(e,t){return e==t?L.empty:0==e&&t==this.content.length?this:new L(this.content.slice(e,t))},L.prototype.replaceChild=function(e,t){var n=this.content[e];if(n==t)return this;var r=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new L(r,o)},L.prototype.addToStart=function(e){return new L([e].concat(this.content),this.size+e.nodeSize)},L.prototype.addToEnd=function(e){return new L(this.content.concat(e),this.size+e.nodeSize)},L.prototype.eq=function(e){if(this.content.length!=e.content.length)return!1;for(var t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0},V.firstChild.get=function(){return this.content.length?this.content[0]:null},V.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},V.childCount.get=function(){return this.content.length},L.prototype.child=function(e){var t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t},L.prototype.maybeChild=function(e){return this.content[e]},L.prototype.forEach=function(e){for(var t=0,n=0;t<this.content.length;t++){var r=this.content[t];e(r,n,t),n+=r.nodeSize}},L.prototype.findDiffStart=function(e,t){return void 0===t&&(t=0),j(this,e,t)},L.prototype.findDiffEnd=function(e,t,n){return void 0===t&&(t=this.size),void 0===n&&(n=e.size),B(this,e,t,n)},L.prototype.findIndex=function(e,t){if(void 0===t&&(t=-1),0==e)return q(0,e);if(e==this.size)return q(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position "+e+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=e)return o==e||t>0?q(n+1,o):q(n,r);r=o}},L.prototype.toString=function(){return"<"+this.toStringInner()+">"},L.prototype.toStringInner=function(){return this.content.join(", ")},L.prototype.toJSON=function(){return this.content.length?this.content.map((function(e){return e.toJSON()})):null},L.fromJSON=function(e,t){if(!t)return L.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new L(t.map(e.nodeFromJSON))},L.fromArray=function(e){if(!e.length)return L.empty;for(var t,n=0,r=0;r<e.length;r++){var o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new L(t||e,n)},L.from=function(e){if(!e)return L.empty;if(e instanceof L)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new L([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(L.prototype,V);var W={index:0,offset:0};function q(e,t){return W.index=e,W.offset=t,W}function H(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;var n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!H(e[r],t[r]))return!1}else{for(var o in e)if(!(o in t)||!H(e[o],t[o]))return!1;for(var i in t)if(!(i in e))return!1}return!0}L.empty=new L([],0);var J=function(e,t){this.type=e,this.attrs=t};function K(e){var t=Error.call(this,e);return t.__proto__=K.prototype,t}J.prototype.addToSet=function(e){for(var t,n=!1,r=0;r<e.length;r++){var o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t},J.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e},J.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1},J.prototype.eq=function(e){return this==e||this.type==e.type&&H(this.attrs,e.attrs)},J.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return e},J.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");var n=e.marks[t.type];if(!n)throw new RangeError("There is no mark type "+t.type+" in this schema");return n.create(t.attrs)},J.sameSet=function(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0},J.setFrom=function(e){if(!e||0==e.length)return J.none;if(e instanceof J)return[e];var t=e.slice();return t.sort((function(e,t){return e.type.rank-t.type.rank})),t},J.none=[],K.prototype=Object.create(Error.prototype),K.prototype.constructor=K,K.prototype.name="ReplaceError";var U=function(e,t,n){this.content=e,this.openStart=t,this.openEnd=n},G={size:{configurable:!0}};function Q(e,t,n){var r=e.findIndex(t),o=r.index,i=r.offset,s=e.maybeChild(o),a=e.findIndex(n),c=a.index,l=a.offset;if(i==t||s.isText){if(l!=n&&!e.child(c).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return e.replaceChild(o,s.copy(Q(s.content,t-i-1,n-i-1)))}function X(e,t,n,r){var o=e.findIndex(t),i=o.index,s=o.offset,a=e.maybeChild(i);if(s==t||a.isText)return r&&!r.canReplace(i,i,n)?null:e.cut(0,t).append(n).append(e.cut(t));var c=X(a.content,t-s-1,n);return c&&e.replaceChild(i,a.copy(c))}function Z(e,t,n){if(n.openStart>e.depth)throw new K("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new K("Inconsistent open depths");return Y(e,t,n,0)}function Y(e,t,n,r){var o=e.index(r),i=e.node(r);if(o==t.index(r)&&r<e.depth-n.openStart){var s=Y(e,t,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=r||t.depth!=r){var a=function(e,t){for(var n=t.depth-e.openStart,r=t.node(n).copy(e.content),o=n-1;o>=0;o--)r=t.node(o).copy(L.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(n,e);return oe(i,ie(e,a.start,a.end,t,r))}var c=e.parent,l=c.content;return oe(c,l.cut(0,e.parentOffset).append(n.content).append(l.cut(t.parentOffset)))}return oe(i,se(e,t,r))}function ee(e,t){if(!t.type.compatibleContent(e.type))throw new K("Cannot join "+t.type.name+" onto "+e.type.name)}function te(e,t,n){var r=e.node(n);return ee(r,t.node(n)),r}function ne(e,t){var n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function re(e,t,n,r){var o=(t||e).node(n),i=0,s=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(ne(e.nodeAfter,r),i++));for(var a=i;a<s;a++)ne(o.child(a),r);t&&t.depth==n&&t.textOffset&&ne(t.nodeBefore,r)}function oe(e,t){if(!e.type.validContent(t))throw new K("Invalid content for node "+e.type.name);return e.copy(t)}function ie(e,t,n,r,o){var i=e.depth>o&&te(e,t,o+1),s=r.depth>o&&te(n,r,o+1),a=[];return re(null,e,o,a),i&&s&&t.index(o)==n.index(o)?(ee(i,s),ne(oe(i,ie(e,t,n,r,o+1)),a)):(i&&ne(oe(i,se(e,t,o+1)),a),re(t,n,o,a),s&&ne(oe(s,se(n,r,o+1)),a)),re(r,null,o,a),new L(a)}function se(e,t,n){var r=[];(re(null,e,n,r),e.depth>n)&&ne(oe(te(e,t,n+1),se(e,t,n+1)),r);return re(t,null,n,r),new L(r)}G.size.get=function(){return this.content.size-this.openStart-this.openEnd},U.prototype.insertAt=function(e,t){var n=X(this.content,e+this.openStart,t,null);return n&&new U(n,this.openStart,this.openEnd)},U.prototype.removeBetween=function(e,t){return new U(Q(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)},U.prototype.eq=function(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd},U.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},U.prototype.toJSON=function(){if(!this.content.size)return null;var e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e},U.fromJSON=function(e,t){if(!t)return U.empty;var n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new U(L.fromJSON(e,t.content),n,r)},U.maxOpen=function(e,t){void 0===t&&(t=!0);for(var n=0,r=0,o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)r++;return new U(e,n,r)},Object.defineProperties(U.prototype,G),U.empty=new U(L.empty,0,0);var ae=function(e,t,n){this.pos=e,this.path=t,this.depth=t.length/3-1,this.parentOffset=n},ce={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};ae.prototype.resolveDepth=function(e){return null==e?this.depth:e<0?this.depth+e:e},ce.parent.get=function(){return this.node(this.depth)},ce.doc.get=function(){return this.node(0)},ae.prototype.node=function(e){return this.path[3*this.resolveDepth(e)]},ae.prototype.index=function(e){return this.path[3*this.resolveDepth(e)+1]},ae.prototype.indexAfter=function(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)},ae.prototype.start=function(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1},ae.prototype.end=function(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size},ae.prototype.before=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]},ae.prototype.after=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize},ce.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},ce.nodeAfter.get=function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r},ce.nodeBefore.get=function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)},ae.prototype.posAtIndex=function(e,t){t=this.resolveDepth(t);for(var n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1,o=0;o<e;o++)r+=n.child(o).nodeSize;return r},ae.prototype.marks=function(){var e=this.parent,t=this.index();if(0==e.content.size)return J.none;if(this.textOffset)return e.child(t).marks;var n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},ae.prototype.marksAcross=function(e){var t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;for(var n=t.marks,r=e.parent.maybeChild(e.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},ae.prototype.sharedDepth=function(e){for(var t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0},ae.prototype.blockRange=function(e,t){if(void 0===e&&(e=this),e.pos<this.pos)return e.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new de(this,e,n)},ae.prototype.sameParent=function(e){return this.pos-this.parentOffset==e.pos-e.parentOffset},ae.prototype.max=function(e){return e.pos>this.pos?e:this},ae.prototype.min=function(e){return e.pos<this.pos?e:this},ae.prototype.toString=function(){for(var e="",t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset},ae.resolve=function(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");for(var n=[],r=0,o=t,i=e;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new ae(t,n,o)},ae.resolveCached=function(e,t){for(var n=0;n<le.length;n++){var r=le[n];if(r.pos==t&&r.doc==e)return r}var o=le[ue]=ae.resolve(e,t);return ue=(ue+1)%fe,o},Object.defineProperties(ae.prototype,ce);var le=[],ue=0,fe=12,de=function(e,t,n){this.$from=e,this.$to=t,this.depth=n},pe={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};pe.start.get=function(){return this.$from.before(this.depth+1)},pe.end.get=function(){return this.$to.after(this.depth+1)},pe.parent.get=function(){return this.$from.node(this.depth)},pe.startIndex.get=function(){return this.$from.index(this.depth)},pe.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(de.prototype,pe);var he=Object.create(null),me=function(e,t,n,r){this.type=e,this.attrs=t,this.content=n||L.empty,this.marks=r||J.none},ve={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};ve.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},ve.childCount.get=function(){return this.content.childCount},me.prototype.child=function(e){return this.content.child(e)},me.prototype.maybeChild=function(e){return this.content.maybeChild(e)},me.prototype.forEach=function(e){this.content.forEach(e)},me.prototype.nodesBetween=function(e,t,n,r){void 0===r&&(r=0),this.content.nodesBetween(e,t,n,r,this)},me.prototype.descendants=function(e){this.nodesBetween(0,this.content.size,e)},ve.textContent.get=function(){return this.textBetween(0,this.content.size,"")},me.prototype.textBetween=function(e,t,n,r){return this.content.textBetween(e,t,n,r)},ve.firstChild.get=function(){return this.content.firstChild},ve.lastChild.get=function(){return this.content.lastChild},me.prototype.eq=function(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)},me.prototype.sameMarkup=function(e){return this.hasMarkup(e.type,e.attrs,e.marks)},me.prototype.hasMarkup=function(e,t,n){return this.type==e&&H(this.attrs,t||e.defaultAttrs||he)&&J.sameSet(this.marks,n||J.none)},me.prototype.copy=function(e){return void 0===e&&(e=null),e==this.content?this:new this.constructor(this.type,this.attrs,e,this.marks)},me.prototype.mark=function(e){return e==this.marks?this:new this.constructor(this.type,this.attrs,this.content,e)},me.prototype.cut=function(e,t){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))},me.prototype.slice=function(e,t,n){if(void 0===t&&(t=this.content.size),void 0===n&&(n=!1),e==t)return U.empty;var r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new U(a,r.depth-i,o.depth-i)},me.prototype.replace=function(e,t,n){return Z(this.resolve(e),this.resolve(t),n)},me.prototype.nodeAt=function(e){for(var t=this;;){var n=t.content.findIndex(e),r=n.index,o=n.offset;if(!(t=t.maybeChild(r)))return null;if(o==e||t.isText)return t;e-=o+1}},me.prototype.childAfter=function(e){var t=this.content.findIndex(e),n=t.index,r=t.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},me.prototype.childBefore=function(e){if(0==e)return{node:null,index:0,offset:0};var t=this.content.findIndex(e),n=t.index,r=t.offset;if(r<e)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},me.prototype.resolve=function(e){return ae.resolveCached(this,e)},me.prototype.resolveNoCache=function(e){return ae.resolve(this,e)},me.prototype.rangeHasMark=function(e,t,n){var r=!1;return t>e&&this.nodesBetween(e,t,(function(e){return n.isInSet(e.marks)&&(r=!0),!r})),r},ve.isBlock.get=function(){return this.type.isBlock},ve.isTextblock.get=function(){return this.type.isTextblock},ve.inlineContent.get=function(){return this.type.inlineContent},ve.isInline.get=function(){return this.type.isInline},ve.isText.get=function(){return this.type.isText},ve.isLeaf.get=function(){return this.type.isLeaf},ve.isAtom.get=function(){return this.type.isAtom},me.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),ye(this.marks,e)},me.prototype.contentMatchAt=function(e){var t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t},me.prototype.canReplace=function(e,t,n,r,o){void 0===n&&(n=L.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(e).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,t);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},me.prototype.canReplaceWith=function(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd},me.prototype.canAppend=function(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)},me.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var e=J.none,t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!J.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(e){return e.type.name})));this.content.forEach((function(e){return e.check()}))},me.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map((function(e){return e.toJSON()}))),e},me.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}var r=L.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,r,n)},Object.defineProperties(me.prototype,ve);var ge=function(e){function t(t,n,r,o){if(e.call(this,t,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return t.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):ye(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},t.prototype.textBetween=function(e,t){return this.text.slice(e,t)},n.nodeSize.get=function(){return this.text.length},t.prototype.mark=function(e){return e==this.marks?this:new t(this.type,this.attrs,this.text,e)},t.prototype.withText=function(e){return e==this.text?this:new t(this.type,this.attrs,e,this.marks)},t.prototype.cut=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.text.length),0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))},t.prototype.eq=function(e){return this.sameMarkup(e)&&this.text==e.text},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.text=this.text,t},Object.defineProperties(t.prototype,n),t}(me);function ye(e,t){for(var n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}var be=function(e){this.validEnd=e,this.next=[],this.wrapCache=[]},we={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};be.parse=function(e,t){var n=new ke(e,t);if(null==n.next)return be.empty;var r=Se(n);n.next&&n.err("Unexpected trailing text");var o=function(e){var t=Object.create(null);return n(Te(e,0));function n(r){var o=[];r.forEach((function(t){e[t].forEach((function(t){var n=t.term,r=t.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];Te(e,r).forEach((function(e){s||o.push(n,s=[]),-1==s.indexOf(e)&&s.push(e)}))}}))}));for(var i=t[r.join(",")]=new be(r.indexOf(e.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(Ee);i.next.push(o[s],t[a.join(",")]||n(a))}return i}}(function(e){var t=[[]];return o(i(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){var o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach((function(e){return e.to=t}))}function i(e,t){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(i(n,t))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=i(e.exprs[s],t);if(s==e.exprs.length-1)return a;o(a,t=n())}else{if("star"==e.type){var c=n();return r(t,c),o(i(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(i(e.expr,t),l),o(i(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(t)].concat(i(e.expr,t));if("range"==e.type){for(var u=t,f=0;f<e.min;f++){var d=n();o(i(e.expr,u),d),u=d}if(-1==e.max)o(i(e.expr,u),u);else for(var p=e.min;p<e.max;p++){var h=n();r(u,h),o(i(e.expr,u),h),u=h}return[r(u)]}if("name"==e.type)return[r(t,null,e.value)]}}}(r));return function(e,t){for(var n=0,r=[e];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},be.prototype.matchType=function(e){for(var t=0;t<this.next.length;t+=2)if(this.next[t]==e)return this.next[t+1];return null},be.prototype.matchFragment=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.childCount);for(var r=this,o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r},we.inlineContent.get=function(){var e=this.next[0];return!!e&&e.isInline},we.defaultType.get=function(){for(var e=0;e<this.next.length;e+=2){var t=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}},be.prototype.compatible=function(e){for(var t=0;t<this.next.length;t+=2)for(var n=0;n<e.next.length;n+=2)if(this.next[t]==e.next[n])return!0;return!1},be.prototype.fillBefore=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(e,n);if(a&&(!t||a.validEnd))return L.from(s.map((function(e){return e.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var l=i.next[c],u=i.next[c+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(u)){r.push(u);var f=o(u,s.concat(l));if(f)return f}}}(this,[])},be.prototype.findWrapping=function(e){for(var t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];var n=this.computeWrapping(e);return this.wrapCache.push(e,n),n},be.prototype.computeWrapping=function(e){for(var t=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(e)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in t||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),t[c.name]=!0)}}},we.edgeCount.get=function(){return this.next.length>>1},be.prototype.edge=function(e){var t=e<<1;if(t>=this.next.length)throw new RangeError("There's no "+e+"th edge in this content match");return{type:this.next[t],next:this.next[t+1]}},be.prototype.toString=function(){var e=[];return function t(n){e.push(n);for(var r=1;r<n.next.length;r+=2)-1==e.indexOf(n.next[r])&&t(n.next[r])}(this),e.map((function(t,n){for(var r=n+(t.validEnd?"*":" ")+" ",o=0;o<t.next.length;o+=2)r+=(o?", ":"")+t.next[o].name+"->"+e.indexOf(t.next[o+1]);return r})).join("\n")},Object.defineProperties(be.prototype,we),be.empty=new be(!0);var ke=function(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},xe={next:{configurable:!0}};function Se(e){var t=[];do{t.push(Ce(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function Ce(e){var t=[];do{t.push(Me(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function Me(e){for(var t=function(e){if(e.eat("(")){var t=Se(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){var n=function(e,t){var n=e.nodeTypes,r=n[t];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(t)>-1&&o.push(s)}0==o.length&&e.err("No node type or group '"+t+"' found");return o}(e,e.next).map((function(t){return null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}}));return e.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}e.err("Unexpected token '"+e.next+"'")}(e);;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=Ae(e,t)}return t}function Oe(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var t=Number(e.next);return e.pos++,t}function Ae(e,t){var n=Oe(e),r=n;return e.eat(",")&&(r="}"!=e.next?Oe(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function Ee(e,t){return t-e}function Te(e,t){var n=[];return function t(r){var o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||t(c)}}(t),n.sort(Ee)}function Ne(e){var t=Object.create(null);for(var n in e){var r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function De(e,t){var n=Object.create(null);for(var r in e){var o=t&&t[r];if(void 0===o){var i=e[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function ze(e){var t=Object.create(null);if(e)for(var n in e)t[n]=new Re(e[n]);return t}xe.next.get=function(){return this.tokens[this.pos]},ke.prototype.eat=function(e){return this.next==e&&(this.pos++||!0)},ke.prototype.err=function(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")},Object.defineProperties(ke.prototype,xe);var Ie=function(e,t,n){this.name=e,this.schema=t,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=ze(n.attrs),this.defaultAttrs=Ne(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e},$e={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};$e.isInline.get=function(){return!this.isBlock},$e.isTextblock.get=function(){return this.isBlock&&this.inlineContent},$e.isLeaf.get=function(){return this.contentMatch==be.empty},$e.isAtom.get=function(){return this.isLeaf||this.spec.atom},Ie.prototype.hasRequiredAttrs=function(){for(var e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1},Ie.prototype.compatibleContent=function(e){return this==e||this.contentMatch.compatible(e.contentMatch)},Ie.prototype.computeAttrs=function(e){return!e&&this.defaultAttrs?this.defaultAttrs:De(this.attrs,e)},Ie.prototype.create=function(e,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new me(this,this.computeAttrs(e),L.from(t),J.setFrom(n))},Ie.prototype.createChecked=function(e,t,n){if(t=L.from(t),!this.validContent(t))throw new RangeError("Invalid content for node "+this.name);return new me(this,this.computeAttrs(e),t,J.setFrom(n))},Ie.prototype.createAndFill=function(e,t,n){if(e=this.computeAttrs(e),(t=L.from(t)).size){var r=this.contentMatch.fillBefore(t);if(!r)return null;t=r.append(t)}var o=this.contentMatch.matchFragment(t).fillBefore(L.empty,!0);return o?new me(this,e,t.append(o),J.setFrom(n)):null},Ie.prototype.validContent=function(e){var t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(var n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0},Ie.prototype.allowsMarkType=function(e){return null==this.markSet||this.markSet.indexOf(e)>-1},Ie.prototype.allowsMarks=function(e){if(null==this.markSet)return!0;for(var t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0},Ie.prototype.allowedMarks=function(e){if(null==this.markSet)return e;for(var t,n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:J.empty:e},Ie.compile=function(e,t){var n=Object.create(null);e.forEach((function(e,r){return n[e]=new Ie(e,t,r)}));var r=t.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(Ie.prototype,$e);var Re=function(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default},Fe={isRequired:{configurable:!0}};Fe.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(Re.prototype,Fe);var Pe=function(e,t,n,r){this.name=e,this.schema=n,this.spec=r,this.attrs=ze(r.attrs),this.rank=t,this.excluded=null;var o=Ne(this.attrs);this.instance=o&&new J(this,o)};Pe.prototype.create=function(e){return!e&&this.instance?this.instance:new J(this,De(this.attrs,e))},Pe.compile=function(e,t){var n=Object.create(null),r=0;return e.forEach((function(e,o){return n[e]=new Pe(e,r++,t,o)})),n},Pe.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e},Pe.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(e[t].type==this)return e[t]},Pe.prototype.excludes=function(e){return this.excluded.indexOf(e)>-1};var _e=function(e){for(var t in this.spec={},e)this.spec[t]=e[t];this.spec.nodes=_.from(e.nodes),this.spec.marks=_.from(e.marks),this.nodes=Ie.compile(this.spec.nodes,this),this.marks=Pe.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",s=o.spec.marks;o.contentMatch=n[i]||(n[i]=be.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==s?null:s?je(this,s.split(" ")):""!=s&&o.inlineContent?null:[]}for(var a in this.marks){var c=this.marks[a],l=c.spec.excludes;c.excluded=null==l?[c]:""==l?[]:je(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function je(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r],i=e.marks[o],s=i;if(i)n.push(i);else for(var a in e.marks){var c=e.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}_e.prototype.node=function(e,t,n,r){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof Ie))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,r)},_e.prototype.text=function(e,t){var n=this.nodes.text;return new ge(n,n.defaultAttrs,e,J.setFrom(t))},_e.prototype.mark=function(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)},_e.prototype.nodeFromJSON=function(e){return me.fromJSON(this,e)},_e.prototype.markFromJSON=function(e){return J.fromJSON(this,e)},_e.prototype.nodeType=function(e){var t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t};var Be=function(e,t){var n=this;this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach((function(e){e.tag?n.tags.push(e):e.style&&n.styles.push(e)})),this.normalizeLists=!this.tags.some((function(t){if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;var n=e.nodes[t.node];return n.contentMatch.matchType(n)}))};Be.prototype.parse=function(e,t){void 0===t&&(t={});var n=new Je(this,t,!1);return n.addAll(e,null,t.from,t.to),n.finish()},Be.prototype.parseSlice=function(e,t){void 0===t&&(t={});var n=new Je(this,t,!0);return n.addAll(e,null,t.from,t.to),U.maxOpen(n.finish())},Be.prototype.matchTag=function(e,t,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(Ue(e,o.tag)&&(void 0===o.namespace||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},Be.prototype.matchStyle=function(e,t,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(e)||i.context&&!n.matchesContext(i.context)||i.style.length>e.length&&(61!=i.style.charCodeAt(e.length)||i.style.slice(e.length+1)!=t))){if(i.getAttrs){var s=i.getAttrs(t);if(!1===s)continue;i.attrs=s}return i}}},Be.schemaRules=function(e){var t=[];function n(e){for(var n=null==e.priority?50:e.priority,r=0;r<t.length;r++){var o=t[r];if((null==o.priority?50:o.priority)<n)break}t.splice(r,0,e)}var r=function(t){var r=e.marks[t].spec.parseDOM;r&&r.forEach((function(e){n(e=Ge(e)),e.mark=t}))};for(var o in e.marks)r(o);var i;for(var s in e.nodes)i=void 0,(i=e.nodes[s].spec.parseDOM)&&i.forEach((function(e){n(e=Ge(e)),e.node=s}));return t},Be.fromSchema=function(e){return e.cached.domParser||(e.cached.domParser=new Be(e,Be.schemaRules(e)))};var Le={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ve={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},We={ol:!0,ul:!0};function qe(e){return(e?1:0)|("full"===e?2:0)}var He=function(e,t,n,r,o,i,s){this.type=e,this.attrs=t,this.solid=o,this.match=i||(4&s?null:e.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=J.none,this.pendingMarks=r,this.stashMarks=[]};He.prototype.findWrapping=function(e){if(!this.match){if(!this.type)return[];var t=this.type.contentMatch.fillBefore(L.from(e));if(!t){var n,r=this.type.contentMatch;return(n=r.findWrapping(e.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)},He.prototype.finish=function(e){if(!(1&this.options)){var t,n=this.content[this.content.length-1];n&&n.isText&&(t=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-t[0].length)))}var r=L.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(L.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},He.prototype.popFromStashMark=function(e){for(var t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]},He.prototype.applyPending=function(e){for(var t=0,n=this.pendingMarks;t<n.length;t++){var r=n[t];(this.type?this.type.allowsMarkType(r.type):Qe(r.type,e))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}},He.prototype.inlineContext=function(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Le.hasOwnProperty(e.parentNode.nodeName.toLowerCase())};var Je=function(e,t,n){this.parser=e,this.options=t,this.isOpen=n;var r,o=t.topNode,i=qe(t.preserveWhitespace)|(n?4:0);r=o?new He(o.type,o.attrs,J.none,J.none,!0,t.topMatch||o.type.contentMatch,i):new He(n?null:e.schema.topNodeType,null,J.none,J.none,!0,null,i),this.nodes=[r],this.open=0,this.find=t.findPositions,this.needsBlock=!1},Ke={top:{configurable:!0},currentPos:{configurable:!0}};function Ue(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function Ge(e){var t={};for(var n in e)t[n]=e[n];return t}function Qe(e,t){var n=t.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(e)){var i=[],s=function(e){i.push(e);for(var n=0;n<e.edgeCount;n++){var r=e.edge(n),o=r.type,a=r.next;if(o==t)return!0;if(i.indexOf(a)<0&&s(a))return!0}};return s(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}Ke.top.get=function(){return this.nodes[this.open]},Je.prototype.addDOM=function(e){if(3==e.nodeType)this.addTextNode(e);else if(1==e.nodeType){var t=e.getAttribute("style"),n=t?this.readStyles(function(e){var t,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;t=n.exec(e);)r.push(t[1],t[2].trim());return r}(t)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(e),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},Je.prototype.addTextNode=function(e){var t=e.nodeValue,n=this.top;if(2&n.options||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(1&n.options)t=2&n.options?t.replace(/\r\n?/g,"\n"):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=e.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)},Je.prototype.addElement=function(e,t){var n,r=e.nodeName.toLowerCase();We.hasOwnProperty(r)&&this.parser.normalizeLists&&function(e){for(var t=e.firstChild,n=null;t;t=t.nextSibling){var r=1==t.nodeType?t.nodeName.toLowerCase():null;r&&We.hasOwnProperty(r)&&n?(n.appendChild(t),t=n):"li"==r?n=t:r&&(n=null)}}(e);var o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(n=this.parser.matchTag(e,this,t));if(o?o.ignore:Ve.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);var i,s=this.top,a=this.needsBlock;if(Le.hasOwnProperty(r))i=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);this.addAll(e),i&&this.sync(s),this.needsBlock=a}else this.addElementByRule(e,o,!1===o.consuming?n:null)},Je.prototype.leafFallback=function(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))},Je.prototype.ignoreFallback=function(e){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))},Je.prototype.readStyles=function(e){var t=J.none;e:for(var n=0;n<e.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(e[n],e[n+1],this,r);if(!o)continue e;if(o.ignore)return null;if(t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),!1!==o.consuming)break;r=o}return t},Je.prototype.addElementByRule=function(e,t,n){var r,o,i,s=this;t.node?(o=this.parser.schema.nodes[t.node]).isLeaf?this.insertNode(o.create(t.attrs))||this.leafFallback(e):r=this.enter(o,t.attrs,t.preserveWhitespace):(i=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(i));var a=this.top;if(o&&o.isLeaf)this.findInside(e);else if(n)this.addElement(e,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach((function(e){return s.insertNode(e)}));else{var c=t.contentElement;"string"==typeof c?c=e.querySelector(c):"function"==typeof c&&(c=c(e)),c||(c=e),this.findAround(e,c,!0),this.addAll(c,r)}r&&(this.sync(a),this.open--),i&&this.removePendingMark(i,a)},Je.prototype.addAll=function(e,t,n,r){for(var o=n||0,i=n?e.childNodes[n]:e.firstChild,s=null==r?null:e.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i),t&&Le.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(t);this.findAtPoint(e,o)},Je.prototype.findPlace=function(e){for(var t,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(e);if(i&&(!t||t.length>i.length)&&(t=i,n=o,!i.length))break;if(o.solid)break}if(!t)return!1;this.sync(n);for(var s=0;s<t.length;s++)this.enterInner(t[s],null,!1);return!0},Je.prototype.insertNode=function(e){if(e.isInline&&this.needsBlock&&!this.top.type){var t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();var n=this.top;n.applyPending(e.type),n.match&&(n.match=n.match.matchType(e.type));for(var r=n.activeMarks,o=0;o<e.marks.length;o++)n.type&&!n.type.allowsMarkType(e.marks[o].type)||(r=e.marks[o].addToSet(r));return n.content.push(e.mark(r)),!0}return!1},Je.prototype.enter=function(e,t,n){var r=this.findPlace(e.create(t));return r&&this.enterInner(e,t,!0,n),r},Je.prototype.enterInner=function(e,t,n,r){this.closeExtra();var o=this.top;o.applyPending(e),o.match=o.match&&o.match.matchType(e,t);var i=null==r?-5&o.options:qe(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new He(e,t,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},Je.prototype.closeExtra=function(e){var t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}},Je.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},Je.prototype.sync=function(e){for(var t=this.open;t>=0;t--)if(this.nodes[t]==e)return void(this.open=t)},Ke.currentPos.get=function(){this.closeExtra();for(var e=0,t=this.open;t>=0;t--){for(var n=this.nodes[t].content,r=n.length-1;r>=0;r--)e+=n[r].nodeSize;t&&e++}return e},Je.prototype.findAtPoint=function(e,t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)},Je.prototype.findInside=function(e){if(this.find)for(var t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)},Je.prototype.findAround=function(e,t,n){if(e!=t&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node))t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},Je.prototype.findInText=function(e){if(this.find)for(var t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))},Je.prototype.matchesContext=function(e){var t=this;if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);var n=e.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(e,a){for(;e>=0;e--){var c=n[e];if(""==c){if(e==n.length-1||0==e)continue;for(;a>=i;a--)if(s(e-1,a))return!0;return!1}var l=a>0||0==a&&o?t.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},Je.prototype.textblockFromContext=function(){var e=this.options.context;if(e)for(var t=e.depth;t>=0;t--){var n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},Je.prototype.addPendingMark=function(e){var t=function(e,t){for(var n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)},Je.prototype.removePendingMark=function(e,t){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(e)>-1)r.pendingMarks=e.removeFromSet(r.pendingMarks);else{r.activeMarks=e.removeFromSet(r.activeMarks);var o=r.popFromStashMark(e);o&&r.type&&r.type.allowsMarkType(o.type)&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==t)break}},Object.defineProperties(Je.prototype,Ke);var Xe=function(e,t){this.nodes=e||{},this.marks=t||{}};function Ze(e){var t={};for(var n in e){var r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function Ye(e){return e.document||window.document}Xe.prototype.serializeFragment=function(e,t,n){var r=this;void 0===t&&(t={}),n||(n=Ye(t).createDocumentFragment());var o=n,i=null;return e.forEach((function(e){if(i||e.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<e.marks.length;){var a=e.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<e.marks.length;){var c=e.marks[s++],l=r.serializeMark(c,e.isInline,t);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNodeInner(e,t))})),n},Xe.prototype.serializeNodeInner=function(e,t){void 0===t&&(t={});var n=Xe.renderSpec(Ye(t),this.nodes[e.type.name](e)),r=n.dom,o=n.contentDOM;if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");t.onContent?t.onContent(e,o,t):this.serializeFragment(e.content,t,o)}return r},Xe.prototype.serializeNode=function(e,t){void 0===t&&(t={});for(var n=this.serializeNodeInner(e,t),r=e.marks.length-1;r>=0;r--){var o=this.serializeMark(e.marks[r],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},Xe.prototype.serializeMark=function(e,t,n){void 0===n&&(n={});var r=this.marks[e.type.name];return r&&Xe.renderSpec(Ye(n),r(e,t))},Xe.renderSpec=function(e,t,n){if(void 0===n&&(n=null),"string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;var r=t[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?e.createElementNS(n,r):e.createElement(r),a=t[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var l in c=2,a)if(null!=a[l]){var u=l.indexOf(" ");u>0?s.setAttributeNS(l.slice(0,u),l.slice(u+1),a[l]):s.setAttribute(l,a[l])}for(var f=c;f<t.length;f++){var d=t[f];if(0===d){if(f<t.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var p=Xe.renderSpec(e,d,n),h=p.dom,m=p.contentDOM;if(s.appendChild(h),m){if(i)throw new RangeError("Multiple content holes");i=m}}return{dom:s,contentDOM:i}},Xe.fromSchema=function(e){return e.cached.domSerializer||(e.cached.domSerializer=new Xe(this.nodesFromSchema(e),this.marksFromSchema(e)))},Xe.nodesFromSchema=function(e){var t=Ze(e.nodes);return t.text||(t.text=function(e){return e.text}),t},Xe.marksFromSchema=function(e){return Ze(e.marks)};var et=Math.pow(2,16);function tt(e){return 65535&e}var nt=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=null),this.pos=e,this.deleted=t,this.recover=n},rt=function(e,t){void 0===t&&(t=!1),this.ranges=e,this.inverted=t};rt.prototype.recover=function(e){var t=0,n=tt(e);if(!this.inverted)for(var r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/et}(e)},rt.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},rt.prototype.map=function(e,t){return void 0===t&&(t=1),this._map(e,t,!0)},rt.prototype._map=function(e,t,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?r:0);if(a>e)break;var c=this.ranges[s+o],l=this.ranges[s+i],u=a+c;if(e<=u){var f=a+r+((c?e==a?-1:e==u?1:t:t)<0?0:l);if(n)return f;var d=e==(t<0?a:u)?null:s/3+(e-a)*et;return new nt(f,t<0?e!=a:e!=u,d)}r+=l-c}return n?e+r:new nt(e+r)},rt.prototype.touches=function(e,t){for(var n=0,r=tt(t),o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?n:0);if(a>e)break;var c=this.ranges[s+o];if(e<=a+c&&s==3*r)return!0;n+=this.ranges[s+i]-c}return!1},rt.prototype.forEach=function(e){for(var t=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),c=this.ranges[r+t],l=this.ranges[r+n];e(s,s+c,a,a+l),o+=l-c}},rt.prototype.invert=function(){return new rt(this.ranges,!this.inverted)},rt.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},rt.offset=function(e){return 0==e?rt.empty:new rt(e<0?[0,-e,0]:[0,0,e])},rt.empty=new rt([]);var ot=function(e,t,n,r){this.maps=e||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=t};function it(e){var t=Error.call(this,e);return t.__proto__=it.prototype,t}ot.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.maps.length),new ot(this.maps,this.mirror,e,t)},ot.prototype.copy=function(){return new ot(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},ot.prototype.appendMap=function(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)},ot.prototype.appendMapping=function(e){for(var t=0,n=this.maps.length;t<e.maps.length;t++){var r=e.getMirror(t);this.appendMap(e.maps[t],null!=r&&r<t?n+r:null)}},ot.prototype.getMirror=function(e){if(this.mirror)for(var t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]},ot.prototype.setMirror=function(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)},ot.prototype.appendMappingInverted=function(e){for(var t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){var r=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=r&&r>t?n-r-1:null)}},ot.prototype.invert=function(){var e=new ot;return e.appendMappingInverted(this),e},ot.prototype.map=function(e,t){if(void 0===t&&(t=1),this.mirror)return this._map(e,t,!0);for(var n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e},ot.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},ot.prototype._map=function(e,t,n){for(var r=!1,o=this.from;o<this.to;o++){var i=this.maps[o].mapResult(e,t);if(null!=i.recover){var s=this.getMirror(o);if(null!=s&&s>o&&s<this.to){o=s,e=this.maps[s].recover(i.recover);continue}}i.deleted&&(r=!0),e=i.pos}return n?e:new nt(e,r)},it.prototype=Object.create(Error.prototype),it.prototype.constructor=it,it.prototype.name="TransformError";var st=function(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new ot},at={before:{configurable:!0},docChanged:{configurable:!0}};function ct(){throw new Error("Override me")}at.before.get=function(){return this.docs.length?this.docs[0]:this.doc},st.prototype.step=function(e){var t=this.maybeStep(e);if(t.failed)throw new it(t.failed);return this},st.prototype.maybeStep=function(e){var t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t},at.docChanged.get=function(){return this.steps.length>0},st.prototype.addStep=function(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t},Object.defineProperties(st.prototype,at);var lt=Object.create(null),ut=function(){};ut.prototype.apply=function(e){return ct()},ut.prototype.getMap=function(){return rt.empty},ut.prototype.invert=function(e){return ct()},ut.prototype.map=function(e){return ct()},ut.prototype.merge=function(e){return null},ut.prototype.toJSON=function(){return ct()},ut.fromJSON=function(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=lt[t.stepType];if(!n)throw new RangeError("No step type "+t.stepType+" defined");return n.fromJSON(e,t)},ut.jsonID=function(e,t){if(e in lt)throw new RangeError("Duplicate use of step JSON ID "+e);return lt[e]=t,t.prototype.jsonID=e,t};var ft=function(e,t){this.doc=e,this.failed=t};ft.ok=function(e){return new ft(e,null)},ft.fail=function(e){return new ft(null,e)},ft.fromReplace=function(e,t,n,r){try{return ft.ok(e.replace(t,n,r))}catch(o){if(o instanceof K)return ft.fail(o.message);throw o}};var dt=function(e){function t(t,n,r,o){e.call(this),this.from=t,this.to=n,this.slice=r,this.structure=!!o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){return this.structure&&ht(e,this.from,this.to)?ft.fail("Structure replace would overwrite content"):ft.fromReplace(e,this.from,this.to,this.slice)},t.prototype.getMap=function(){return new rt([this.from,this.to-this.from,this.slice.size])},t.prototype.invert=function(e){return new t(this.from,this.from+this.slice.size,e.slice(this.from,this.to))},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new t(n.pos,Math.max(n.pos,r.pos),this.slice)},t.prototype.merge=function(e){if(!(e instanceof t)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;var n=this.slice.size+e.slice.size==0?U.empty:new U(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new t(e.from,this.to,n,this.structure)}var r=this.slice.size+e.slice.size==0?U.empty:new U(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new t(this.from,this.to+(e.to-e.from),r,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(n.from,n.to,U.fromJSON(e,n.slice),!!n.structure)},t}(ut);ut.jsonID("replace",dt);var pt=function(e){function t(t,n,r,o,i,s,a){e.call(this),this.from=t,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=!!a}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){if(this.structure&&(ht(e,this.from,this.gapFrom)||ht(e,this.gapTo,this.to)))return ft.fail("Structure gap-replace would overwrite content");var t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return ft.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,t.content);return n?ft.fromReplace(e,this.from,this.to,n):ft.fail("Content does not fit in gap")},t.prototype.getMap=function(){return new rt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},t.prototype.invert=function(e){var n=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=e.map(this.gapFrom,-1),i=e.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||i>r.pos?null:new t(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(n.from,n.to,n.gapFrom,n.gapTo,U.fromJSON(e,n.slice),n.insert,!!n.structure)},t}(ut);function ht(e,t,n){for(var r=e.resolve(t),o=n-t,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function mt(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function vt(e){for(var t=e.parent.content.cutByIndex(e.startIndex,e.endIndex),n=e.depth;;--n){var r=e.$from.node(n),o=e.$from.index(n),i=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(o,i,t))return n;if(0==n||r.type.spec.isolating||!mt(r,o,i))break}}function gt(e,t,n,r){void 0===r&&(r=e);var o=function(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;var s=i.length?i[0]:t;return n.canReplaceWith(r,o,s)?i:null}(e,t),i=o&&function(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.child(r),s=t.contentMatch.findWrapping(i.type);if(!s)return null;for(var a=(s.length?s[s.length-1]:t).contentMatch,c=r;a&&c<o;c++)a=a.matchType(n.child(c).type);if(!a||!a.validEnd)return null;return s}(r,t);return i?o.map(yt).concat({type:t,attrs:n}).concat(i.map(yt)):null}function yt(e){return{type:e,attrs:null}}function bt(e,t,n,r){void 0===n&&(n=1);var o=e.resolve(t),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var a=o.depth-1,c=n-2;a>i;a--,c--){var l=o.node(a),u=o.index(a);if(l.type.spec.isolating)return!1;var f=l.content.cutByIndex(u,l.childCount),d=r&&r[c]||l;if(d!=l&&(f=f.replaceChild(0,d.type.create(d.attrs))),!l.canReplace(u+1,l.childCount)||!d.type.validContent(f))return!1}var p=o.indexAfter(i),h=r&&r[0];return o.node(i).canReplaceWith(p,p,h?h.type:o.node(i+1).type)}function wt(e,t){var n,r,o=e.resolve(t),i=o.index();return n=o.nodeBefore,r=o.nodeAfter,n&&r&&!n.isLeaf&&n.canAppend(r)&&o.parent.canReplace(i,i+1)}function kt(e,t,n){for(var r=[],o=0;o<e.childCount;o++){var i=e.child(o);i.content.size&&(i=i.copy(kt(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return L.fromArray(r)}ut.jsonID("replaceAround",pt),st.prototype.lift=function(e,t){for(var n=e.$from,r=e.$to,o=e.depth,i=n.before(o+1),s=r.after(o+1),a=i,c=s,l=L.empty,u=0,f=o,d=!1;f>t;f--)d||n.index(f)>0?(d=!0,l=L.from(n.node(f).copy(l)),u++):a--;for(var p=L.empty,h=0,m=o,v=!1;m>t;m--)v||r.after(m+1)<r.end(m)?(v=!0,p=L.from(r.node(m).copy(p)),h++):c++;return this.step(new pt(a,c,i,s,new U(l.append(p),u,h),l.size-u,!0))},st.prototype.wrap=function(e,t){for(var n=L.empty,r=t.length-1;r>=0;r--)n=L.from(t[r].type.create(t[r].attrs,n));var o=e.start,i=e.end;return this.step(new pt(o,i,o,i,new U(n,0,0),t.length,!0))},st.prototype.setBlockType=function(e,t,n,r){var o=this;if(void 0===t&&(t=e),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(e,t,(function(e,t){if(e.isTextblock&&!e.hasMarkup(n,r)&&function(e,t,n){var r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(o.doc,o.mapping.slice(i).map(t),n)){o.clearIncompatible(o.mapping.slice(i).map(t,1),n);var s=o.mapping.slice(i),a=s.map(t,1),c=s.map(t+e.nodeSize,1);return o.step(new pt(a,c,a+1,c-1,new U(L.from(n.create(r,null,e.marks)),0,0),1,!0)),!1}})),this},st.prototype.setNodeMarkup=function(e,t,n,r){var o=this.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);var i=t.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(e,e+o.nodeSize,i);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);return this.step(new pt(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new U(L.from(i),0,0),1,!0))},st.prototype.split=function(e,t,n){void 0===t&&(t=1);for(var r=this.doc.resolve(e),o=L.empty,i=L.empty,s=r.depth,a=r.depth-t,c=t-1;s>a;s--,c--){o=L.from(r.node(s).copy(o));var l=n&&n[c];i=L.from(l?l.type.create(l.attrs,i):r.node(s).copy(i))}return this.step(new dt(e,e,new U(o.append(i),t,t),!0))},st.prototype.join=function(e,t){void 0===t&&(t=1);var n=new dt(e-t,e+t,U.empty,!0);return this.step(n)};var xt=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=e.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new U(kt(n.content,(function(e,n){return e.isAtom&&n.type.allowsMarkType(t.mark.type)?e.mark(t.mark.addToSet(e.marks)):e}),o),n.openStart,n.openEnd);return ft.fromReplace(e,this.from,this.to,i)},t.prototype.invert=function(){return new St(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(ut);ut.jsonID("addMark",xt);var St=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=new U(kt(n.content,(function(e){return e.mark(t.mark.removeFromSet(e.marks))})),n.openStart,n.openEnd);return ft.fromReplace(e,this.from,this.to,r)},t.prototype.invert=function(){return new xt(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(ut);function Ct(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}ut.jsonID("removeMark",St),st.prototype.addMark=function(e,t,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(e,t,(function(r,c,l){if(r.isInline){var u=r.marks;if(!n.isInSet(u)&&l.type.allowsMarkType(n.type)){for(var f=Math.max(c,e),d=Math.min(c+r.nodeSize,t),p=n.addToSet(u),h=0;h<u.length;h++)u[h].isInSet(p)||(s&&s.to==f&&s.mark.eq(u[h])?s.to=d:o.push(s=new St(f,d,u[h])));a&&a.to==f?a.to=d:i.push(a=new xt(f,d,n))}}})),o.forEach((function(e){return r.step(e)})),i.forEach((function(e){return r.step(e)})),this},st.prototype.removeMark=function(e,t,n){var r=this;void 0===n&&(n=null);var o=[],i=0;return this.doc.nodesBetween(e,t,(function(r,s){if(r.isInline){i++;var a=null;if(n instanceof Pe)for(var c,l=r.marks;c=n.isInSet(l);)(a||(a=[])).push(c),l=c.removeFromSet(l);else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length)for(var u=Math.min(s+r.nodeSize,t),f=0;f<a.length;f++){for(var d=a[f],p=void 0,h=0;h<o.length;h++){var m=o[h];m.step==i-1&&d.eq(o[h].style)&&(p=m)}p?(p.to=u,p.step=i):o.push({style:d,from:Math.max(s,e),to:u,step:i})}}})),o.forEach((function(e){return r.step(new St(e.from,e.to,e.style))})),this},st.prototype.clearIncompatible=function(e,t,n){void 0===n&&(n=t.contentMatch);for(var r=this.doc.nodeAt(e),o=[],i=e+1,s=0;s<r.childCount;s++){var a=r.child(s),c=i+a.nodeSize,l=n.matchType(a.type,a.attrs);if(l){n=l;for(var u=0;u<a.marks.length;u++)t.allowsMarkType(a.marks[u].type)||this.step(new St(i,c,a.marks[u]))}else o.push(new dt(i,c,U.empty));i=c}if(!n.validEnd){var f=n.fillBefore(L.empty,!0);this.replace(i,i,new U(f,0,0))}for(var d=o.length-1;d>=0;d--)this.step(o[d]);return this},st.prototype.replace=function(e,t,n){void 0===t&&(t=e),void 0===n&&(n=U.empty);var r=function(e,t,n,r){if(void 0===n&&(n=t),void 0===r&&(r=U.empty),t==n&&!r.size)return null;var o=e.resolve(t),i=e.resolve(n);return Ct(o,i,r)?new dt(t,n,r):new Mt(o,i,r).fit()}(this.doc,e,t,n);return r&&this.step(r),this},st.prototype.replaceWith=function(e,t,n){return this.replace(e,t,new U(L.from(n),0,0))},st.prototype.delete=function(e,t){return this.replace(e,t,U.empty)},st.prototype.insert=function(e,t){return this.replaceWith(e,e,t)};var Mt=function(e,t,n){this.$to=t,this.$from=e,this.unplaced=n,this.frontier=[];for(var r=0;r<=e.depth;r++){var o=e.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(r))})}this.placed=L.empty;for(var i=e.depth;i>0;i--)this.placed=L.from(e.node(i).copy(this.placed))},Ot={depth:{configurable:!0}};function At(e,t,n){return 0==t?e.cutByIndex(n):e.replaceChild(0,e.firstChild.copy(At(e.firstChild.content,t-1,n)))}function Et(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(Et(e.lastChild.content,t-1,n)))}function Tt(e,t){for(var n=0;n<t;n++)e=e.firstChild.content;return e}function Nt(e,t,n){if(t<=0)return e;var r=e.content;return t>1&&(r=r.replaceChild(0,Nt(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(L.empty,!0)))),e.copy(r)}function Dt(e,t,n,r,o){var i=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;var a=r.fillBefore(i.content,!0,s);return a&&!function(e,t,n){for(var r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,s)?a:null}function zt(e,t,n,r,o){if(t<n){var i=e.firstChild;e=e.replaceChild(0,i.copy(zt(i.content,t+1,n,r,i)))}if(t>r){var s=o.contentMatchAt(0),a=s.fillBefore(e).append(e);e=a.append(s.matchFragment(a).fillBefore(L.empty,!0))}return e}function It(e,t){for(var n=[],r=Math.min(e.depth,t.depth);r>=0;r--){var o=e.start(r);if(o<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;(o==t.start(r)||r==e.depth&&r==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&r&&t.start(r-1)==o-1)&&n.push(r)}return n}Ot.depth.get=function(){return this.frontier.length-1},Mt.prototype.fit=function(){for(;this.unplaced.size;){var e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}var t=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(t<0?this.$to:r.doc.resolve(t));if(!o)return null;for(var i=this.placed,s=r.depth,a=o.depth;s&&a&&1==i.childCount;)i=i.firstChild.content,s--,a--;var c=new U(i,s,a);return t>-1?new pt(r.pos,t,this.$to.pos,this.$to.end(),c,n):c.size||r.pos!=this.$to.pos?new dt(r.pos,o.pos,c):void 0},Mt.prototype.findFittable=function(){for(var e=1;e<=2;e++)for(var t=this.unplaced.openStart;t>=0;t--)for(var n=void 0,r=(t?(n=Tt(this.unplaced.content,t-1).firstChild).content:this.unplaced.content).firstChild,o=this.depth;o>=0;o--){var i=this.frontier[o],s=i.type,a=i.match,c=void 0,l=void 0;if(1==e&&(r?a.matchType(r.type)||(l=a.fillBefore(L.from(r),!1)):s.compatibleContent(n.type)))return{sliceDepth:t,frontierDepth:o,parent:n,inject:l};if(2==e&&r&&(c=a.findWrapping(r.type)))return{sliceDepth:t,frontierDepth:o,parent:n,wrap:c};if(n&&a.matchType(n.type))break}},Mt.prototype.openMore=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=Tt(t,n);return!(!o.childCount||o.firstChild.isLeaf)&&(this.unplaced=new U(t,n+1,Math.max(r,o.size+n>=t.size-r?n+1:0)),!0)},Mt.prototype.dropNode=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=Tt(t,n);if(o.childCount<=1&&n>0){var i=t.size-n<=n+o.size;this.unplaced=new U(At(t,n-1,1),n-1,i?n-1:r)}else this.unplaced=new U(At(t,n,1),n,r)},Mt.prototype.placeNodes=function(e){for(var t=e.sliceDepth,n=e.frontierDepth,r=e.parent,o=e.inject,i=e.wrap;this.depth>n;)this.closeFrontierNode();if(i)for(var s=0;s<i.length;s++)this.openFrontierNode(i[s]);var a=this.unplaced,c=r?r.content:a.content,l=a.openStart-t,u=0,f=[],d=this.frontier[n],p=d.match,h=d.type;if(o){for(var m=0;m<o.childCount;m++)f.push(o.child(m));p=p.matchFragment(o)}for(var v=c.size+t-(a.content.size-a.openEnd);u<c.childCount;){var g=c.child(u),y=p.matchType(g.type);if(!y)break;(++u>1||0==l||g.content.size)&&(p=y,f.push(Nt(g.mark(h.allowedMarks(g.marks)),1==u?l:0,u==c.childCount?v:-1)))}var b=u==c.childCount;b||(v=-1),this.placed=Et(this.placed,n,L.from(f)),this.frontier[n].match=p,b&&v<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var w=0,k=c;w<v;w++){var x=k.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),k=x.content}this.unplaced=b?0==t?U.empty:new U(At(a.content,t-1,1),t-1,v<0?a.openEnd:t-1):new U(At(a.content,t,u),a.openStart,a.openEnd)},Mt.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var e,t=this.frontier[this.depth];if(!t.type.isTextblock||!Dt(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;for(var n=this.$to.depth,r=this.$to.after(n);n>1&&r==this.$to.end(--n);)++r;return r},Mt.prototype.findCloseLevel=function(e){e:for(var t=Math.min(this.depth,e.depth);t>=0;t--){var n=this.frontier[t],r=n.match,o=n.type,i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Dt(e,t,o,r,i);if(s){for(var a=t-1;a>=0;a--){var c=this.frontier[a],l=c.match,u=Dt(e,a,c.type,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:s,move:i?e.doc.resolve(e.after(t+1)):e}}}},Mt.prototype.close=function(e){var t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Et(this.placed,t.depth,t.fit)),e=t.move;for(var n=t.depth+1;n<=e.depth;n++){var r=e.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,e.index(n));this.openFrontierNode(r.type,r.attrs,o)}return e},Mt.prototype.openFrontierNode=function(e,t,n){var r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=Et(this.placed,this.depth,L.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})},Mt.prototype.closeFrontierNode=function(){var e=this.frontier.pop().match.fillBefore(L.empty,!0);e.childCount&&(this.placed=Et(this.placed,this.frontier.length,e))},Object.defineProperties(Mt.prototype,Ot),st.prototype.replaceRange=function(e,t,n){if(!n.size)return this.deleteRange(e,t);var r=this.doc.resolve(e),o=this.doc.resolve(t);if(Ct(r,o,n))return this.step(new dt(e,t,n));var i=It(r,this.doc.resolve(t));0==i[i.length-1]&&i.pop();var s=-(r.depth+1);i.unshift(s);for(var a=r.depth,c=r.pos-1;a>0;a--,c--){var l=r.node(a).type.spec;if(l.defining||l.isolating)break;i.indexOf(a)>-1?s=a:r.before(a)==c&&i.splice(1,0,-a)}for(var u=i.indexOf(s),f=[],d=n.openStart,p=n.content,h=0;;h++){var m=p.firstChild;if(f.push(m),h==n.openStart)break;p=m.content}d>0&&f[d-1].type.spec.defining&&r.node(u).type!=f[d-1].type?d-=1:d>=2&&f[d-1].isTextblock&&f[d-2].type.spec.defining&&r.node(u).type!=f[d-2].type&&(d-=2);for(var v=n.openStart;v>=0;v--){var g=(v+d+1)%(n.openStart+1),y=f[g];if(y)for(var b=0;b<i.length;b++){var w=i[(b+u)%i.length],k=!0;w<0&&(k=!1,w=-w);var x=r.node(w-1),S=r.index(w-1);if(x.canReplaceWith(S,S,y.type,y.marks))return this.replace(r.before(w),k?o.after(w):t,new U(zt(n.content,0,n.openStart,g),g,n.openEnd))}}for(var C=this.steps.length,M=i.length-1;M>=0&&(this.replace(e,t,n),!(this.steps.length>C));M--){var O=i[M];O<0||(e=r.before(O),t=o.after(O))}return this},st.prototype.replaceRangeWith=function(e,t,n){if(!n.isInline&&e==t&&this.doc.resolve(e).parent.content.size){var r=function(e,t,n){var r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}(this.doc,e,n.type);null!=r&&(e=t=r)}return this.replaceRange(e,t,new U(L.from(n),0,0))},st.prototype.deleteRange=function(e,t){for(var n=this.doc.resolve(e),r=this.doc.resolve(t),o=It(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(e-n.start(c)==n.depth-c&&t>n.end(c)&&r.end(c)-t!=r.depth-c)return this.delete(n.before(c),t);return this.delete(e,t)};var $t=Object.create(null),Rt=function(e,t,n){this.ranges=n||[new Pt(e.min(t),e.max(t))],this.$anchor=e,this.$head=t},Ft={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};Ft.anchor.get=function(){return this.$anchor.pos},Ft.head.get=function(){return this.$head.pos},Ft.from.get=function(){return this.$from.pos},Ft.to.get=function(){return this.$to.pos},Ft.$from.get=function(){return this.ranges[0].$from},Ft.$to.get=function(){return this.ranges[0].$to},Ft.empty.get=function(){for(var e=this.ranges,t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0},Rt.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},Rt.prototype.replace=function(e,t){void 0===t&&(t=U.empty);for(var n=t.content.lastChild,r=null,o=0;o<t.openEnd;o++)r=n,n=n.lastChild;for(var i=e.steps.length,s=this.ranges,a=0;a<s.length;a++){var c=s[a],l=c.$from,u=c.$to,f=e.mapping.slice(i);e.replaceRange(f.map(l.pos),f.map(u.pos),a?U.empty:t),0==a&&Ht(e,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},Rt.prototype.replaceWith=function(e,t){for(var n=e.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=e.mapping.slice(n),l=c.map(s.pos),u=c.map(a.pos);o?e.deleteRange(l,u):(e.replaceRangeWith(l,u,t),Ht(e,n,t.isInline?-1:1))}},Rt.findFrom=function(e,t,n){var r=e.parent.inlineContent?new _t(e):qt(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(var o=e.depth-1;o>=0;o--){var i=t<0?qt(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):qt(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(i)return i}},Rt.near=function(e,t){return void 0===t&&(t=1),this.findFrom(e,t)||this.findFrom(e,-t)||new Vt(e.node(0))},Rt.atStart=function(e){return qt(e,e,0,0,1)||new Vt(e)},Rt.atEnd=function(e){return qt(e,e,e.content.size,e.childCount,-1)||new Vt(e)},Rt.fromJSON=function(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=$t[t.type];if(!n)throw new RangeError("No selection type "+t.type+" defined");return n.fromJSON(e,t)},Rt.jsonID=function(e,t){if(e in $t)throw new RangeError("Duplicate use of selection JSON ID "+e);return $t[e]=t,t.prototype.jsonID=e,t},Rt.prototype.getBookmark=function(){return _t.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(Rt.prototype,Ft),Rt.prototype.visible=!0;var Pt=function(e,t){this.$from=e,this.$to=t},_t=function(e){function t(t,n){void 0===n&&(n=t),e.call(this,t,n)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},t.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return e.near(o);var i=n.resolve(r.map(this.anchor));return new t(i.parent.inlineContent?i:o,o)},t.prototype.replace=function(t,n){if(void 0===n&&(n=U.empty),e.prototype.replace.call(this,t,n),n==U.empty){var r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor&&e.head==this.head},t.prototype.getBookmark=function(){return new jt(this.anchor,this.head)},t.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},t.fromJSON=function(e,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(e.resolve(n.anchor),e.resolve(n.head))},t.create=function(e,t,n){void 0===n&&(n=t);var r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))},t.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=e.findFrom(r,o,!0)||e.findFrom(r,-o,!0);if(!s)return e.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(e.findFrom(n,-o,!0)||e.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new t(n,r)},Object.defineProperties(t.prototype,n),t}(Rt);Rt.jsonID("text",_t);var jt=function(e,t){this.anchor=e,this.head=t};jt.prototype.map=function(e){return new jt(e.map(this.anchor),e.map(this.head))},jt.prototype.resolve=function(e){return _t.between(e.resolve(this.anchor),e.resolve(this.head))};var Bt=function(e){function t(t){var n=t.nodeAfter,r=t.node(0).resolve(t.pos+n.nodeSize);e.call(this,t,r),this.node=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?e.near(a):new t(a)},t.prototype.content=function(){return new U(L.from(this.node),0,0)},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor},t.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},t.prototype.getBookmark=function(){return new Lt(this.anchor)},t.fromJSON=function(e,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(e.resolve(n.anchor))},t.create=function(e,t){return new this(e.resolve(t))},t.isSelectable=function(e){return!e.isText&&!1!==e.type.spec.selectable},t}(Rt);Bt.prototype.visible=!1,Rt.jsonID("node",Bt);var Lt=function(e){this.anchor=e};Lt.prototype.map=function(e){var t=e.mapResult(this.anchor),n=t.deleted,r=t.pos;return n?new jt(r,r):new Lt(r)},Lt.prototype.resolve=function(e){var t=e.resolve(this.anchor),n=t.nodeAfter;return n&&Bt.isSelectable(n)?new Bt(t):Rt.near(t)};var Vt=function(e){function t(t){e.call(this,t.resolve(0),t.resolve(t.content.size))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.replace=function(t,n){if(void 0===n&&(n=U.empty),n==U.empty){t.delete(0,t.doc.content.size);var r=e.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else e.prototype.replace.call(this,t,n)},t.prototype.toJSON=function(){return{type:"all"}},t.fromJSON=function(e){return new t(e)},t.prototype.map=function(e){return new t(e)},t.prototype.eq=function(e){return e instanceof t},t.prototype.getBookmark=function(){return Wt},t}(Rt);Rt.jsonID("all",Vt);var Wt={map:function(){return this},resolve:function(e){return new Vt(e)}};function qt(e,t,n,r,o,i){if(t.inlineContent)return _t.create(e,n);for(var s=r-(o>0?0:1);o>0?s<t.childCount:s>=0;s+=o){var a=t.child(s);if(a.isAtom){if(!i&&Bt.isSelectable(a))return Bt.create(e,n-(o<0?a.nodeSize:0))}else{var c=qt(e,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function Ht(e,t,n){var r=e.steps.length-1;if(!(r<t)){var o,i=e.steps[r];if(i instanceof dt||i instanceof pt)e.mapping.maps[r].forEach((function(e,t,n,r){null==o&&(o=r)})),e.setSelection(Rt.near(e.doc.resolve(o),n))}}var Jt=function(e){function t(t){e.call(this,t.doc),this.time=Date.now(),this.curSelection=t.selection,this.curSelectionFor=0,this.storedMarks=t.storedMarks,this.updated=0,this.meta=Object.create(null)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},t.prototype.setSelection=function(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},t.prototype.setStoredMarks=function(e){return this.storedMarks=e,this.updated|=2,this},t.prototype.ensureMarks=function(e){return J.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this},t.prototype.addStoredMark=function(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))},t.prototype.removeStoredMark=function(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},t.prototype.addStep=function(t,n){e.prototype.addStep.call(this,t,n),this.updated=-3&this.updated,this.storedMarks=null},t.prototype.setTime=function(e){return this.time=e,this},t.prototype.replaceSelection=function(e){return this.selection.replace(this,e),this},t.prototype.replaceSelectionWith=function(e,t){var n=this.selection;return!1!==t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||J.none))),n.replaceWith(this,e),this},t.prototype.deleteSelection=function(){return this.selection.replace(this),this},t.prototype.insertText=function(e,t,n){void 0===n&&(n=t);var r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();if(!e)return this.deleteRange(t,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(t);o=n==t?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.setSelection(Rt.near(this.selection.$to)),this},t.prototype.setMeta=function(e,t){return this.meta["string"==typeof e?e:e.key]=t,this},t.prototype.getMeta=function(e){return this.meta["string"==typeof e?e:e.key]},n.isGeneric.get=function(){for(var e in this.meta)return!1;return!0},t.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(t.prototype,n),t}(st);function Kt(e,t){return t&&e?e.bind(t):e}var Ut=function(e,t,n){this.name=e,this.init=Kt(t.init,n),this.apply=Kt(t.apply,n)},Gt=[new Ut("doc",{init:function(e){return e.doc||e.schema.topNodeType.createAndFill()},apply:function(e){return e.doc}}),new Ut("selection",{init:function(e,t){return e.selection||Rt.atStart(t.doc)},apply:function(e){return e.selection}}),new Ut("storedMarks",{init:function(e){return e.storedMarks||null},apply:function(e,t,n,r){return r.selection.$cursor?e.storedMarks:null}}),new Ut("scrollToSelection",{init:function(){return 0},apply:function(e,t){return e.scrolledIntoView?t+1:t}})],Qt=function(e,t){var n=this;this.schema=e,this.fields=Gt.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),t&&t.forEach((function(e){if(n.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");n.plugins.push(e),n.pluginsByKey[e.key]=e,e.spec.state&&n.fields.push(new Ut(e.key,e.spec.state,e))}))},Xt=function(e){this.config=e},Zt={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};Zt.schema.get=function(){return this.config.schema},Zt.plugins.get=function(){return this.config.plugins},Xt.prototype.apply=function(e){return this.applyTransaction(e).state},Xt.prototype.filterTransaction=function(e,t){void 0===t&&(t=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=t){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,e,this))return!1}return!0},Xt.prototype.applyTransaction=function(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};for(var t=[e],n=this.applyInner(e),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,l=a<t.length&&s.spec.appendTransaction.call(s,a?t.slice(a):t,c,n);if(l&&n.filterTransaction(l,i)){if(l.setMeta("appendedTransaction",e),!r){r=[];for(var u=0;u<this.config.plugins.length;u++)r.push(u<i?{state:n,n:t.length}:{state:this,n:0})}t.push(l),n=n.applyInner(l),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}},Xt.prototype.applyInner=function(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var t=new Xt(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];t[o.name]=o.apply(e,this[o.name],this,t)}for(var i=0;i<Yt.length;i++)Yt[i](this,e,t);return t},Zt.tr.get=function(){return new Jt(this)},Xt.create=function(e){for(var t=new Qt(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new Xt(t),r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n},Xt.prototype.reconfigure=function(e){for(var t=new Qt(this.schema,e.plugins),n=t.fields,r=new Xt(t),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(e,r)}return r},Xt.prototype.toJSON=function(e){var t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map((function(e){return e.toJSON()}))),e&&"object"==typeof e)for(var n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=e[n],o=r.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(r,this[r.key]))}return t},Xt.fromJSON=function(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");var r=new Qt(e.schema,e.plugins),o=new Xt(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=me.fromJSON(e.schema,t.doc);else if("selection"==r.name)o.selection=Rt.fromJSON(o.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(o[r.name]=a.fromJSON.call(s,e,t[i],o))}o[r.name]=r.init(e,o)}})),o},Xt.addApplyListener=function(e){Yt.push(e)},Xt.removeApplyListener=function(e){var t=Yt.indexOf(e);t>-1&&Yt.splice(t,1)},Object.defineProperties(Xt.prototype,Zt);var Yt=[];function en(e,t,n){for(var r in e){var o=e[r];o instanceof Function?o=o.bind(t):"handleDOMEvents"==r&&(o=en(o,t,{})),n[r]=o}return n}var tn=function(e){this.props={},e.props&&en(e.props,this,this.props),this.spec=e,this.key=e.key?e.key.key:rn("plugin")};tn.prototype.getState=function(e){return e[this.key]};var nn=Object.create(null);function rn(e){return e in nn?e+"$"+ ++nn[e]:(nn[e]=0,e+"$")}var on=function(e){void 0===e&&(e="key"),this.key=rn(e)};function sn(e,t){return!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)}function an(e,t,n){for(;e;e="start"==t?e.firstChild:e.lastChild){if(e.isTextblock)return!0;if(n&&1!=e.childCount)return!1}return!1}function cn(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function ln(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){var n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}function un(e){for(var t=0;t<e.edgeCount;t++){var n=e.edge(t).type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function fn(e,t,n){var r,o,i=t.nodeBefore,s=t.nodeAfter;if(i.type.spec.isolating||s.type.spec.isolating)return!1;if(function(e,t,n){var r=t.nodeBefore,o=t.nodeAfter,i=t.index();return!(!(r&&o&&r.type.compatibleContent(o.type))||(!r.content.size&&t.parent.canReplace(i-1,i)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(i,i+1)||!o.isTextblock&&!wt(e.doc,t.pos)||(n&&n(e.tr.clearIncompatible(t.pos,r.type,r.contentMatchAt(r.childCount)).join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;var a=t.parent.canReplace(t.index(),t.index()+1);if(a&&(r=(o=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&o.matchType(r[0]||s.type).validEnd){if(n){for(var c=t.pos+s.nodeSize,l=L.empty,u=r.length-1;u>=0;u--)l=L.from(r[u].create(null,l));l=L.from(i.copy(l));var f=e.tr.step(new pt(t.pos-1,c,t.pos,c,new U(l,1,0),r.length,!0)),d=c+2*r.length;wt(f.doc,d)&&f.join(d),n(f.scrollIntoView())}return!0}var p=Rt.findFrom(t,1),h=p&&p.$from.blockRange(p.$to),m=h&&vt(h);if(null!=m&&m>=t.depth)return n&&n(e.tr.lift(h,m).scrollIntoView()),!0;if(a&&an(s,"start",!0)&&an(i,"end")){for(var v=i,g=[];g.push(v),!v.isTextblock;)v=v.lastChild;for(var y=s,b=1;!y.isTextblock;y=y.firstChild)b++;if(v.canReplace(v.childCount,v.childCount,y.content)){if(n){for(var w=L.empty,k=g.length-1;k>=0;k--)w=L.from(g[k].copy(w));n(e.tr.step(new pt(t.pos-g.length,t.pos+s.nodeSize,t.pos+b,t.pos+s.nodeSize-b,new U(w,g.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function dn(e,t){return function(n,r){var o=n.selection,i=o.$from,s=o.$to,a=i.blockRange(s),c=a&&gt(a,e,t);return!!c&&(r&&r(n.tr.wrap(a,c).scrollIntoView()),!0)}}function pn(e,t){return function(n,r){var o=n.selection,i=o.from,s=o.to,a=!1;return n.doc.nodesBetween(i,s,(function(r,o){if(a)return!1;if(r.isTextblock&&!r.hasMarkup(e,t))if(r.type==e)a=!0;else{var i=n.doc.resolve(o),s=i.index();a=i.parent.canReplaceWith(s,s+1,e)}})),!!a&&(r&&r(n.tr.setBlockType(i,s,e,t).scrollIntoView()),!0)}}function hn(e,t){return function(n,r){var o=n.selection,i=o.empty,s=o.$cursor,a=o.ranges;if(i&&!s||!function(e,t,n){for(var r=function(r){var o=t[r],i=o.$from,s=o.$to,a=0==i.depth&&e.type.allowsMarkType(n);if(e.nodesBetween(i.pos,s.pos,(function(e){if(a)return!1;a=e.inlineContent&&e.type.allowsMarkType(n)})),a)return{v:!0}},o=0;o<t.length;o++){var i=r(o);if(i)return i.v}return!1}(n.doc,a,e))return!1;if(r)if(s)e.isInSet(n.storedMarks||s.marks())?r(n.tr.removeStoredMark(e)):r(n.tr.addStoredMark(e.create(t)));else{for(var c=!1,l=n.tr,u=0;!c&&u<a.length;u++){var f=a[u],d=f.$from,p=f.$to;c=n.doc.rangeHasMark(d.pos,p.pos,e)}for(var h=0;h<a.length;h++){var m=a[h],v=m.$from,g=m.$to;if(c)l.removeMark(v.pos,g.pos,e);else{var y=v.pos,b=g.pos,w=v.nodeAfter,k=g.nodeBefore,x=w&&w.isText?/^\s*/.exec(w.text)[0].length:0,S=k&&k.isText?/\s*$/.exec(k.text)[0].length:0;y+x<b&&(y+=x,b-=S),l.addMark(y,b,e.create(t))}}r(l.scrollIntoView())}return!0}}function mn(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t,n,r){for(var o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}on.prototype.get=function(e){return e.config.pluginsByKey[this.key]},on.prototype.getState=function(e){return e[this.key]};var vn=mn(sn,(function(e,t,n){var r=e.selection.$cursor;if(!r||(n?!n.endOfTextblock("backward",e):r.parentOffset>0))return!1;var o=cn(r);if(!o){var i=r.blockRange(),s=i&&vt(i);return null!=s&&(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)}var a=o.nodeBefore;if(!a.type.spec.isolating&&fn(e,o,t))return!0;if(0==r.parent.content.size&&(an(a,"end")||Bt.isSelectable(a))){if(t){var c=e.tr.deleteRange(r.before(),r.after());c.setSelection(an(a,"end")?Rt.findFrom(c.doc.resolve(c.mapping.map(o.pos,-1)),-1):Bt.create(c.doc,o.pos-a.nodeSize)),t(c.scrollIntoView())}return!0}return!(!a.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos-a.nodeSize,o.pos).scrollIntoView()),!0)}),(function(e,t,n){var r=e.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):o.parentOffset>0)return!1;i=cn(o)}var s=i&&i.nodeBefore;return!(!s||!Bt.isSelectable(s))&&(t&&t(e.tr.setSelection(Bt.create(e.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)})),gn=mn(sn,(function(e,t,n){var r=e.selection.$cursor;if(!r||(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size))return!1;var o=ln(r);if(!o)return!1;var i=o.nodeAfter;if(fn(e,o,t))return!0;if(0==r.parent.content.size&&(an(i,"start")||Bt.isSelectable(i))){if(t){var s=e.tr.deleteRange(r.before(),r.after());s.setSelection(an(i,"start")?Rt.findFrom(s.doc.resolve(s.mapping.map(o.pos)),1):Bt.create(s.doc,s.mapping.map(o.pos))),t(s.scrollIntoView())}return!0}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)}),(function(e,t,n){var r=e.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size)return!1;i=ln(o)}var s=i&&i.nodeAfter;return!(!s||!Bt.isSelectable(s))&&(t&&t(e.tr.setSelection(Bt.create(e.doc,i.pos)).scrollIntoView()),!0)})),yn={Enter:mn((function(e,t){var n=e.selection,r=n.$head,o=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(o))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)}),(function(e,t){var n=e.selection,r=n.$from,o=n.$to;if(n instanceof Vt||r.parent.inlineContent||o.parent.inlineContent)return!1;var i=un(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){var s=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=e.tr.insert(s,i.createAndFill());a.setSelection(_t.create(a.doc,s+1)),t(a.scrollIntoView())}return!0}),(function(e,t){var n=e.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var r=n.before();if(bt(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}var o=n.blockRange(),i=o&&vt(o);return null!=i&&(t&&t(e.tr.lift(o,i).scrollIntoView()),!0)}),(function(e,t){var n=e.selection,r=n.$from,o=n.$to;if(e.selection instanceof Bt&&e.selection.node.isBlock)return!(!r.parentOffset||!bt(e.doc,r.pos))&&(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(t){var i=o.parentOffset==o.parent.content.size,s=e.tr;(e.selection instanceof _t||e.selection instanceof Vt)&&s.deleteSelection();var a=0==r.depth?null:un(r.node(-1).contentMatchAt(r.indexAfter(-1))),c=i&&a?[{type:a}]:null,l=bt(s.doc,s.mapping.map(r.pos),1,c);if(c||l||!bt(s.doc,s.mapping.map(r.pos),1,a&&[{type:a}])||(c=[{type:a}],l=!0),l&&(s.split(s.mapping.map(r.pos),1,c),!i&&!r.parentOffset&&r.parent.type!=a)){var u=s.mapping.map(r.before()),f=s.doc.resolve(u);r.node(-1).canReplaceWith(f.index(),f.index()+1,a)&&s.setNodeMarkup(s.mapping.map(r.before()),a)}t(s.scrollIntoView())}return!0})),"Mod-Enter":function(e,t){var n=e.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var i=r.node(-1),s=r.indexAfter(-1),a=un(i.contentMatchAt(s));if(!i.canReplaceWith(s,s,a))return!1;if(t){var c=r.after(),l=e.tr.replaceWith(c,c,a.createAndFill());l.setSelection(Rt.near(l.doc.resolve(c),1)),t(l.scrollIntoView())}return!0},Backspace:vn,"Mod-Backspace":vn,"Shift-Backspace":vn,Delete:gn,"Mod-Delete":gn,"Mod-a":function(e,t){return t&&t(e.tr.setSelection(new Vt(e.doc))),!0}},bn={"Ctrl-h":yn.Backspace,"Alt-Backspace":yn["Mod-Backspace"],"Ctrl-d":yn.Delete,"Ctrl-Alt-Backspace":yn["Mod-Delete"],"Alt-Delete":yn["Mod-Delete"],"Alt-d":yn["Mod-Delete"]};for(var wn in yn)bn[wn]=yn[wn];var kn=("undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform())?bn:yn,xn=function(e,t){var n;this.match=e,this.handler="string"==typeof t?(n=t,function(e,t,r,o){var i=n;if(t[1]){var s=t[0].lastIndexOf(t[1]);i+=t[0].slice(s+t[1].length);var a=(r+=s)-o;a>0&&(i=t[0].slice(s-a,s)+i,r=o)}return e.tr.insertText(i,r,o)}):t};function Sn(e){var t=e.rules,n=new tn({state:{init:function(){return null},apply:function(e,t){var n=e.getMeta(this);return n||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:function(e,r,o,i){return Cn(e,r,o,i,t,n)},handleDOMEvents:{compositionend:function(e){setTimeout((function(){var r=e.state.selection.$cursor;r&&Cn(e,r.pos,r.pos,"",t,n)}))}}},isInputRules:!0});return n}function Cn(e,t,n,r,o,i){if(e.composing)return!1;var s=e.state,a=s.doc.resolve(t);if(a.parent.type.spec.code)return!1;for(var c=a.parent.textBetween(Math.max(0,a.parentOffset-500),a.parentOffset,null,"￼")+r,l=0;l<o.length;l++){var u=o[l].match.exec(c),f=u&&o[l].handler(s,u,t-(u[0].length-r.length),n);if(f)return e.dispatch(f.setMeta(i,{transform:f,from:t,to:n,text:r})),!0}return!1}function Mn(e,t,n,r){return new xn(e,(function(e,o,i,s){var a=n instanceof Function?n(o):n,c=e.tr.delete(i,s),l=c.doc.resolve(i).blockRange(),u=l&&gt(l,t,a);if(!u)return null;c.wrap(l,u);var f=c.doc.resolve(i-1).nodeBefore;return f&&f.type==t&&wt(c.doc,i-1)&&(!r||r(o,f))&&c.join(i-1),c}))}function On(e,t,n){return new xn(e,(function(e,r,o,i){var s=e.doc.resolve(o),a=n instanceof Function?n(r):n;return s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t)?e.tr.delete(o,i).setBlockType(o,o,t,a):null}))}new xn(/--$/,"—"),new xn(/\.\.\.$/,"…"),new xn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“"),new xn(/"$/,"”"),new xn(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘"),new xn(/'$/,"’");for(var An={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},En={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},Tn="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),Nn="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),Dn="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),zn="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),In="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),$n=Tn&&(zn||+Tn[1]<57)||Dn&&zn,Rn=0;Rn<10;Rn++)An[48+Rn]=An[96+Rn]=String(Rn);for(Rn=1;Rn<=24;Rn++)An[Rn+111]="F"+Rn;for(Rn=65;Rn<=90;Rn++)An[Rn]=String.fromCharCode(Rn+32),En[Rn]=String.fromCharCode(Rn);for(var Fn in An)En.hasOwnProperty(Fn)||(En[Fn]=An[Fn]);var Pn="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function _n(e){var t,n,r,o,i=e.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(var a=0;a<i.length-1;a++){var c=i[a];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))t=!0;else if(/^(c|ctrl|control)$/i.test(c))n=!0;else if(/^s(hift)?$/i.test(c))r=!0;else{if(!/^mod$/i.test(c))throw new Error("Unrecognized modifier name: "+c);Pn?o=!0:n=!0}}return t&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function jn(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}function Bn(e){return new tn({props:{handleKeyDown:Ln(e)}})}function Ln(e){var t=function(e){var t=Object.create(null);for(var n in e)t[_n(n)]=e[n];return t}(e);return function(e,n){var r,o=function(e){var t=!($n&&(e.ctrlKey||e.altKey||e.metaKey)||(Nn||In)&&e.shiftKey&&e.key&&1==e.key.length)&&e.key||(e.shiftKey?En:An)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),i=1==o.length&&" "!=o,s=t[jn(o,n,!i)];if(s&&s(e.state,e.dispatch,e))return!0;if(i&&(n.shiftKey||n.altKey||n.metaKey||o.charCodeAt(0)>127)&&(r=An[n.keyCode])&&r!=o){var a=t[jn(r,n,!0)];if(a&&a(e.state,e.dispatch,e))return!0}else if(i&&n.shiftKey){var c=t[jn(o,n,!0)];if(c&&c(e.state,e.dispatch,e))return!0}return!1}}var Vn={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var Wn=/Edge\/(\d+)/.exec(navigator.userAgent),qn=/MSIE \d/.test(navigator.userAgent),Hn=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);Vn.mac=/Mac/.test(navigator.platform);var Jn=Vn.ie=!!(qn||Hn||Wn);Vn.ie_version=qn?document.documentMode||6:Hn?+Hn[1]:Wn?+Wn[1]:null,Vn.gecko=!Jn&&/gecko\/(\d+)/i.test(navigator.userAgent),Vn.gecko_version=Vn.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var Kn=!Jn&&/Chrome\/(\d+)/.exec(navigator.userAgent);Vn.chrome=!!Kn,Vn.chrome_version=Kn&&+Kn[1],Vn.safari=!Jn&&/Apple Computer/.test(navigator.vendor),Vn.ios=Vn.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),Vn.android=/Android \d/.test(navigator.userAgent),Vn.webkit="webkitFontSmoothing"in document.documentElement.style,Vn.webkit_version=Vn.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var Un=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},Gn=function(e){var t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},Qn=null,Xn=function(e,t,n){var r=Qn||(Qn=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},Zn=function(e,t,n,r){return n&&(er(e,t,n,r,-1)||er(e,t,n,r,1))},Yn=/^(img|br|input|textarea|hr)$/i;function er(e,t,n,r,o){for(;;){if(e==n&&t==r)return!0;if(t==(o<0?0:tr(e))){var i=e.parentNode;if(1!=i.nodeType||nr(e)||Yn.test(e.nodeName)||"false"==e.contentEditable)return!1;t=Un(e)+(o<0?0:1),e=i}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(o<0?-1:0)]).contentEditable)return!1;t=o<0?tr(e):0}}}function tr(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function nr(e){for(var t,n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var rr=function(e){var t=e.isCollapsed;return t&&Vn.chrome&&e.rangeCount&&!e.getRangeAt(0).collapsed&&(t=!1),t};function or(e,t){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}function ir(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function sr(e,t){return"number"==typeof e?e:e[t]}function ar(e){var t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function cr(e,t,n){for(var r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument,s=n||e.dom;s;s=Gn(s))if(1==s.nodeType){var a=s==i.body||1!=s.nodeType,c=a?ir(i):ar(s),l=0,u=0;if(t.top<c.top+sr(r,"top")?u=-(c.top-t.top+sr(o,"top")):t.bottom>c.bottom-sr(r,"bottom")&&(u=t.bottom-c.bottom+sr(o,"bottom")),t.left<c.left+sr(r,"left")?l=-(c.left-t.left+sr(o,"left")):t.right>c.right-sr(r,"right")&&(l=t.right-c.right+sr(o,"right")),l||u)if(a)i.defaultView.scrollBy(l,u);else{var f=s.scrollLeft,d=s.scrollTop;u&&(s.scrollTop+=u),l&&(s.scrollLeft+=l);var p=s.scrollLeft-f,h=s.scrollTop-d;t={left:t.left-p,top:t.top-h,right:t.right-p,bottom:t.bottom-h}}if(a)break}}function lr(e){for(var t=[],n=e.ownerDocument;e&&(t.push({dom:e,top:e.scrollTop,left:e.scrollLeft}),e!=n);e=Gn(e));return t}function ur(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=r.dom,i=r.top,s=r.left;o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=s&&(o.scrollLeft=s)}}var fr=null;function dr(e,t){for(var n,r,o=2e8,i=0,s=t.top,a=t.top,c=e.firstChild,l=0;c;c=c.nextSibling,l++){var u=void 0;if(1==c.nodeType)u=c.getClientRects();else{if(3!=c.nodeType)continue;u=Xn(c).getClientRects()}for(var f=0;f<u.length;f++){var d=u[f];if(d.top<=s&&d.bottom>=a){s=Math.max(d.bottom,s),a=Math.min(d.top,a);var p=d.left>t.left?d.left-t.left:d.right<t.left?t.left-d.right:0;if(p<o){n=c,o=p,r=p&&3==n.nodeType?{left:d.right<t.left?d.right:d.left,top:t.top}:t,1==c.nodeType&&p&&(i=l+(t.left>=(d.left+d.right)/2?1:0));continue}}!n&&(t.left>=d.right&&t.top>=d.top||t.left>=d.left&&t.top>=d.bottom)&&(i=l+1)}}return n&&3==n.nodeType?function(e,t){for(var n=e.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(e,o+1),r.setStart(e,o);var i=vr(r,1);if(i.top!=i.bottom&&pr(t,i))return{node:e,offset:o+(t.left>=(i.left+i.right)/2?1:0)}}return{node:e,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:e,offset:i}:dr(n,r)}function pr(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function hr(e,t,n){var r=e.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var s=e.childNodes[i];if(1==s.nodeType)for(var a=s.getClientRects(),c=0;c<a.length;c++){var l=a[c];if(pr(t,l))return hr(s,t,l)}if((i=(i+1)%r)==o)break}return e}function mr(e,t){var n,r,o,i,s=e.dom.ownerDocument;if(s.caretPositionFromPoint)try{var a=s.caretPositionFromPoint(t.left,t.top);a&&(o=(n=a).offsetNode,i=n.offset)}catch(v){}if(!o&&s.caretRangeFromPoint){var c=s.caretRangeFromPoint(t.left,t.top);c&&(o=(r=c).startContainer,i=r.startOffset)}var l,u=(e.root.elementFromPoint?e.root:s).elementFromPoint(t.left,t.top+1);if(!u||!e.dom.contains(1!=u.nodeType?u.parentNode:u)){var f=e.dom.getBoundingClientRect();if(!pr(t,f))return null;if(!(u=hr(e.dom,t,f)))return null}if(Vn.safari)for(var d=u;o&&d;d=Gn(d))d.draggable&&(o=i=null);if(u=function(e,t){var n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(u,t),o){if(Vn.gecko&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length))<o.childNodes.length){var p,h=o.childNodes[i];"IMG"==h.nodeName&&(p=h.getBoundingClientRect()).right<=t.left&&p.bottom>t.top&&i++}o==e.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?l=e.state.doc.content.size:0!=i&&1==o.nodeType&&"BR"==o.childNodes[i-1].nodeName||(l=function(e,t,n,r){for(var o=-1,i=t;i!=e.dom;){var s=e.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n)}(e,o,i,t))}null==l&&(l=function(e,t,n){var r=dr(t,n),o=r.node,i=r.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return e.docView.posFromDOM(o,i,s)}(e,u,t));var m=e.docView.nearestDesc(u,!0);return{pos:l,inside:m?m.posAtStart-m.border:-1}}function vr(e,t){var n=e.getClientRects();return n.length?n[t<0?0:n.length-1]:e.getBoundingClientRect()}var gr=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function yr(e,t,n){var r=e.docView.domFromPos(t,n<0?-1:1),o=r.node,i=r.offset,s=Vn.webkit||Vn.gecko;if(3==o.nodeType){if(!s||!gr.test(o.nodeValue)&&(n<0?i:i!=o.nodeValue.length)){var a=i,c=i,l=n<0?1:-1;return n<0&&!i?(c++,l=-1):n>=0&&i==o.nodeValue.length?(a--,l=1):n<0?a--:c++,br(vr(Xn(o,a,c),l),l<0)}var u=vr(Xn(o,i,i),n);if(Vn.gecko&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var f=vr(Xn(o,i-1,i-1),-1);if(f.top==u.top){var d=vr(Xn(o,i,i+1),-1);if(d.top!=u.top)return br(d,d.left<f.left)}}return u}if(!e.state.doc.resolve(t).parent.inlineContent){if(i&&(n<0||i==tr(o))){var p=o.childNodes[i-1];if(1==p.nodeType)return wr(p.getBoundingClientRect(),!1)}if(i<tr(o)){var h=o.childNodes[i];if(1==h.nodeType)return wr(h.getBoundingClientRect(),!0)}return wr(o.getBoundingClientRect(),n>=0)}if(i&&(n<0||i==tr(o))){var m=o.childNodes[i-1],v=3==m.nodeType?Xn(m,tr(m)-(s?0:1)):1!=m.nodeType||"BR"==m.nodeName&&m.nextSibling?null:m;if(v)return br(vr(v,1),!1)}if(i<tr(o)){for(var g=o.childNodes[i];g.pmViewDesc&&g.pmViewDesc.ignoreForCoords;)g=g.nextSibling;var y=g?3==g.nodeType?Xn(g,0,s?0:1):1==g.nodeType?g:null:null;if(y)return br(vr(y,-1),!0)}return br(vr(3==o.nodeType?Xn(o):o,-n),n>=0)}function br(e,t){if(0==e.width)return e;var n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function wr(e,t){if(0==e.height)return e;var n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function kr(e,t,n){var r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o&&o.focus()}}var xr=/[\u0590-\u08ac]/;var Sr=null,Cr=null,Mr=!1;function Or(e,t,n){return Sr==t&&Cr==n?Mr:(Sr=t,Cr=n,Mr="up"==n||"down"==n?function(e,t,n){var r=t.selection,o="up"==n?r.$from:r.$to;return kr(e,t,(function(){for(var t=e.docView.domFromPos(o.pos,"up"==n?-1:1).node;;){var r=e.docView.nearestDesc(t,!0);if(!r)break;if(r.node.isBlock){t=r.dom;break}t=r.dom.parentNode}for(var i=yr(e,o.pos,1),s=t.firstChild;s;s=s.nextSibling){var a=void 0;if(1==s.nodeType)a=s.getClientRects();else{if(3!=s.nodeType)continue;a=Xn(s,0,s.nodeValue.length).getClientRects()}for(var c=0;c<a.length;c++){var l=a[c];if(l.bottom>l.top+1&&("up"==n?i.top-l.top>2*(l.bottom-i.top):l.bottom-i.bottom>2*(i.bottom-l.top)))return!1}}return!0}))}(e,t,n):function(e,t,n){var r=t.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=e.root.getSelection();return xr.test(r.parent.textContent)&&a.modify?kr(e,t,(function(){var t=a.getRangeAt(0),o=a.focusNode,i=a.focusOffset,s=a.caretBidiLevel;a.modify("move",n,"character");var c=!(r.depth?e.docView.domAfterPos(r.before()):e.dom).contains(1==a.focusNode.nodeType?a.focusNode:a.focusNode.parentNode)||o==a.focusNode&&i==a.focusOffset;return a.removeAllRanges(),a.addRange(t),null!=s&&(a.caretBidiLevel=s),c})):"left"==n||"backward"==n?i:s}(e,t,n))}var Ar=function(e,t,n,r){this.parent=e,this.children=t,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},Er={size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};Ar.prototype.matchesWidget=function(){return!1},Ar.prototype.matchesMark=function(){return!1},Ar.prototype.matchesNode=function(){return!1},Ar.prototype.matchesHack=function(e){return!1},Ar.prototype.parseRule=function(){return null},Ar.prototype.stopEvent=function(){return!1},Er.size.get=function(){for(var e=0,t=0;t<this.children.length;t++)e+=this.children[t].size;return e},Er.border.get=function(){return 0},Ar.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var e=0;e<this.children.length;e++)this.children[e].destroy()},Ar.prototype.posBeforeChild=function(e){for(var t=0,n=this.posAtStart;t<this.children.length;t++){var r=this.children[t];if(r==e)return n;n+=r.size}},Er.posBefore.get=function(){return this.parent.posBeforeChild(this)},Er.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Er.posAfter.get=function(){return this.posBefore+this.size},Er.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},Ar.prototype.localPosFromDOM=function(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){var r,o;if(e==this.contentDOM)r=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;r=e.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,s;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&(!(s=i.pmViewDesc)||s.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}var a;if(e==this.dom&&this.contentDOM)a=t>Un(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(var c=e;;c=c.parentNode){if(c==this.dom){a=!1;break}if(c.parentNode.firstChild!=c)break}if(null==a&&t==e.childNodes.length)for(var l=e;;l=l.parentNode){if(l==this.dom){a=!0;break}if(l.parentNode.lastChild!=l)break}}return(null==a?n>0:a)?this.posAtEnd:this.posAtStart},Ar.prototype.nearestDesc=function(e,t){for(var n=!0,r=e;r;r=r.parentNode){var o=this.getDesc(r);if(o&&(!t||o.node)){if(!n||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(1==e.nodeType?e:e.parentNode):o.nodeDOM==e))return o;n=!1}}},Ar.prototype.getDesc=function(e){for(var t=e.pmViewDesc,n=t;n;n=n.parent)if(n==this)return t},Ar.prototype.posFromDOM=function(e,t,n){for(var r=e;r;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(e,t,n)}return-1},Ar.prototype.descAt=function(e){for(var t=0,n=0;t<this.children.length;t++){var r=this.children[t],o=n+r.size;if(n==e&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(e<o)return r.descAt(e-n-r.border);n=o}},Ar.prototype.domFromPos=function(e,t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var n=0,r=0,o=0;n<this.children.length;n++){var i=this.children[n],s=o+i.size;if(s>e||i instanceof Fr){r=e-o;break}o=s}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(var a=void 0;n&&!(a=this.children[n-1]).size&&a instanceof Nr&&a.widget.type.side>=0;n--);if(t<=0){for(var c,l=!0;(c=n?this.children[n-1]:null)&&c.dom.parentNode!=this.contentDOM;n--,l=!1);return c&&t&&l&&!c.border&&!c.domAtom?c.domFromPos(c.size,t):{node:this.contentDOM,offset:c?Un(c.dom)+1:0}}for(var u,f=!0;(u=n<this.children.length?this.children[n]:null)&&u.dom.parentNode!=this.contentDOM;n++,f=!1);return u&&f&&!u.border&&!u.domAtom?u.domFromPos(0,t):{node:this.contentDOM,offset:u?Un(u.dom):this.contentDOM.childNodes.length}},Ar.prototype.parseRange=function(e,t,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,s=0;;s++){var a=this.children[s],c=i+a.size;if(-1==r&&e<=c){var l=i+a.border;if(e>=l&&t<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,l);e=i;for(var u=s;u>0;u--){var f=this.children[u-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){r=Un(f.dom)+1;break}e-=f.size}-1==r&&(r=0)}if(r>-1&&(c>t||s==this.children.length-1)){t=c;for(var d=s+1;d<this.children.length;d++){var p=this.children[d];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){o=Un(p.dom);break}t+=p.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:o}},Ar.prototype.emptyChildAt=function(e){if(this.border||!this.contentDOM||!this.children.length)return!1;var t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)},Ar.prototype.domAfterPos=function(e){var t=this.domFromPos(e,0),n=t.node,r=t.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]},Ar.prototype.setSelection=function(e,t,n,r){for(var o=Math.min(e,t),i=Math.max(e,t),s=0,a=0;s<this.children.length;s++){var c=this.children[s],l=a+c.size;if(o>a&&i<l)return c.setSelection(e-a-c.border,t-a-c.border,n,r);a=l}var u=this.domFromPos(e,e?-1:1),f=t==e?u:this.domFromPos(t,t?-1:1),d=n.getSelection(),p=!1;if((Vn.gecko||Vn.safari)&&e==t){var h=u.node,m=u.offset;if(3==h.nodeType){if((p=m&&"\n"==h.nodeValue[m-1])&&m==h.nodeValue.length)for(var v=h,g=void 0;v;v=v.parentNode){if(g=v.nextSibling){"BR"==g.nodeName&&(u=f={node:g.parentNode,offset:Un(g)+1});break}var y=v.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{var b=h.childNodes[m-1];p=b&&("BR"==b.nodeName||"false"==b.contentEditable)}}if(Vn.gecko&&d.focusNode&&d.focusNode!=f.node&&1==d.focusNode.nodeType){var w=d.focusNode.childNodes[d.focusOffset];w&&"false"==w.contentEditable&&(r=!0)}if(r||p&&Vn.safari||!Zn(u.node,u.offset,d.anchorNode,d.anchorOffset)||!Zn(f.node,f.offset,d.focusNode,d.focusOffset)){var k=!1;if((d.extend||e==t)&&!p){d.collapse(u.node,u.offset);try{e!=t&&d.extend(f.node,f.offset),k=!0}catch(C){if(!(C instanceof DOMException))throw C}}if(!k){if(e>t){var x=u;u=f,f=x}var S=document.createRange();S.setEnd(f.node,f.offset),S.setStart(u.node,u.offset),d.removeAllRanges(),d.addRange(S)}}},Ar.prototype.ignoreMutation=function(e){return!this.contentDOM&&"selection"!=e.type},Er.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},Ar.prototype.markDirty=function(e,t){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?e<=i&&t>=n:e<i&&t>n){var s=n+o.border,a=i-o.border;if(e>=s&&t<=a)return this.dirty=e==n||t==i?2:1,void(e!=s||t!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(e-s,t-s):o.dirty=3);o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM?2:3}n=i}this.dirty=2},Ar.prototype.markParentsDirty=function(){for(var e=1,t=this.parent;t;t=t.parent,e++){var n=1==e?2:1;t.dirty<n&&(t.dirty=n)}},Er.domAtom.get=function(){return!1},Er.ignoreForCoords.get=function(){return!1},Object.defineProperties(Ar.prototype,Er);var Tr=[],Nr=function(e){function t(t,n,r,o){var i,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable=!1,s.classList.add("ProseMirror-widget")}e.call(this,t,Tr,s,null),this.widget=n,i=this}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.matchesWidget=function(e){return 0==this.dirty&&e.type.eq(this.widget.type)},t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.stopEvent=function(e){var t=this.widget.spec.stopEvent;return!!t&&t(e)},t.prototype.ignoreMutation=function(e){return"selection"!=e.type||this.widget.spec.ignoreSelection},n.domAtom.get=function(){return!0},Object.defineProperties(t.prototype,n),t}(Ar),Dr=function(e){function t(t,n,r,o){e.call(this,t,Tr,n,null),this.textDOM=r,this.text=o}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},t.prototype.localPosFromDOM=function(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t},t.prototype.domFromPos=function(e){return{node:this.textDOM,offset:e}},t.prototype.ignoreMutation=function(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue},Object.defineProperties(t.prototype,n),t}(Ar),zr=function(e){function t(t,n,r,o){e.call(this,t,[],r,o),this.mark=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.create=function(e,n,r,o){var i=o.nodeViews[n.type.name],s=i&&i(n,o,r);return s&&s.dom||(s=Xe.renderSpec(document,n.type.spec.toDOM(n,r))),new t(e,n,s.dom,s.contentDOM||s.dom)},t.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},t.prototype.matchesMark=function(e){return 3!=this.dirty&&this.mark.eq(e)},t.prototype.markDirty=function(t,n){if(e.prototype.markDirty.call(this,t,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},t.prototype.slice=function(e,n,r){var o=t.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=Gr(i,n,s,r)),e>0&&(i=Gr(i,0,e,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o},t}(Ar),Ir=function(e){function t(t,n,r,o,i,s,a,c,l){e.call(this,t,n.isLeaf?Tr:[],i,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=o,s&&this.updateChildren(c,l)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return t.create=function(e,n,r,o,i,s){var a,c,l=i.nodeViews[n.type.name],u=l&&l(n,i,(function(){return c?c.parent?c.parent.posBeforeChild(c):void 0:s}),r,o),f=u&&u.dom,d=u&&u.contentDOM;if(n.isText)if(f){if(3!=f.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else f=document.createTextNode(n.text);else f||(f=(a=Xe.renderSpec(document,n.type.spec.toDOM(n))).dom,d=a.contentDOM);d||n.isText||"BR"==f.nodeName||(f.hasAttribute("contenteditable")||(f.contentEditable=!1),n.type.spec.draggable&&(f.draggable=!0));var p=f;return f=qr(f,r,n),u?c=new Pr(e,n,r,o,f,d,p,u,i,s+1):n.isText?new Rr(e,n,r,o,f,p,i):new t(e,n,r,o,f,d,p,i,s+1)},t.prototype.parseRule=function(){var e=this;if(this.node.type.spec.reparseInView)return null;var t={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(t.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?t.contentElement=this.contentDOM:t.getContent=function(){return e.contentDOM?L.empty:e.node.content},t},t.prototype.matchesNode=function(e,t,n){return 0==this.dirty&&e.eq(this.node)&&Hr(t,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},t.prototype.updateChildren=function(e,t){var n=this,r=this.node.inlineContent,o=t,i=e.composing&&this.localCompositionInfo(e,t),s=i&&i.pos>-1?i:null,a=i&&i.pos<0,c=new Kr(this,s&&s.node);!function(e,t,n,r){var o=t.locals(e),i=0;if(0==o.length){for(var s=0;s<e.childCount;s++){var a=e.child(s);r(a,o,t.forChild(i,a),s),i+=a.nodeSize}return}for(var c=0,l=[],u=null,f=0;;){if(c<o.length&&o[c].to==i){for(var d=o[c++],p=void 0;c<o.length&&o[c].to==i;)(p||(p=[d])).push(o[c++]);if(p){p.sort(Ur);for(var h=0;h<p.length;h++)n(p[h],f,!!u)}else n(d,f,!!u)}var m=void 0,v=void 0;if(u)v=-1,m=u,u=null;else{if(!(f<e.childCount))break;v=f,m=e.child(f++)}for(var g=0;g<l.length;g++)l[g].to<=i&&l.splice(g--,1);for(;c<o.length&&o[c].from<=i&&o[c].to>i;)l.push(o[c++]);var y=i+m.nodeSize;if(m.isText){var b=y;c<o.length&&o[c].from<b&&(b=o[c].from);for(var w=0;w<l.length;w++)l[w].to<b&&(b=l[w].to);b<y&&(u=m.cut(b-i),m=m.cut(0,b-i),y=b,v=-1)}r(m,l.length?m.isInline&&!m.isLeaf?l.filter((function(e){return!e.inline})):l.slice():Tr,t.forChild(i,m),v),i=y}}(this.node,this.innerDeco,(function(t,i,s){t.spec.marks?c.syncToMarks(t.spec.marks,r,e):t.type.side>=0&&!s&&c.syncToMarks(i==n.node.childCount?J.none:n.node.child(i).marks,r,e),c.placeWidget(t,e,o)}),(function(t,n,s,l){var u;c.syncToMarks(t.marks,r,e),c.findNodeMatch(t,n,s,l)||a&&e.state.selection.from>o&&e.state.selection.to<o+t.nodeSize&&(u=c.findIndexWithChild(i.node))>-1&&c.updateNodeAt(t,n,s,u,e)||c.updateNextNode(t,n,s,e,l)||c.addNode(t,n,s,e,o),o+=t.nodeSize})),c.syncToMarks(Tr,r,e),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||2==this.dirty)&&(s&&this.protectLocalComposition(e,s),_r(this.contentDOM,this.children,e),Vn.ios&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){var t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))},t.prototype.localCompositionInfo=function(e,t){var n=e.state.selection,r=n.from,o=n.to;if(!(!(e.state.selection instanceof _t)||r<t||o>t+this.node.content.size)){var i=e.root.getSelection(),s=function(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];t=tr(e=e.childNodes[t-1])}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}(i.focusNode,i.focusOffset);if(s&&this.dom.contains(s.parentNode)){if(this.node.inlineContent){var a=s.nodeValue,c=function(e,t,n,r){for(var o=0,i=0;o<e.childCount&&i<=r;){var s=e.child(o++),a=i;if(i+=s.nodeSize,s.isText){for(var c=s.text;o<e.childCount;){var l=e.child(o++);if(i+=l.nodeSize,!l.isText)break;c+=l.text}if(i>=n){var u=c.lastIndexOf(t,r-a);if(u>=0&&u+t.length+a>=n)return a+u}}}return-1}(this.node.content,a,r-t,o-t);return c<0?null:{node:s,pos:c,text:a}}return{node:s,pos:-1}}}},t.prototype.protectLocalComposition=function(e,t){var n=t.node,r=t.pos,o=t.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=null)}var s=new Dr(this,i,n,o);e.compositionNodes.push(s),this.children=Gr(this.children,r,r+o.length,e,s)}},t.prototype.update=function(e,t,n,r){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)},t.prototype.updateInner=function(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},t.prototype.updateOuterDeco=function(e){if(!Hr(e,this.outerDeco)){var t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=Vr(this.dom,this.nodeDOM,Lr(this.outerDeco,this.node,t),Lr(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=e}},t.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},t.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},n.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(t.prototype,n),t}(Ar);function $r(e,t,n,r,o){return qr(r,t,e),new Ir(null,e,t,n,r,r,r,o,0)}var Rr=function(e){function t(t,n,r,o,i,s,a){e.call(this,t,n,r,o,i,null,s,a)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.parseRule=function(){for(var e=this.nodeDOM.parentNode;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}},t.prototype.update=function(e,t,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)},t.prototype.inParent=function(){for(var e=this.parent.contentDOM,t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1},t.prototype.domFromPos=function(e){return{node:this.nodeDOM,offset:e}},t.prototype.localPosFromDOM=function(t,n,r){return t==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):e.prototype.localPosFromDOM.call(this,t,n,r)},t.prototype.ignoreMutation=function(e){return"characterData"!=e.type&&"selection"!=e.type},t.prototype.slice=function(e,n,r){var o=this.node.cut(e,n),i=document.createTextNode(o.text);return new t(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},t.prototype.markDirty=function(t,n){e.prototype.markDirty.call(this,t,n),this.dom==this.nodeDOM||0!=t&&n!=this.nodeDOM.nodeValue.length||(this.dirty=3)},n.domAtom.get=function(){return!1},Object.defineProperties(t.prototype,n),t}(Ir),Fr=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};return t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.matchesHack=function(e){return 0==this.dirty&&this.dom.nodeName==e},n.domAtom.get=function(){return!0},n.ignoreForCoords.get=function(){return"IMG"==this.dom.nodeName},Object.defineProperties(t.prototype,n),t}(Ar),Pr=function(e){function t(t,n,r,o,i,s,a,c,l,u){e.call(this,t,n,r,o,i,s,a,l,u),this.spec=c}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.update=function(t,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(t,n,r);return i&&this.updateInner(t,n,r,o),i}return!(!this.contentDOM&&!t.isLeaf)&&e.prototype.update.call(this,t,n,r,o)},t.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():e.prototype.selectNode.call(this)},t.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():e.prototype.deselectNode.call(this)},t.prototype.setSelection=function(t,n,r,o){this.spec.setSelection?this.spec.setSelection(t,n,r):e.prototype.setSelection.call(this,t,n,r,o)},t.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),e.prototype.destroy.call(this)},t.prototype.stopEvent=function(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)},t.prototype.ignoreMutation=function(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):e.prototype.ignoreMutation.call(this,t)},t}(Ir);function _r(e,t,n){for(var r=e.firstChild,o=!1,i=0;i<t.length;i++){var s=t[i],a=s.dom;if(a.parentNode==e){for(;a!=r;)r=Jr(r),o=!0;r=r.nextSibling}else o=!0,e.insertBefore(a,r);if(s instanceof zr){var c=r?r.previousSibling:e.lastChild;_r(s.contentDOM,s.children,n),r=c?c.nextSibling:e.firstChild}}for(;r;)r=Jr(r),o=!0;o&&n.trackWrites==e&&(n.trackWrites=null)}function jr(e){e&&(this.nodeName=e)}jr.prototype=Object.create(null);var Br=[new jr];function Lr(e,t,n){if(0==e.length)return Br;for(var r=n?Br[0]:new jr,o=[r],i=0;i<e.length;i++){var s=e[i].type.attrs;if(s)for(var a in s.nodeName&&o.push(r=new jr(s.nodeName)),s){var c=s[a];null!=c&&(n&&1==o.length&&o.push(r=new jr(t.isInline?"span":"div")),"class"==a?r.class=(r.class?r.class+" ":"")+c:"style"==a?r.style=(r.style?r.style+";":"")+c:"nodeName"!=a&&(r[a]=c))}}return o}function Vr(e,t,n,r){if(n==Br&&r==Br)return t;for(var o=t,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var c=void 0;a&&a.nodeName==s.nodeName&&o!=e&&(c=o.parentNode)&&c.tagName.toLowerCase()==s.nodeName||((c=document.createElement(s.nodeName)).pmIsDeco=!0,c.appendChild(o),a=Br[0]),o=c}Wr(o,a||Br[0],s)}return o}function Wr(e,t,n){for(var r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=t[o]&&e.setAttribute(o,n[o]);if(t.class!=n.class){for(var i=t.class?t.class.split(" ").filter(Boolean):Tr,s=n.class?n.class.split(" ").filter(Boolean):Tr,a=0;a<i.length;a++)-1==s.indexOf(i[a])&&e.classList.remove(i[a]);for(var c=0;c<s.length;c++)-1==i.indexOf(s[c])&&e.classList.add(s[c])}if(t.style!=n.style){if(t.style)for(var l,u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;l=u.exec(t.style);)e.style.removeProperty(l[1]);n.style&&(e.style.cssText+=n.style)}}function qr(e,t,n){return Vr(e,e,Br,Lr(t,n,1!=e.nodeType))}function Hr(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function Jr(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}var Kr=function(e,t){this.top=e,this.lock=t,this.index=0,this.stack=[],this.changed=!1,this.preMatch=function(e,t){for(var n=e.childCount,r=t.length,o=new Map;n>0&&r>0;r--){var i=t[r-1],s=i.node;if(s){if(s!=e.child(n-1))break;--n,o.set(i,n)}}return{index:n,matched:o}}(e.node.content,e.children)};function Ur(e,t){return e.type.side-t.type.side}function Gr(e,t,n,r,o){for(var i=[],s=0,a=0;s<e.length;s++){var c=e[s],l=a,u=a+=c.size;l>=n||u<=t?i.push(c):(l<t&&i.push(c.slice(0,t-l,r)),o&&(i.push(o),o=null),u>n&&i.push(c.slice(n-l,c.size,r)))}return i}function Qr(e,t){var n=e.root.getSelection(),r=e.state.doc;if(!n.focusNode)return null;var o=e.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=e.docView.posFromDOM(n.focusNode,n.focusOffset);if(s<0)return null;var a,c,l=r.resolve(s);if(rr(n)){for(a=l;o&&!o.node;)o=o.parent;if(o&&o.node.isAtom&&Bt.isSelectable(o.node)&&o.parent&&(!o.node.isInline||!function(e,t,n){for(var r=0==t,o=t==tr(e);r||o;){if(e==n)return!0;var i=Un(e);if(!(e=e.parentNode))return!1;r=r&&0==i,o=o&&i==tr(e)}}(n.focusNode,n.focusOffset,o.dom))){var u=o.posBefore;c=new Bt(s==u?l:r.resolve(u))}}else{var f=e.docView.posFromDOM(n.anchorNode,n.anchorOffset);if(f<0)return null;a=r.resolve(f)}c||(c=io(e,a,l,"pointer"==t||e.state.selection.head<l.pos&&!i?1:-1));return c}function Xr(e){return e.editable?e.hasFocus():so(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Zr(e,t){var n=e.state.selection;if(ro(e,n),Xr(e)){if(!t&&e.mouseDown&&e.mouseDown.allowDefault)return e.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection();if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){var t=e.root.getSelection(),n=document.createRange(),r=e.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,Un(r)+1):n.setEnd(r,0);n.collapse(!1),t.removeAllRanges(),t.addRange(n),!o&&!e.state.selection.visible&&Vn.ie&&Vn.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(e);else{var r,o,i=n.anchor,s=n.head;!Yr||n instanceof _t||(n.$from.parent.inlineContent||(r=eo(e,n.from)),n.empty||n.$from.parent.inlineContent||(o=eo(e,n.to))),e.docView.setSelection(i,s,e.root,t),Yr&&(r&&no(r),o&&no(o)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){var t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.hideSelectionGuard);var n=e.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;t.addEventListener("selectionchange",e.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(t.removeEventListener("selectionchange",e.hideSelectionGuard),setTimeout((function(){Xr(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")}),20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}Kr.prototype.destroyBetween=function(e,t){if(e!=t){for(var n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}},Kr.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},Kr.prototype.syncToMarks=function(e,t,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,e.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);for(var s=-1,a=this.index;a<Math.min(this.index+3,this.top.children.length);a++)if(this.top.children[a].matchesMark(e[o])){s=a;break}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var c=zr.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,o++}},Kr.prototype.findNodeMatch=function(e,t,n,r){var o=this.top.children,i=-1;if(r>=this.preMatch.index){for(var s=this.index;s<o.length;s++)if(o[s].matchesNode(e,t,n)){i=s;break}}else for(var a=this.index,c=Math.min(o.length,a+1);a<c;a++){var l=o[a];if(l.matchesNode(e,t,n)&&!this.preMatch.matched.has(l)){i=a;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)},Kr.prototype.updateNodeAt=function(e,t,n,r,o){return!!this.top.children[r].update(e,t,n,o)&&(this.destroyBetween(this.index,r),this.index=r+1,!0)},Kr.prototype.findIndexWithChild=function(e){for(;;){var t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){var n=e.pmViewDesc;if(n)for(var r=this.index;r<this.top.children.length;r++)if(this.top.children[r]==n)return r;return-1}e=t}},Kr.prototype.updateNextNode=function(e,t,n,r,o){for(var i=this.index;i<this.top.children.length;i++){var s=this.top.children[i];if(s instanceof Ir){var a=this.preMatch.matched.get(s);if(null!=a&&a!=o)return!1;var c=s.dom;if(!(this.lock&&(c==this.lock||1==c.nodeType&&c.contains(this.lock.parentNode))&&!(e.isText&&s.node&&s.node.isText&&s.nodeDOM.nodeValue==e.text&&3!=s.dirty&&Hr(t,s.outerDeco)))&&s.update(e,t,n,r))return this.destroyBetween(this.index,i),s.dom!=c&&(this.changed=!0),this.index++,!0;break}}return!1},Kr.prototype.addNode=function(e,t,n,r,o){this.top.children.splice(this.index++,0,Ir.create(this.top,e,t,n,r,o)),this.changed=!0},Kr.prototype.placeWidget=function(e,t,n){var r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(e)||e!=r.widget&&r.widget.type.toDOM.parentNode){var o=new Nr(this.top,e,t,n);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++},Kr.prototype.addTextblockHacks=function(){for(var e=this.top.children[this.index-1];e instanceof zr;)e=e.children[e.children.length-1];e&&e instanceof Rr&&!/\n$/.test(e.node.text)||((Vn.safari||Vn.chrome)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG"),this.addHackNode("BR"))},Kr.prototype.addHackNode=function(e){if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack(e))this.index++;else{var t=document.createElement(e);"IMG"==e&&(t.className="ProseMirror-separator"),"BR"==e&&(t.className="ProseMirror-trailingBreak"),this.top.children.splice(this.index++,0,new Fr(this.top,Tr,t,null)),this.changed=!0}};var Yr=Vn.safari||Vn.chrome&&Vn.chrome_version<63;function eo(e,t){var n=e.docView.domFromPos(t,0),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,s=o?r.childNodes[o-1]:null;if(Vn.safari&&i&&"false"==i.contentEditable)return to(i);if(!(i&&"false"!=i.contentEditable||s&&"false"!=s.contentEditable)){if(i)return to(i);if(s)return to(s)}}function to(e){return e.contentEditable="true",Vn.safari&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function no(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function ro(e,t){if(t instanceof Bt){var n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(oo(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else oo(e)}function oo(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=null)}function io(e,t,n,r){return e.someProp("createSelectionBetween",(function(r){return r(e,t,n)}))||_t.between(t,n,r)}function so(e){var t=e.root.getSelection();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function ao(e,t){var n=e.selection,r=n.$anchor,o=n.$head,i=t>0?r.max(o):r.min(o),s=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return s&&Rt.findFrom(s,t)}function co(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function lo(e,t,n){var r=e.state.selection;if(!(r instanceof _t)){if(r instanceof Bt&&r.node.isInline)return co(e,new _t(t>0?r.$to:r.$from));var o=ao(e.state,t);return!!o&&co(e,o)}if(!r.empty||n.indexOf("s")>-1)return!1;if(e.endOfTextblock(t>0?"right":"left")){var i=ao(e.state,t);return!!(i&&i instanceof Bt)&&co(e,i)}if(!(Vn.mac&&n.indexOf("m")>-1)){var s,a=r.$head,c=a.textOffset?null:t<0?a.nodeBefore:a.nodeAfter;if(!c||c.isText)return!1;var l=t<0?a.pos-c.nodeSize:a.pos;return!!(c.isAtom||(s=e.docView.descAt(l))&&!s.contentDOM)&&(Bt.isSelectable(c)?co(e,new Bt(t<0?e.state.doc.resolve(a.pos-c.nodeSize):a)):!!Vn.webkit&&co(e,new _t(e.state.doc.resolve(t<0?l:l+c.nodeSize))))}}function uo(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function fo(e){var t=e.pmViewDesc;return t&&0==t.size&&(e.nextSibling||"BR"!=e.nodeName)}function po(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){var o,i,s=!1;for(Vn.gecko&&1==n.nodeType&&r<uo(n)&&fo(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(fo(a))o=n,i=--r;else{if(3!=a.nodeType)break;r=(n=a).nodeValue.length}}else{if(mo(n))break;for(var c=n.previousSibling;c&&fo(c);)o=n.parentNode,i=Un(c),c=c.previousSibling;if(c)r=uo(n=c);else{if((n=n.parentNode)==e.dom)break;r=0}}s?vo(e,t,n,r):o&&vo(e,t,o,i)}}function ho(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){for(var o,i,s=uo(n);;)if(r<s){if(1!=n.nodeType)break;if(!fo(n.childNodes[r]))break;o=n,i=++r}else{if(mo(n))break;for(var a=n.nextSibling;a&&fo(a);)o=a.parentNode,i=Un(a)+1,a=a.nextSibling;if(a)r=0,s=uo(n=a);else{if((n=n.parentNode)==e.dom)break;r=s=0}}o&&vo(e,t,o,i)}}function mo(e){var t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function vo(e,t,n,r){if(rr(t)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),t.removeAllRanges(),t.addRange(o)}else t.extend&&t.extend(n,r);e.domObserver.setCurSelection();var i=e.state;setTimeout((function(){e.state==i&&Zr(e)}),50)}function go(e,t,n){var r=e.state.selection;if(r instanceof _t&&!r.empty||n.indexOf("s")>-1)return!1;if(Vn.mac&&n.indexOf("m")>-1)return!1;var o=r.$from,i=r.$to;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){var s=ao(e.state,t);if(s&&s instanceof Bt)return co(e,s)}if(!o.parent.inlineContent){var a=t<0?o:i,c=r instanceof Vt?Rt.near(a,t):Rt.findFrom(a,t);return!!c&&co(e,c)}return!1}function yo(e,t){if(!(e.state.selection instanceof _t))return!0;var n=e.state.selection,r=n.$head,o=n.$anchor,i=n.empty;if(!r.sameParent(o))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;var s=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){var a=e.state.tr;return t<0?a.delete(r.pos-s.nodeSize,r.pos):a.delete(r.pos,r.pos+s.nodeSize),e.dispatch(a),!0}return!1}function bo(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function wo(e,t){var n=t.keyCode,r=function(e){var t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);return 8==n||Vn.mac&&72==n&&"c"==r?yo(e,-1)||po(e):46==n||Vn.mac&&68==n&&"c"==r?yo(e,1)||ho(e):13==n||27==n||(37==n?lo(e,-1,r)||po(e):39==n?lo(e,1,r)||ho(e):38==n?go(e,-1,r)||po(e):40==n?function(e){if(Vn.safari&&!(e.state.selection.$head.parentOffset>0)){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;bo(e,o,!0),setTimeout((function(){return bo(e,o,!1)}),20)}}}(e)||go(e,1,r)||ho(e):r==(Vn.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}function ko(e){var t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(Vn.safari&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(e.parentNode.lastChild==e||Vn.safari&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0}}function xo(e,t,n,r,o){if(t<0){var i=e.lastSelectionTime>Date.now()-50?e.lastSelectionOrigin:null,s=Qr(e,i);if(s&&!e.state.selection.eq(s)){var a=e.state.tr.setSelection(s);"pointer"==i?a.setMeta("pointer",!0):"key"==i&&a.scrollIntoView(),e.dispatch(a)}}else{var c=e.state.doc.resolve(t),l=c.sharedDepth(n);t=c.before(l+1),n=e.state.doc.resolve(n).after(l+1);var u=e.state.selection,f=function(e,t,n){var r=e.docView.parseRange(t,n),o=r.node,i=r.fromOffset,s=r.toOffset,a=r.from,c=r.to,l=e.root.getSelection(),u=null,f=l.anchorNode;if(f&&e.dom.contains(1==f.nodeType?f:f.parentNode)&&(u=[{node:f,offset:l.anchorOffset}],rr(l)||u.push({node:l.focusNode,offset:l.focusOffset})),Vn.chrome&&8===e.lastKeyCode)for(var d=s;d>i;d--){var p=o.childNodes[d-1],h=p.pmViewDesc;if("BR"==p.nodeName&&!h){s=d;break}if(!h||h.size)break}var m=e.state.doc,v=e.someProp("domParser")||Be.fromSchema(e.state.schema),g=m.resolve(a),y=null,b=v.parse(o,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:s,preserveWhitespace:!g.parent.type.spec.code||"full",editableContent:!0,findPositions:u,ruleFromNode:ko,context:g});if(u&&null!=u[0].pos){var w=u[0].pos,k=u[1]&&u[1].pos;null==k&&(k=w),y={anchor:w+a,head:k+a}}return{doc:b,sel:y,from:a,to:c}}(e,t,n);if(Vn.chrome&&e.cursorWrapper&&f.sel&&f.sel.anchor==e.cursorWrapper.deco.from){var d=e.cursorWrapper.deco.type.toDOM.nextSibling,p=d&&d.nodeValue?d.nodeValue.length:1;f.sel={anchor:f.sel.anchor+p,head:f.sel.anchor+p}}var h,m,v=e.state.doc,g=v.slice(f.from,f.to);8===e.lastKeyCode&&Date.now()-100<e.lastKeyCodeTime?(h=e.state.selection.to,m="end"):(h=e.state.selection.from,m="start"),e.lastKeyCode=null;var y=function(e,t,n,r,o){var i=e.findDiffStart(t,n);if(null==i)return null;var s=e.findDiffEnd(t,n+e.size,n+t.size),a=s.a,c=s.b;if("end"==o){r-=a+Math.max(0,i-Math.min(a,c))-i}if(a<i&&e.size<t.size){c=(i-=r<=i&&r>=a?i-r:0)+(c-a),a=i}else if(c<i){a=(i-=r<=i&&r>=c?i-r:0)+(a-c),c=i}return{start:i,endA:a,endB:c}}(g.content,f.doc.content,f.from,h,m);if(!y){if(!(r&&u instanceof _t&&!u.empty&&u.$head.sameParent(u.$anchor))||e.composing||f.sel&&f.sel.anchor!=f.sel.head){if((Vn.ios&&e.lastIOSEnter>Date.now()-225||Vn.android)&&o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName}))&&e.someProp("handleKeyDown",(function(t){return t(e,or(13,"Enter"))})))return void(e.lastIOSEnter=0);if(f.sel){var b=So(e,e.state.doc,f.sel);b&&!b.eq(e.state.selection)&&e.dispatch(e.state.tr.setSelection(b))}return}y={start:u.from,endA:u.to,endB:u.to}}e.domChangeCount++,e.state.selection.from<e.state.selection.to&&y.start==y.endB&&e.state.selection instanceof _t&&(y.start>e.state.selection.from&&y.start<=e.state.selection.from+2?y.start=e.state.selection.from:y.endA<e.state.selection.to&&y.endA>=e.state.selection.to-2&&(y.endB+=e.state.selection.to-y.endA,y.endA=e.state.selection.to)),Vn.ie&&Vn.ie_version<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>f.from&&"  "==f.doc.textBetween(y.start-f.from-1,y.start-f.from+1)&&(y.start--,y.endA--,y.endB--);var w,k=f.doc.resolveNoCache(y.start-f.from),x=f.doc.resolveNoCache(y.endB-f.from),S=k.sameParent(x)&&k.parent.inlineContent;if((Vn.ios&&e.lastIOSEnter>Date.now()-225&&(!S||o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName})))||!S&&k.pos<f.doc.content.size&&(w=Rt.findFrom(f.doc.resolve(k.pos+1),1,!0))&&w.head==x.pos)&&e.someProp("handleKeyDown",(function(t){return t(e,or(13,"Enter"))})))e.lastIOSEnter=0;else if(e.state.selection.anchor>y.start&&function(e,t,n,r,o){if(!r.parent.isTextblock||n-t<=o.pos-r.pos||Co(r,!0,!1)<o.pos)return!1;var i=e.resolve(t);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=e.resolve(Co(i,!0,!0));if(!s.parent.isTextblock||s.pos>n||Co(s,!0,!1)<n)return!1;return r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(v,y.start,y.endA,k,x)&&e.someProp("handleKeyDown",(function(t){return t(e,or(8,"Backspace"))})))Vn.android&&Vn.chrome&&e.domObserver.suppressSelectionUpdates();else{Vn.chrome&&Vn.android&&y.toB==y.from&&(e.lastAndroidDelete=Date.now()),Vn.android&&!S&&k.start()!=x.start()&&0==x.parentOffset&&k.depth==x.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==y.endA&&(y.endB-=2,x=f.doc.resolveNoCache(y.endB-f.from),setTimeout((function(){e.someProp("handleKeyDown",(function(t){return t(e,or(13,"Enter"))}))}),20));var C,M,O,A,E=y.start,T=y.endA;if(S)if(k.pos==x.pos)Vn.ie&&Vn.ie_version<=11&&0==k.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout((function(){return Zr(e)}),20)),C=e.state.tr.delete(E,T),M=v.resolve(y.start).marksAcross(v.resolve(y.endA));else if(y.endA==y.endB&&(A=v.resolve(y.start))&&(O=function(e,t){for(var n,r,o,i=e.firstChild.marks,s=t.firstChild.marks,a=i,c=s,l=0;l<s.length;l++)a=s[l].removeFromSet(a);for(var u=0;u<i.length;u++)c=i[u].removeFromSet(c);if(1==a.length&&0==c.length)r=a[0],n="add",o=function(e){return e.mark(r.addToSet(e.marks))};else{if(0!=a.length||1!=c.length)return null;r=c[0],n="remove",o=function(e){return e.mark(r.removeFromSet(e.marks))}}for(var f=[],d=0;d<t.childCount;d++)f.push(o(t.child(d)));if(L.from(f).eq(e))return{mark:r,type:n}}(k.parent.content.cut(k.parentOffset,x.parentOffset),A.parent.content.cut(A.parentOffset,y.endA-A.start()))))C=e.state.tr,"add"==O.type?C.addMark(E,T,O.mark):C.removeMark(E,T,O.mark);else if(k.parent.child(k.index()).isText&&k.index()==x.index()-(x.textOffset?0:1)){var N=k.parent.textBetween(k.parentOffset,x.parentOffset);if(e.someProp("handleTextInput",(function(t){return t(e,E,T,N)})))return;C=e.state.tr.insertText(N,E,T)}if(C||(C=e.state.tr.replace(E,T,f.doc.slice(y.start-f.from,y.endB-f.from))),f.sel){var D=So(e,C.doc,f.sel);D&&!(Vn.chrome&&Vn.android&&e.composing&&D.empty&&(y.start!=y.endB||e.lastAndroidDelete<Date.now()-100)&&(D.head==E||D.head==C.mapping.map(T)-1)||Vn.ie&&D.empty&&D.head==E)&&C.setSelection(D)}M&&C.ensureMarks(M),e.dispatch(C.scrollIntoView())}}}function So(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:io(e,t.resolve(n.anchor),t.resolve(n.head))}function Co(e,t,n){for(var r=e.depth,o=t?e.end():e.pos;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n)for(var i=e.node(r).maybeChild(e.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function Mo(e,t){for(var n=[],r=t.content,o=t.openStart,i=t.openEnd;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;var s=r.firstChild;n.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),r=s.content}var a=e.someProp("clipboardSerializer")||Xe.fromSchema(e.state.schema),c=$o(),l=c.createElement("div");l.appendChild(a.serializeFragment(r,{document:c}));for(var u,f=l.firstChild;f&&1==f.nodeType&&(u=zo[f.nodeName.toLowerCase()]);){for(var d=u.length-1;d>=0;d--){for(var p=c.createElement(u[d]);l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),"tbody"!=u[d]&&(o++,i++)}f=l.firstChild}return f&&1==f.nodeType&&f.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n)),{dom:l,text:e.someProp("clipboardTextSerializer",(function(e){return e(t)}))||t.content.textBetween(0,t.content.size,"\n\n")}}function Oo(e,t,n,r,o){var i,s,a=o.parent.type.spec.code;if(!n&&!t)return null;var c=t&&(r||a||!n);if(c){if(e.someProp("transformPastedText",(function(e){t=e(t,a||r)})),a)return t?new U(L.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):U.empty;var l=e.someProp("clipboardTextParser",(function(e){return e(t,o,r)}));if(l)s=l;else{var u=o.marks(),f=e.state.schema,d=Xe.fromSchema(f);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach((function(e){var t=i.appendChild(document.createElement("p"));e&&t.appendChild(d.serializeNode(f.text(e,u)))}))}}else e.someProp("transformPastedHTML",(function(e){n=e(n)})),i=function(e){var t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));var n,r=$o().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);(n=o&&zo[o[1].toLowerCase()])&&(e=n.map((function(e){return"<"+e+">"})).join("")+e+n.map((function(e){return"</"+e+">"})).reverse().join(""));if(r.innerHTML=e,n)for(var i=0;i<n.length;i++)r=r.querySelector(n[i])||r;return r}(n),Vn.webkit&&function(e){for(var t=e.querySelectorAll(Vn.chrome?"span:not([class]):not([style])":"span.Apple-converted-space"),n=0;n<t.length;n++){var r=t[n];1==r.childNodes.length&&" "==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(i);var p=i&&i.querySelector("[data-pm-slice]"),h=p&&/^(\d+) (\d+) (.*)/.exec(p.getAttribute("data-pm-slice"));if(!s){var m=e.someProp("clipboardParser")||e.someProp("domParser")||Be.fromSchema(e.state.schema);s=m.parseSlice(i,{preserveWhitespace:!(!c&&!h),context:o})}if(h)s=function(e,t){if(!e.size)return e;var n,r=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(l){return e}for(var o=e.content,i=e.openStart,s=e.openEnd,a=n.length-2;a>=0;a-=2){var c=r.nodes[n[a]];if(!c||c.hasRequiredAttrs())break;o=L.from(c.create(n[a+1],o)),i++,s++}return new U(o,i,s)}(Do(s,+h[1],+h[2]),h[3]);else if((s=U.maxOpen(function(e,t){if(e.childCount<2)return e;for(var n=function(n){var r=t.node(n).contentMatchAt(t.index(n)),o=void 0,i=[];if(e.forEach((function(e){if(i){var t,n=r.findWrapping(e.type);if(!n)return i=null;if(t=i.length&&o.length&&Eo(n,o,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=To(i[i.length-1],o.length));var s=Ao(e,n);i.push(s),r=r.matchType(s.type,s.attrs),o=n}}})),i)return{v:L.from(i)}},r=t.depth;r>=0;r--){var o=n(r);if(o)return o.v}return e}(s.content,o),!0)).openStart||s.openEnd){for(var v=0,g=0,y=s.content.firstChild;v<s.openStart&&!y.type.spec.isolating;v++,y=y.firstChild);for(var b=s.content.lastChild;g<s.openEnd&&!b.type.spec.isolating;g++,b=b.lastChild);s=Do(s,v,g)}return e.someProp("transformPasted",(function(e){s=e(s)})),s}function Ao(e,t,n){void 0===n&&(n=0);for(var r=t.length-1;r>=n;r--)e=t[r].create(null,L.from(e));return e}function Eo(e,t,n,r,o){if(o<e.length&&o<t.length&&e[o]==t[o]){var i=Eo(e,t,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==e.length-1?n.type:e[o+1]))return r.copy(r.content.append(L.from(Ao(n,e,o+1))))}}function To(e,t){if(0==t)return e;var n=e.content.replaceChild(e.childCount-1,To(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(L.empty,!0);return e.copy(n.append(r))}function No(e,t,n,r,o,i){var s=t<0?e.firstChild:e.lastChild,a=s.content;return o<r-1&&(a=No(a,t,n,r,o+1,i)),o>=n&&(a=t<0?s.contentMatchAt(0).fillBefore(a,e.childCount>1||i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(L.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function Do(e,t,n){return t<e.openStart&&(e=new U(No(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new U(No(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}var zo={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Io=null;function $o(){return Io||(Io=document.implementation.createHTMLDocument("title"))}var Ro={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Fo=Vn.ie&&Vn.ie_version<=11,Po=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Po.prototype.set=function(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset},Po.prototype.eq=function(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset};var _o=function(e,t){var n=this;this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(e){for(var t=0;t<e.length;t++)n.queue.push(e[t]);Vn.ie&&Vn.ie_version<=11&&e.some((function(e){return"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new Po,Fo&&(this.onCharData=function(e){n.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};_o.prototype.flushSoon=function(){var e=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){e.flushingSoon=-1,e.flush()}),20))},_o.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},_o.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,Ro),Fo&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},_o.prototype.stop=function(){var e=this;if(this.observer){var t=this.observer.takeRecords();if(t.length){for(var n=0;n<t.length;n++)this.queue.push(t[n]);window.setTimeout((function(){return e.flush()}),20)}this.observer.disconnect()}Fo&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},_o.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},_o.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},_o.prototype.suppressSelectionUpdates=function(){var e=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return e.suppressingSelectionUpdates=!1}),50)},_o.prototype.onSelectionChange=function(){if((!(e=this.view).editable||e.root.activeElement==e.dom)&&so(e)){var e;if(this.suppressingSelectionUpdates)return Zr(this.view);if(Vn.ie&&Vn.ie_version<=11&&!this.view.state.selection.empty){var t=this.view.root.getSelection();if(t.focusNode&&Zn(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}},_o.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},_o.prototype.ignoreSelectionChange=function(e){if(0==e.rangeCount)return!0;var t=e.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(t);return n&&n.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0},_o.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);var t=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(t)&&so(this.view)&&!this.ignoreSelectionChange(t),r=-1,o=-1,i=!1,s=[];if(this.view.editable)for(var a=0;a<e.length;a++){var c=this.registerMutation(e[a],s);c&&(r=r<0?c.from:Math.min(c.from,r),o=o<0?c.to:Math.max(c.to,o),c.typeOver&&(i=!0))}if(Vn.gecko&&s.length>1){var l=s.filter((function(e){return"BR"==e.nodeName}));if(2==l.length){var u=l[0],f=l[1];u.parentNode&&u.parentNode.parentNode==f.parentNode?f.remove():u.remove()}}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),function(e){if(jo)return;jo=!0,"normal"==getComputedStyle(e.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(r,o,i,s),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(t)||Zr(this.view),this.currentSelection.set(t))}},_o.prototype.registerMutation=function(e,t){if(t.indexOf(e.target)>-1)return null;var n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(var r=0;r<e.addedNodes.length;r++)t.push(e.addedNodes[r]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};var o=e.previousSibling,i=e.nextSibling;if(Vn.ie&&Vn.ie_version<=11&&e.addedNodes.length)for(var s=0;s<e.addedNodes.length;s++){var a=e.addedNodes[s],c=a.previousSibling,l=a.nextSibling;(!c||Array.prototype.indexOf.call(e.addedNodes,c)<0)&&(o=c),(!l||Array.prototype.indexOf.call(e.addedNodes,l)<0)&&(i=l)}var u=o&&o.parentNode==e.target?Un(o)+1:0,f=n.localPosFromDOM(e.target,u,-1),d=i&&i.parentNode==e.target?Un(i):e.target.childNodes.length;return{from:f,to:n.localPosFromDOM(e.target,d,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}};var jo=!1;var Bo={},Lo={};function Vo(e,t){e.lastSelectionOrigin=t,e.lastSelectionTime=Date.now()}function Wo(e){e.someProp("handleDOMEvents",(function(t){for(var n in t)e.eventHandlers[n]||e.dom.addEventListener(n,e.eventHandlers[n]=function(t){return qo(e,t)})}))}function qo(e,t){return e.someProp("handleDOMEvents",(function(n){var r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)}))}function Ho(e){return{left:e.clientX,top:e.clientY}}function Jo(e,t,n,r,o){if(-1==r)return!1;for(var i=e.state.doc.resolve(r),s=function(r){if(e.someProp(t,(function(t){return r>i.depth?t(e,n,i.nodeAfter,i.before(r),o,!0):t(e,n,i.node(r),i.before(r),o,!1)})))return{v:!0}},a=i.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function Ko(e,t,n){e.focused||e.focus();var r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}function Uo(e,t,n,r,o){return Jo(e,"handleClickOn",t,n,r)||e.someProp("handleClick",(function(n){return n(e,t,r)}))||(o?function(e,t){if(-1==t)return!1;var n,r,o=e.state.selection;o instanceof Bt&&(n=o.node);for(var i=e.state.doc.resolve(t),s=i.depth+1;s>0;s--){var a=s>i.depth?i.nodeAfter:i.node(s);if(Bt.isSelectable(a)){r=n&&o.$from.depth>0&&s>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(s);break}}return null!=r&&(Ko(e,Bt.create(e.state.doc,r),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;var n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&Bt.isSelectable(r))&&(Ko(e,new Bt(n),"pointer"),!0)}(e,n))}function Go(e,t,n,r){return Jo(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",(function(n){return n(e,t,r)}))}function Qo(e,t,n,r){return Jo(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",(function(n){return n(e,t,r)}))||function(e,t,n){if(0!=n.button)return!1;var r=e.state.doc;if(-1==t)return!!r.inlineContent&&(Ko(e,_t.create(r,0,r.content.size),"pointer"),!0);for(var o=r.resolve(t),i=o.depth+1;i>0;i--){var s=i>o.depth?o.nodeAfter:o.node(i),a=o.before(i);if(s.inlineContent)Ko(e,_t.create(r,a+1,a+1+s.content.size),"pointer");else{if(!Bt.isSelectable(s))continue;Ko(e,Bt.create(r,a),"pointer")}return!0}}(e,n,r)}function Xo(e){return oi(e)}Lo.keydown=function(e,t){if(e.shiftKey=16==t.keyCode||t.shiftKey,!ei(e,t))if(229!=t.keyCode&&e.domObserver.forceFlush(),e.lastKeyCode=t.keyCode,e.lastKeyCodeTime=Date.now(),!Vn.ios||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)e.someProp("handleKeyDown",(function(n){return n(e,t)}))||wo(e,t)?t.preventDefault():Vo(e,"key");else{var n=Date.now();e.lastIOSEnter=n,e.lastIOSEnterFallbackTimeout=setTimeout((function(){e.lastIOSEnter==n&&(e.someProp("handleKeyDown",(function(t){return t(e,or(13,"Enter"))})),e.lastIOSEnter=0)}),200)}},Lo.keyup=function(e,t){16==t.keyCode&&(e.shiftKey=!1)},Lo.keypress=function(e,t){if(!(ei(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||Vn.mac&&t.metaKey))if(e.someProp("handleKeyPress",(function(n){return n(e,t)})))t.preventDefault();else{var n=e.state.selection;if(!(n instanceof _t&&n.$from.sameParent(n.$to))){var r=String.fromCharCode(t.charCode);e.someProp("handleTextInput",(function(t){return t(e,n.$from.pos,n.$to.pos,r)}))||e.dispatch(e.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}}};var Zo=Vn.mac?"metaKey":"ctrlKey";Bo.mousedown=function(e,t){e.shiftKey=t.shiftKey;var n=Xo(e),r=Date.now(),o="singleClick";r-e.lastClick.time<500&&function(e,t){var n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(t,e.lastClick)&&!t[Zo]&&("singleClick"==e.lastClick.type?o="doubleClick":"doubleClick"==e.lastClick.type&&(o="tripleClick")),e.lastClick={time:r,x:t.clientX,y:t.clientY,type:o};var i=e.posAtCoords(Ho(t));i&&("singleClick"==o?(e.mouseDown&&e.mouseDown.done(),e.mouseDown=new Yo(e,i,t,n)):("doubleClick"==o?Go:Qo)(e,i.pos,i.inside,t)?t.preventDefault():Vo(e,"pointer"))};var Yo=function(e,t,n,r){var o,i,s=this;if(this.view=e,this.startDoc=e.state.doc,this.pos=t,this.event=n,this.flushed=r,this.selectNode=n[Zo],this.allowDefault=n.shiftKey,this.delayedSelectionSync=!1,t.inside>-1)o=e.state.doc.nodeAt(t.inside),i=t.inside;else{var a=e.state.doc.resolve(t.pos);o=a.parent,i=a.depth?a.before():0}this.mightDrag=null;var c=r?null:n.target,l=c?e.docView.nearestDesc(c,!0):null;this.target=l?l.dom:null;var u=e.state.selection;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||u instanceof Bt&&u.from<=i&&u.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&Vn.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){s.view.mouseDown==s&&s.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Vo(e,"pointer")};function ei(e,t){return!!e.composing||!!(Vn.safari&&Math.abs(t.timeStamp-e.compositionEndedAt)<500)&&(e.compositionEndedAt=-2e8,!0)}Yo.prototype.done=function(){var e=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout((function(){return Zr(e.view)})),this.view.mouseDown=null},Yo.prototype.up=function(e){if(this.done(),this.view.dom.contains(3==e.target.nodeType?e.target.parentNode:e.target)){var t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Ho(e))),this.allowDefault||!t?Vo(this.view,"pointer"):Uo(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||Vn.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||Vn.chrome&&!(this.view.state.selection instanceof _t)&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Ko(this.view,Rt.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):Vo(this.view,"pointer")}},Yo.prototype.move=function(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0),Vo(this.view,"pointer"),0==e.buttons&&this.done()},Bo.touchdown=function(e){Xo(e),Vo(e,"pointer")},Bo.contextmenu=function(e){return Xo(e)};var ti=Vn.android?5e3:-1;function ni(e,t){clearTimeout(e.composingTimeout),t>-1&&(e.composingTimeout=setTimeout((function(){return oi(e)}),t))}function ri(e){var t;for(e.composing&&(e.composing=!1,e.compositionEndedAt=((t=document.createEvent("Event")).initEvent("event",!0,!0),t.timeStamp));e.compositionNodes.length>0;)e.compositionNodes.pop().markParentsDirty()}function oi(e,t){if(e.domObserver.forceFlush(),ri(e),t||e.docView.dirty){var n=Qr(e);return n&&!n.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(n)):e.updateState(e.state),!0}return!1}Lo.compositionstart=Lo.compositionupdate=function(e){if(!e.composing){e.domObserver.flush();var t=e.state,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(e){return!1===e.type.spec.inclusive}))))e.markCursor=e.state.storedMarks||n.marks(),oi(e,!0),e.markCursor=null;else if(oi(e),Vn.gecko&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=e.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var s=i<0?o.lastChild:o.childNodes[i-1];if(!s)break;if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}o=s,i=-1}e.composing=!0}ni(e,ti)},Lo.compositionend=function(e,t){e.composing&&(e.composing=!1,e.compositionEndedAt=t.timeStamp,ni(e,20))};var ii=Vn.ie&&Vn.ie_version<15||Vn.ios&&Vn.webkit_version<604;function si(e,t,n,r){var o=Oo(e,t,n,e.shiftKey,e.state.selection.$from);if(e.someProp("handlePaste",(function(t){return t(e,r,o||U.empty)})))return!0;if(!o)return!1;var i=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(o),s=i?e.state.tr.replaceSelectionWith(i,e.shiftKey):e.state.tr.replaceSelection(o);return e.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Bo.copy=Lo.cut=function(e,t){var n=e.state.selection,r="cut"==t.type;if(!n.empty){var o=ii?null:t.clipboardData,i=Mo(e,n.content()),s=i.dom,a=i.text;o?(t.preventDefault(),o.clearData(),o.setData("text/html",s.innerHTML),o.setData("text/plain",a)):function(e,t){if(e.dom.parentNode){var n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout((function(){n.parentNode&&n.parentNode.removeChild(n),e.focus()}),50)}}(e,s),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},Lo.paste=function(e,t){var n=ii?null:t.clipboardData;n&&si(e,n.getData("text/plain"),n.getData("text/html"),t)?t.preventDefault():function(e,t){if(e.dom.parentNode){var n=e.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout((function(){e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?si(e,r.value,null,t):si(e,r.textContent,r.innerHTML,t)}),50)}}(e,t)};var ai=function(e,t){this.slice=e,this.move=t},ci=Vn.mac?"altKey":"ctrlKey";for(var li in Bo.dragstart=function(e,t){var n=e.mouseDown;if(n&&n.done(),t.dataTransfer){var r=e.state.selection,o=r.empty?null:e.posAtCoords(Ho(t));if(o&&o.pos>=r.from&&o.pos<=(r instanceof Bt?r.to-1:r.to));else if(n&&n.mightDrag)e.dispatch(e.state.tr.setSelection(Bt.create(e.state.doc,n.mightDrag.pos)));else if(t.target&&1==t.target.nodeType){var i=e.docView.nearestDesc(t.target,!0);i&&i.node.type.spec.draggable&&i!=e.docView&&e.dispatch(e.state.tr.setSelection(Bt.create(e.state.doc,i.posBefore)))}var s=e.state.selection.content(),a=Mo(e,s),c=a.dom,l=a.text;t.dataTransfer.clearData(),t.dataTransfer.setData(ii?"Text":"text/html",c.innerHTML),t.dataTransfer.effectAllowed="copyMove",ii||t.dataTransfer.setData("text/plain",l),e.dragging=new ai(s,!t[ci])}},Bo.dragend=function(e){var t=e.dragging;window.setTimeout((function(){e.dragging==t&&(e.dragging=null)}),50)},Lo.dragover=Lo.dragenter=function(e,t){return t.preventDefault()},Lo.drop=function(e,t){var n=e.dragging;if(e.dragging=null,t.dataTransfer){var r=e.posAtCoords(Ho(t));if(r){var o=e.state.doc.resolve(r.pos);if(o){var i=n&&n.slice;i?e.someProp("transformPasted",(function(e){i=e(i)})):i=Oo(e,t.dataTransfer.getData(ii?"Text":"text/plain"),ii?null:t.dataTransfer.getData("text/html"),!1,o);var s=n&&!t[ci];if(e.someProp("handleDrop",(function(n){return n(e,t,i||U.empty,s)})))t.preventDefault();else if(i){t.preventDefault();var a=i?function(e,t,n){var r=e.resolve(t);if(!n.content.size)return t;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var a=r.depth;a>=0;a--){var c=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,l=r.index(a)+(c>0?1:0),u=r.node(a),f=!1;if(1==s)f=u.canReplace(l,l,o);else{var d=u.contentMatchAt(l).findWrapping(o.firstChild.type);f=d&&u.canReplaceWith(l,l,d[0])}if(f)return 0==c?r.pos:c<0?r.before(a+1):r.after(a+1)}return null}(e.state.doc,o.pos,i):o.pos;null==a&&(a=o.pos);var c=e.state.tr;s&&c.deleteSelection();var l=c.mapping.map(a),u=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,f=c.doc;if(u?c.replaceRangeWith(l,l,i.content.firstChild):c.replaceRange(l,l,i),!c.doc.eq(f)){var d=c.doc.resolve(l);if(u&&Bt.isSelectable(i.content.firstChild)&&d.nodeAfter&&d.nodeAfter.sameMarkup(i.content.firstChild))c.setSelection(new Bt(d));else{var p=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach((function(e,t,n,r){return p=r})),c.setSelection(io(e,d,c.doc.resolve(p)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))}}}}}},Bo.focus=function(e){e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout((function(){e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.root.getSelection())&&Zr(e)}),20))},Bo.blur=function(e,t){e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.set({}),e.focused=!1)},Bo.beforeinput=function(e,t){if(Vn.chrome&&Vn.android&&"deleteContentBackward"==t.inputType){var n=e.domChangeCount;setTimeout((function(){if(e.domChangeCount==n&&(e.dom.blur(),e.focus(),!e.someProp("handleKeyDown",(function(t){return t(e,or(8,"Backspace"))})))){var t=e.state.selection.$cursor;t&&t.pos>0&&e.dispatch(e.state.tr.delete(t.pos-1,t.pos).scrollIntoView())}}),50)}},Lo)Bo[li]=Lo[li];function ui(e,t){if(e==t)return!0;for(var n in e)if(e[n]!==t[n])return!1;for(var r in t)if(!(r in e))return!1;return!0}var fi=function(e,t){this.spec=t||gi,this.side=this.spec.side||0,this.toDOM=e};fi.prototype.map=function(e,t,n,r){var o=e.mapResult(t.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new hi(i-n,i-n,this)},fi.prototype.valid=function(){return!0},fi.prototype.eq=function(e){return this==e||e instanceof fi&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&ui(this.spec,e.spec))};var di=function(e,t){this.spec=t||gi,this.attrs=e};di.prototype.map=function(e,t,n,r){var o=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new hi(o,i,this)},di.prototype.valid=function(e,t){return t.from<t.to},di.prototype.eq=function(e){return this==e||e instanceof di&&ui(this.attrs,e.attrs)&&ui(this.spec,e.spec)},di.is=function(e){return e.type instanceof di};var pi=function(e,t){this.spec=t||gi,this.attrs=e};pi.prototype.map=function(e,t,n,r){var o=e.mapResult(t.from+r,1);if(o.deleted)return null;var i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=o.pos?null:new hi(o.pos-n,i.pos-n,this)},pi.prototype.valid=function(e,t){var n,r=e.content.findIndex(t.from),o=r.index,i=r.offset;return i==t.from&&!(n=e.child(o)).isText&&i+n.nodeSize==t.to},pi.prototype.eq=function(e){return this==e||e instanceof pi&&ui(this.attrs,e.attrs)&&ui(this.spec,e.spec)};var hi=function(e,t,n){this.from=e,this.to=t,this.type=n},mi={spec:{configurable:!0},inline:{configurable:!0}};hi.prototype.copy=function(e,t){return new hi(e,t,this.type)},hi.prototype.eq=function(e,t){return void 0===t&&(t=0),this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to},hi.prototype.map=function(e,t,n){return this.type.map(e,this,t,n)},hi.widget=function(e,t,n){return new hi(e,e,new fi(t,n))},hi.inline=function(e,t,n,r){return new hi(e,t,new di(n,r))},hi.node=function(e,t,n,r){return new hi(e,t,new pi(n,r))},mi.spec.get=function(){return this.type.spec},mi.inline.get=function(){return this.type instanceof di},Object.defineProperties(hi.prototype,mi);var vi=[],gi={},yi=function(e,t){this.local=e&&e.length?e:vi,this.children=t&&t.length?t:vi};yi.create=function(e,t){return t.length?Ci(t,e,0,gi):bi},yi.prototype.find=function(e,t,n){var r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r},yi.prototype.findInner=function(e,t,n,r,o){for(var i=0;i<this.local.length;i++){var s=this.local[i];s.from<=t&&s.to>=e&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a=0;a<this.children.length;a+=3)if(this.children[a]<t&&this.children[a+1]>e){var c=this.children[a]+1;this.children[a+2].findInner(e-c,t-c,n,r+c,o)}},yi.prototype.map=function(e,t,n){return this==bi||0==e.maps.length?this:this.mapInner(e,t,0,0,n||gi)},yi.prototype.mapInner=function(e,t,n,r,o){for(var i,s=0;s<this.local.length;s++){var a=this.local[s].map(e,n,r);a&&a.type.valid(t,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(e,t,n,r,o,i,s){for(var a=e.slice(),c=function(e,t,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],l=void 0;-1==c||e>c+i||(t>=a[s]+i?a[s+1]=-1:n>=o&&(l=r-n-(t-e))&&(a[s]+=l,a[s+1]+=l))}},l=0;l<n.maps.length;l++)n.maps[l].forEach(c);for(var u=!1,f=0;f<a.length;f+=3)if(-1==a[f+1]){var d=n.map(e[f]+i),p=d-o;if(p<0||p>=r.content.size){u=!0;continue}var h=n.map(e[f+1]+i,-1)-o,m=r.content.findIndex(p),v=m.index,g=m.offset,y=r.maybeChild(v);if(y&&g==p&&g+y.nodeSize==h){var b=a[f+2].mapInner(n,y,d+1,e[f]+i+1,s);b!=bi?(a[f]=p,a[f+1]=h,a[f+2]=b):(a[f+1]=-2,u=!0)}else u=!0}if(u){var w=Ci(function(e,t,n,r,o,i,s){function a(e,t){for(var i=0;i<e.local.length;i++){var c=e.local[i].map(r,o,t);c?n.push(c):s.onRemove&&s.onRemove(e.local[i].spec)}for(var l=0;l<e.children.length;l+=3)a(e.children[l+2],e.children[l]+t+1)}for(var c=0;c<e.length;c+=3)-1==e[c+1]&&a(e[c+2],t[c]+i+1);return n}(a,e,t||[],n,o,i,s),r,0,s);t=w.local;for(var k=0;k<a.length;k+=3)a[k+1]<0&&(a.splice(k,3),k-=3);for(var x=0,S=0;x<w.children.length;x+=3){for(var C=w.children[x];S<a.length&&a[S]<C;)S+=3;a.splice(S,0,w.children[x],w.children[x+1],w.children[x+2])}}return new yi(t&&t.sort(Mi),a)}(this.children,i,e,t,n,r,o):i?new yi(i.sort(Mi)):bi},yi.prototype.add=function(e,t){return t.length?this==bi?yi.create(e,t):this.addInner(e,t,0):this},yi.prototype.addInner=function(e,t,n){var r,o=this,i=0;e.forEach((function(e,s){var a,c=s+n;if(a=xi(t,e,c)){for(r||(r=o.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(e,a,c+1):r.splice(i,0,s,s+e.nodeSize,Ci(a,e,c+1,gi)),i+=3}}));for(var s=ki(i?Si(t):t,-n),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new yi(s.length?this.local.concat(s).sort(Mi):this.local,r||this.children)},yi.prototype.remove=function(e){return 0==e.length||this==bi?this:this.removeInner(e,0)},yi.prototype.removeInner=function(e,t){for(var n=this.children,r=this.local,o=0;o<n.length;o+=3){for(var i=void 0,s=n[o]+t,a=n[o+1]+t,c=0,l=void 0;c<e.length;c++)(l=e[c])&&l.from>s&&l.to<a&&(e[c]=null,(i||(i=[])).push(l));if(i){n==this.children&&(n=this.children.slice());var u=n[o+2].removeInner(i,s+1);u!=bi?n[o+2]=u:(n.splice(o,3),o-=3)}}if(r.length)for(var f=0,d=void 0;f<e.length;f++)if(d=e[f])for(var p=0;p<r.length;p++)r[p].eq(d,t)&&(r==this.local&&(r=this.local.slice()),r.splice(p--,1));return n==this.children&&r==this.local?this:r.length||n.length?new yi(r,n):bi},yi.prototype.forChild=function(e,t){if(this==bi)return this;if(t.isLeaf)return yi.empty;for(var n,r,o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}for(var i=e+1,s=i+t.content.size,a=0;a<this.local.length;a++){var c=this.local[a];if(c.from<s&&c.to>i&&c.type instanceof di){var l=Math.max(i,c.from)-i,u=Math.min(s,c.to)-i;l<u&&(r||(r=[])).push(c.copy(l,u))}}if(r){var f=new yi(r.sort(Mi));return n?new wi([f,n]):f}return n||bi},yi.prototype.eq=function(e){if(this==e)return!0;if(!(e instanceof yi)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(var t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0},yi.prototype.locals=function(e){return Oi(this.localsInner(e))},yi.prototype.localsInner=function(e){if(this==bi)return vi;if(e.inlineContent||!this.local.some(di.is))return this.local;for(var t=[],n=0;n<this.local.length;n++)this.local[n].type instanceof di||t.push(this.local[n]);return t};var bi=new yi;yi.empty=bi,yi.removeOverlap=Oi;var wi=function(e){this.members=e};function ki(e,t){if(!t||!e.length)return e;for(var n=[],r=0;r<e.length;r++){var o=e[r];n.push(new hi(o.from+t,o.to+t,o.type))}return n}function xi(e,t,n){if(t.isLeaf)return null;for(var r=n+t.nodeSize,o=null,i=0,s=void 0;i<e.length;i++)(s=e[i])&&s.from>n&&s.to<r&&((o||(o=[])).push(s),e[i]=null);return o}function Si(e){for(var t=[],n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function Ci(e,t,n,r){var o=[],i=!1;t.forEach((function(t,s){var a=xi(e,t,s+n);if(a){i=!0;var c=Ci(a,t,n+s+1,r);c!=bi&&o.push(s,s+t.nodeSize,c)}}));for(var s=ki(i?Si(e):e,-n).sort(Mi),a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new yi(s,o):bi}function Mi(e,t){return e.from-t.from||e.to-t.to}function Oi(e){for(var t=e,n=0;n<t.length-1;n++){var r=t[n];if(r.from!=r.to)for(var o=n+1;o<t.length;o++){var i=t[o];if(i.from!=r.from){i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),Ai(t,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),Ai(t,o+1,i.copy(r.to,i.to)))}}return t}function Ai(e,t,n){for(;t<e.length&&Mi(n,e[t])>0;)t++;e.splice(t,0,n)}function Ei(e){var t=[];return e.someProp("decorations",(function(n){var r=n(e.state);r&&r!=bi&&t.push(r)})),e.cursorWrapper&&t.push(yi.create(e.state.doc,[e.cursorWrapper.deco])),wi.from(t)}wi.prototype.map=function(e,t){var n=this.members.map((function(n){return n.map(e,t,gi)}));return wi.from(n)},wi.prototype.forChild=function(e,t){if(t.isLeaf)return yi.empty;for(var n=[],r=0;r<this.members.length;r++){var o=this.members[r].forChild(e,t);o!=bi&&(o instanceof wi?n=n.concat(o.members):n.push(o))}return wi.from(n)},wi.prototype.eq=function(e){if(!(e instanceof wi)||e.members.length!=this.members.length)return!1;for(var t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0},wi.prototype.locals=function(e){for(var t,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(e);if(o.length)if(t){n&&(t=t.slice(),n=!1);for(var i=0;i<o.length;i++)t.push(o[i])}else t=o}return t?Oi(n?t:t.sort(Mi)):vi},wi.from=function(e){switch(e.length){case 0:return bi;case 1:return e[0];default:return new wi(e)}};var Ti=function(e,t){this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Ri),this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):e.apply?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Ii(this),this.markCursor=null,this.cursorWrapper=null,zi(this),this.nodeViews=$i(this),this.docView=$r(this.state.doc,Di(this),Ei(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(e){e.shiftKey=!1,e.mouseDown=null,e.lastKeyCode=null,e.lastKeyCodeTime=0,e.lastClick={time:0,x:0,y:0,type:""},e.lastSelectionOrigin=null,e.lastSelectionTime=0,e.lastIOSEnter=0,e.lastIOSEnterFallbackTimeout=null,e.lastAndroidDelete=0,e.composing=!1,e.composingTimeout=null,e.compositionNodes=[],e.compositionEndedAt=-2e8,e.domObserver=new _o(e,(function(t,n,r,o){return xo(e,t,n,r,o)})),e.domObserver.start(),e.domChangeCount=0,e.eventHandlers=Object.create(null);var t=function(t){var n=Bo[t];e.dom.addEventListener(t,e.eventHandlers[t]=function(t){!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}(e,t)||qo(e,t)||!e.editable&&t.type in Lo||n(e,t)})};for(var n in Bo)t(n);Vn.safari&&e.dom.addEventListener("input",(function(){return null})),Wo(e)}(this),this.prevDirectPlugins=[],this.pluginViews=[],this.updatePluginViews()},Ni={props:{configurable:!0},root:{configurable:!0}};function Di(e){var t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),t.translate="no",e.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(e.state)),n)for(var r in n)"class"==r?t.class+=" "+n[r]:t[r]||"contenteditable"==r||"nodeName"==r||(t[r]=String(n[r]))})),[hi.node(0,e.state.doc.content.size,t)]}function zi(e){if(e.markCursor){var t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),e.cursorWrapper={dom:t,deco:hi.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function Ii(e){return!e.someProp("editable",(function(t){return!1===t(e.state)}))}function $i(e){var t={};return e.someProp("nodeViews",(function(e){for(var n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])})),t}function Ri(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}function Fi(e,t){return new xn(e,((e,n,r,o)=>{const{tr:i}=e,s=n.length;let a=r,c=o;if(n[s-1]){const l=n[0],u=n[s-1],f=n[s-2],d=r+l.indexOf(f),p=d+f.length-1,h=d+f.lastIndexOf(u),m=h+u.length;if(function(e,t,n){let r=[];return n.doc.nodesBetween(e,t,((e,t)=>{r=[...r,...e.marks.map((n=>({start:t,end:t+e.nodeSize,mark:n})))]})),r}(r,o,e).filter((e=>e.mark.type.excludes(t))).filter((e=>e.end>d)).length)return null;m<p&&i.delete(m,p),h>d&&i.delete(d,h),a=d,c=a+u.length}return i.addMark(a,c,t.create()),i.removeStoredMark(t),i}))}Ni.props.get=function(){if(this._props.state!=this.state){var e=this._props;for(var t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props},Ti.prototype.update=function(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Wo(this),this._props=e,e.plugins&&(e.plugins.forEach(Ri),this.directPlugins=e.plugins),this.updateStateInner(e.state,!0)},Ti.prototype.setProps=function(e){var t={};for(var n in this._props)t[n]=this._props[n];for(var r in t.state=this.state,e)t[r]=e[r];this.update(t)},Ti.prototype.updateState=function(e){this.updateStateInner(e,this.state.plugins!=e.plugins)},Ti.prototype.updateStateInner=function(e,t){var n=this,r=this.state,o=!1,i=!1;if(e.storedMarks&&this.composing&&(ri(this),i=!0),this.state=e,t){var s=$i(this);(function(e,t){var n=0,r=0;for(var o in e){if(e[o]!=t[o])return!0;n++}for(var i in t)r++;return n!=r})(s,this.nodeViews)&&(this.nodeViews=s,o=!0),Wo(this)}this.editable=Ii(this),zi(this);var a=Ei(this),c=Di(this),l=t?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",u=o||!this.docView.matchesNode(e.doc,c,a);!u&&e.selection.eq(r.selection)||(i=!0);var f,d,p,h,m,v,g,y,b,w,k,x="preserve"==l&&i&&null==this.dom.style.overflowAnchor&&function(e){for(var t,n,r=e.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=e.root.elementFromPoint(i,s);if(a!=e.dom&&e.dom.contains(a)){var c=a.getBoundingClientRect();if(c.top>=o-20){t=a,n=c.top;break}}}return{refDOM:t,refTop:n,stack:lr(e.dom)}}(this);if(i){this.domObserver.stop();var S=u&&(Vn.ie||Vn.chrome)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&(h=r.selection,m=e.selection,v=Math.min(h.$anchor.sharedDepth(h.head),m.$anchor.sharedDepth(m.head)),h.$anchor.start(v)!=m.$anchor.start(v));if(u){var C=Vn.chrome?this.trackWrites=this.root.getSelection().focusNode:null;!o&&this.docView.update(e.doc,c,a,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=$r(e.doc,c,a,this.dom,this)),C&&!this.trackWrites&&(S=!0)}S||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(f=this,d=f.docView.domFromPos(f.state.selection.anchor,0),p=f.root.getSelection(),Zn(d.node,d.offset,p.anchorNode,p.anchorOffset)))?Zr(this,S):(ro(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==l)this.dom.scrollTop=0;else if("to selection"==l){var M=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(e){return e(n)}))||(e.selection instanceof Bt?cr(this,this.docView.domAfterPos(e.selection.from).getBoundingClientRect(),M):cr(this,this.coordsAtPos(e.selection.head,1),M))}else x&&(y=(g=x).refDOM,b=g.refTop,w=g.stack,k=y?y.getBoundingClientRect().top:0,ur(w,0==k?0:k-b))},Ti.prototype.destroyPluginViews=function(){for(var e;e=this.pluginViews.pop();)e.destroy&&e.destroy()},Ti.prototype.updatePluginViews=function(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(var t=0;t<this.pluginViews.length;t++){var n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var r=0;r<this.directPlugins.length;r++){var o=this.directPlugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(var i=0;i<this.state.plugins.length;i++){var s=this.state.plugins[i];s.spec.view&&this.pluginViews.push(s.spec.view(this))}}},Ti.prototype.someProp=function(e,t){var n,r=this._props&&this._props[e];if(null!=r&&(n=t?t(r):r))return n;for(var o=0;o<this.directPlugins.length;o++){var i=this.directPlugins[o].props[e];if(null!=i&&(n=t?t(i):i))return n}var s=this.state.plugins;if(s)for(var a=0;a<s.length;a++){var c=s[a].props[e];if(null!=c&&(n=t?t(c):c))return n}},Ti.prototype.hasFocus=function(){return this.root.activeElement==this.dom},Ti.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(fr)return e.focus(fr);var t=lr(e);e.focus(null==fr?{get preventScroll(){return fr={preventScroll:!0},!0}}:void 0),fr||(fr=!1,ur(t,0))}(this.dom),Zr(this),this.domObserver.start()},Ni.root.get=function(){var e=this._root;if(null==e)for(var t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=function(){return document.getSelection()}),this._root=t;return e||document},Ti.prototype.posAtCoords=function(e){return mr(this,e)},Ti.prototype.coordsAtPos=function(e,t){return void 0===t&&(t=1),yr(this,e,t)},Ti.prototype.domAtPos=function(e,t){return void 0===t&&(t=0),this.docView.domFromPos(e,t)},Ti.prototype.nodeDOM=function(e){var t=this.docView.descAt(e);return t?t.nodeDOM:null},Ti.prototype.posAtDOM=function(e,t,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(e,t,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},Ti.prototype.endOfTextblock=function(e,t){return Or(this,t||this.state,e)},Ti.prototype.destroy=function(){this.docView&&(!function(e){for(var t in e.domObserver.stop(),e.eventHandlers)e.dom.removeEventListener(t,e.eventHandlers[t]);clearTimeout(e.composingTimeout),clearTimeout(e.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Ei(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},Ti.prototype.dispatchEvent=function(e){return function(e,t){qo(e,t)||!Bo[t.type]||!e.editable&&t.type in Lo||Bo[t.type](e,t)}(this,e)},Ti.prototype.dispatch=function(e){var t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))},Object.defineProperties(Ti.prototype,Ni);const Pi=(e,t,n)=>{var r;const o=e.state,{from:i}=o.selection,s=e.domAtPos(i).node;if(!(s instanceof HTMLElement))throw new Error;const a=s.getBoundingClientRect(),c=t.getBoundingClientRect(),l=null===(r=t.parentElement)||void 0===r?void 0:r.getBoundingClientRect();if(!l)throw new Error;const[u,f]=n(a,c,l);t.style.top=u+"px",t.style.left=f+"px"},_i=(e,t,n)=>{var r;const o=e.state,{from:i,to:s}=o.selection,a=e.coordsAtPos(i),c=e.coordsAtPos(s),l=t.getBoundingClientRect(),u=null===(r=t.parentElement)||void 0===r?void 0:r.getBoundingClientRect();if(!u)throw new Error;const[f,d]=n(a,c,l,u);t.style.top=f+"px",t.style.left=d+"px"},ji=e=>Object.assign(Object.create(e),e).setTime(Date.now()),Bi=e=>t=>(e=>t=>{for(let n=t.depth;n>0;n--){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}})(e)(t.$from),Li=(e,t)=>{if(!(e instanceof Bt))return;const{node:n,$from:r}=e;return((e,t)=>Array.isArray(e)&&e.indexOf(t.type)>-1||t.type===e)(t,n)?{node:n,pos:r.pos,start:r.start(r.depth),depth:r.depth}:void 0},Vi=O([],"inputRules"),Wi=O([],"inputRulesTimer"),qi=$("InputRulesReady"),Hi=e=>(e.inject(Vi).inject(Wi,[zh,Dm]).record(qi),e=>y(void 0,void 0,void 0,(function*(){yield e.waitTimers(Wi);const t=e.get($h),n=e.get(Rh),r=e.get(Ih),o=(e,t)=>e.map((e=>[R(e.id,r,t),e.inputRules])).flatMap((([e,t])=>e&&(null==t?void 0:t(e,r)))).filter((e=>!!e)),i=[...o(t,!0),...o(n,!1)];e.set(Vi,i),e.done(qi)}))),Ji=O([],"keymap"),Ki=O([],"keymapTimer"),Ui=$("KeymapReady"),Gi=e=>(e.inject(Ji).inject(Ki,[zh,Dm]).record(Ui),e=>y(void 0,void 0,void 0,(function*(){yield e.waitTimers(Ki);const t=e.get($h),n=e.get(Rh),r=e.get(Ih),o=e.get(Em),i=(e,t)=>e.map((e=>[R(e.id,r,t),e.keymap])).map((([e,t])=>e&&(null==t?void 0:t(e,r,o.get)))).filter((e=>!!e)).map(Bn),s=[...i(t,!0),...i(n,!1)];e.set(Ji,s),e.done(Ui)}))),{size:Qi,push:Xi,top:Zi,open:Yi,close:es}=F(),ts=e=>e.isText,ns=e=>(t,n)=>Yi(e)(((e,t,n)=>{const r={type:e,content:t,attrs:n,push:(...e)=>((e,t,...n)=>{e.content.push(t,...n)})(r,...e),pop:()=>(e=>e.content.pop())(r)};return r})(t,[],n)),rs=e=>(t,n,r)=>{const o=t.createAndFill(n,r,e.marks);if(!o)throw((...e)=>{const t=e.reduce(((e,t)=>{if(!t)return e;const n=e=>Array.isArray(e)?e.map((e=>n(e))).join(", "):e.toJSON?x(e.toJSON()):e.spec?x(e.spec):e.toString();return`${e}, ${n(t)}`}),"Create prosemirror node from remark failed in parser");return new Error(t)})(t,n,r);return Xi(e)(o),o},is=e=>()=>{e.marks=J.none;const t=es(e);return rs(e)(t.type,t.attrs,t.content)},ss=e=>(t,n)=>{const r=t.create(n);e.marks=r.addToSet(e.marks)},as=e=>t=>{e.marks=t.removeFromSet(e.marks)},cs=e=>t=>{const n=Zi(e);if(!n)throw S();const r=n.pop(),o=e.schema.text(t,e.marks);if(!r)return void n.push(o);const i=((e,t,n)=>{if(ts(t)&&ts(n)&&J.sameSet(t.marks,n.marks))return e.text(t.text+n.text,t.marks)})(e.schema,r,o);i?n.push(i):n.push(r,o)},ls=e=>()=>{let t=null;do{t=is(e)()}while(Qi(e));return t};var us,fs,ds;class ps{constructor(e,t,n){this.stack=e,this.schema=t,this.specMap=n,us.add(this),this.run=(e,t)=>{const n=e.runSync(e.parse(t));return this.next(n),this},this.next=(e=[])=>([e].flat().forEach((e=>b(this,us,"m",ds).call(this,e))),this),this.toDoc=()=>this.stack.build(),this.injectRoot=(e,t,n)=>(this.stack.openNode(t,n),this.next(e.children),this),this.addText=(e="")=>(this.stack.addText(e),this),this.addNode=(...e)=>(this.stack.addNode(...e),this),this.openNode=(...e)=>(this.stack.openNode(...e),this),this.closeNode=(...e)=>(this.stack.closeNode(...e),this),this.openMark=(...e)=>(this.stack.openMark(...e),this),this.closeMark=(...e)=>(this.stack.closeMark(...e),this)}}us=new WeakSet,fs=function(e){const t=Object.values(this.specMap).find((t=>t.match(e)));if(!t)throw(e=>new Error(`Cannot match target parser for node: ${x(e)}.`))(e);return t},ds=function(e){const{key:t,runner:n,is:r}=b(this,us,"m",fs).call(this,e);n(this,e,this.schema["node"===r?"nodes":"marks"][t])};const hs=(e,t,n)=>r=>{const o=new ps((e=>{const t={marks:[],elements:[],schema:e};return{build:ls(t),openMark:ss(t),closeMark:as(t),addText:cs(t),openNode:ns(t),addNode:rs(t),closeNode:is(t)}})(e),e,t);return o.run(n,r),o.toDoc()};var ms=function(e){if(e)throw e}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */;var vs=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},gs=Object.prototype.hasOwnProperty,ys=Object.prototype.toString,bs=Object.defineProperty,ws=Object.getOwnPropertyDescriptor,ks=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===ys.call(e)},xs=function(e){if(!e||"[object Object]"!==ys.call(e))return!1;var t,n=gs.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&gs.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;for(t in e);return void 0===t||gs.call(e,t)},Ss=function(e,t){bs&&"__proto__"===t.name?bs(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},Cs=function(e,t){if("__proto__"===t){if(!gs.call(e,t))return;if(ws)return ws(e,t).value}return e[t]},Ms=[].slice;var Os=function(e,t){var n;return function(){var t,i=Ms.call(arguments,0),s=e.length>i.length;s&&i.push(r);try{t=e.apply(null,i)}catch(a){if(s&&n)throw a;return r(a)}s||(t&&"function"==typeof t.then?t.then(o,r):t instanceof Error?r(t):o(t))};function r(){n||(n=!0,t.apply(null,arguments))}function o(e){r(null,e)}},As=Ts;Ts.wrap=Os;var Es=[].slice;function Ts(){var e=[],t={run:function(){var t=-1,n=Es.call(arguments,0,-1),r=arguments[arguments.length-1];if("function"!=typeof r)throw new Error("Expected function as last argument, not "+r);function o(i){var s=e[++t],a=Es.call(arguments,0),c=a.slice(1),l=n.length,u=-1;if(i)r(i);else{for(;++u<l;)null!==c[u]&&void 0!==c[u]||(c[u]=n[u]);n=c,s?Os(s,o).apply(null,n):r.apply(null,[null].concat(n))}}o.apply(null,[null].concat(n))},use:function(n){if("function"!=typeof n)throw new Error("Expected `fn` to be a function, not "+n);return e.push(n),t}};return t}var Ns={}.hasOwnProperty,Ds=function(e){if(!e||"object"!=typeof e)return"";if(Ns.call(e,"position")||Ns.call(e,"type"))return Is(e.position);if(Ns.call(e,"start")||Ns.call(e,"end"))return Is(e);if(Ns.call(e,"line")||Ns.call(e,"column"))return zs(e);return""};function zs(e){return e&&"object"==typeof e||(e={}),$s(e.line)+":"+$s(e.column)}function Is(e){return e&&"object"==typeof e||(e={}),zs(e.start)+"-"+zs(e.end)}function $s(e){return e&&"number"==typeof e?e:1}var Rs=Ds,Fs=js;function Ps(){}Ps.prototype=Error.prototype,js.prototype=new Ps;var _s=js.prototype;function js(e,t,n){var r,o,i;"string"==typeof t&&(n=t,t=null),r=function(e){var t,n=[null,null];"string"==typeof e&&(-1===(t=e.indexOf(":"))?n[1]=e:(n[0]=e.slice(0,t),n[1]=e.slice(t+1)));return n}(n),o=Rs(t)||"1:1",i={start:{line:null,column:null},end:{line:null,column:null}},t&&t.position&&(t=t.position),t&&(t.start?(i=t,t=t.start):i.start=t),e.stack&&(this.stack=e.stack,e=e.message),this.message=e,this.name=o,this.reason=e,this.line=t?t.line:null,this.column=t?t.column:null,this.location=i,this.source=r[0],this.ruleId=r[1]}_s.file="",_s.name="",_s.reason="",_s.message="",_s.stack="",_s.fatal=null,_s.column=null,_s.line=null;var Bs={};function Ls(e){var t,n;return Vs(e),t=47===e.charCodeAt(0),(n=function(e,t){var n,r,o="",i=0,s=-1,a=0,c=-1;for(;++c<=e.length;){if(c<e.length)n=e.charCodeAt(c);else{if(47===n)break;n=47}if(47===n){if(s===c-1||1===a);else if(s!==c-1&&2===a){if(o.length<2||2!==i||46!==o.charCodeAt(o.length-1)||46!==o.charCodeAt(o.length-2))if(o.length>2){if((r=o.lastIndexOf("/"))!==o.length-1){r<0?(o="",i=0):i=(o=o.slice(0,r)).length-1-o.lastIndexOf("/"),s=c,a=0;continue}}else if(o.length){o="",i=0,s=c,a=0;continue}t&&(o=o.length?o+"/..":"..",i=2)}else o.length?o+="/"+e.slice(s+1,c):o=e.slice(s+1,c),i=c-s-1;s=c,a=0}else 46===n&&a>-1?a++:a=-1}return o}(e,!t)).length||t||(n="."),n.length&&47===e.charCodeAt(e.length-1)&&(n+="/"),t?"/"+n:n}function Vs(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}Bs.basename=function(e,t){var n,r,o,i,s=0,a=-1;if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');if(Vs(e),n=e.length,void 0===t||!t.length||t.length>e.length){for(;n--;)if(47===e.charCodeAt(n)){if(o){s=n+1;break}}else a<0&&(o=!0,a=n+1);return a<0?"":e.slice(s,a)}if(t===e)return"";r=-1,i=t.length-1;for(;n--;)if(47===e.charCodeAt(n)){if(o){s=n+1;break}}else r<0&&(o=!0,r=n+1),i>-1&&(e.charCodeAt(n)===t.charCodeAt(i--)?i<0&&(a=n):(i=-1,a=r));s===a?a=r:a<0&&(a=e.length);return e.slice(s,a)},Bs.dirname=function(e){var t,n,r;if(Vs(e),!e.length)return".";t=-1,r=e.length;for(;--r;)if(47===e.charCodeAt(r)){if(n){t=r;break}}else n||(n=!0);return t<0?47===e.charCodeAt(0)?"/":".":1===t&&47===e.charCodeAt(0)?"//":e.slice(0,t)},Bs.extname=function(e){var t,n,r,o=-1,i=0,s=-1,a=0;Vs(e),r=e.length;for(;r--;)if(47!==(n=e.charCodeAt(r)))s<0&&(t=!0,s=r+1),46===n?o<0?o=r:1!==a&&(a=1):o>-1&&(a=-1);else if(t){i=r+1;break}if(o<0||s<0||0===a||1===a&&o===s-1&&o===i+1)return"";return e.slice(o,s)},Bs.join=function(){var e,t=-1;for(;++t<arguments.length;)Vs(arguments[t]),arguments[t]&&(e=void 0===e?arguments[t]:e+"/"+arguments[t]);return void 0===e?".":Ls(e)},Bs.sep="/";var Ws={};Ws.cwd=function(){return"/"};var qs=Bs,Hs=Ws,Js=vs,Ks=Qs,Us={}.hasOwnProperty,Gs=["history","path","basename","stem","extname","dirname"];function Qs(e){var t,n;if(e){if("string"==typeof e||Js(e))e={contents:e};else if("message"in e&&"messages"in e)return e}else e={};if(!(this instanceof Qs))return new Qs(e);for(this.data={},this.messages=[],this.history=[],this.cwd=Hs.cwd(),n=-1;++n<Gs.length;)t=Gs[n],Us.call(e,t)&&(this[t]=e[t]);for(t in e)Gs.indexOf(t)<0&&(this[t]=e[t])}function Xs(e,t){if(e&&e.indexOf(qs.sep)>-1)throw new Error("`"+t+"` cannot be a path: did not expect `"+qs.sep+"`")}function Zs(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function Ys(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}Qs.prototype.toString=function(e){return(this.contents||"").toString(e)},Object.defineProperty(Qs.prototype,"path",{get:function(){return this.history[this.history.length-1]},set:function(e){Zs(e,"path"),this.path!==e&&this.history.push(e)}}),Object.defineProperty(Qs.prototype,"dirname",{get:function(){return"string"==typeof this.path?qs.dirname(this.path):void 0},set:function(e){Ys(this.path,"dirname"),this.path=qs.join(e||"",this.basename)}}),Object.defineProperty(Qs.prototype,"basename",{get:function(){return"string"==typeof this.path?qs.basename(this.path):void 0},set:function(e){Zs(e,"basename"),Xs(e,"basename"),this.path=qs.join(this.dirname||"",e)}}),Object.defineProperty(Qs.prototype,"extname",{get:function(){return"string"==typeof this.path?qs.extname(this.path):void 0},set:function(e){if(Xs(e,"extname"),Ys(this.path,"extname"),e){if(46!==e.charCodeAt(0))throw new Error("`extname` must start with `.`");if(e.indexOf(".",1)>-1)throw new Error("`extname` cannot contain multiple dots")}this.path=qs.join(this.dirname,this.stem+(e||""))}}),Object.defineProperty(Qs.prototype,"stem",{get:function(){return"string"==typeof this.path?qs.basename(this.path,this.extname):void 0},set:function(e){Zs(e,"stem"),Xs(e,"stem"),this.path=qs.join(this.dirname||"",e+(this.extname||""))}});var ea=Fs,ta=Ks,na=ta;ta.prototype.message=function(e,t,n){var r=new ea(e,t,n);this.path&&(r.name=this.path+":"+r.name,r.file=this.path);return r.fatal=!1,this.messages.push(r),r},ta.prototype.info=function(){var e=this.message.apply(this,arguments);return e.fatal=null,e},ta.prototype.fail=function(){var e=this.message.apply(this,arguments);throw e.fatal=!0,e};var ra=ms,oa=vs,ia=function e(){var t,n,r,o,i,s,a=arguments[0],c=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},c=2),(null==a||"object"!=typeof a&&"function"!=typeof a)&&(a={});c<l;++c)if(null!=(t=arguments[c]))for(n in t)r=Cs(a,n),a!==(o=Cs(t,n))&&(u&&o&&(xs(o)||(i=ks(o)))?(i?(i=!1,s=r&&ks(r)?r:[]):s=r&&xs(r)?r:{},Ss(a,{name:n,newValue:e(u,s,o)})):void 0!==o&&Ss(a,{name:n,newValue:o}));return a},sa=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype},aa=As,ca=na,la=function e(){var t,n=[],r=aa(),o={},i=-1;return s.data=function(e,n){if("string"==typeof e)return 2===arguments.length?(va("data",t),o[e]=n,s):fa.call(o,e)&&o[e]||null;if(e)return va("data",t),o=e,s;return o},s.freeze=a,s.attachers=n,s.use=function(e){var r;if(va("use",t),null==e);else if("function"==typeof e)u.apply(null,arguments);else{if("object"!=typeof e)throw new Error("Expected usable value, not `"+e+"`");"length"in e?l(e):i(e)}r&&(o.settings=ia(o.settings||{},r));return s;function i(e){l(e.plugins),e.settings&&(r=ia(r||{},e.settings))}function a(e){if("function"==typeof e)u(e);else{if("object"!=typeof e)throw new Error("Expected usable value, not `"+e+"`");"length"in e?u.apply(null,e):i(e)}}function l(e){var t=-1;if(null==e);else{if("object"!=typeof e||!("length"in e))throw new Error("Expected a list of plugins, not `"+e+"`");for(;++t<e.length;)a(e[t])}}function u(e,t){var r=c(e);r?(sa(r[1])&&sa(t)&&(t=ia(!0,r[1],t)),r[1]=t):n.push(ua.call(arguments))}},s.parse=function(e){var t,n=ca(e);if(a(),ha("parse",t=s.Parser),pa(t,"parse"))return new t(String(n),n).parse();return t(String(n),n)},s.stringify=function(e,t){var n,r=ca(t);if(a(),ma("stringify",n=s.Compiler),ga(e),pa(n,"compile"))return new n(e,r).compile();return n(e,r)},s.run=l,s.runSync=function(e,t){var n,r;return l(e,t,o),ya("runSync","run",r),n;function o(e,t){r=!0,n=t,ra(e)}},s.process=u,s.processSync=function(e){var t,n;return a(),ha("processSync",s.Parser),ma("processSync",s.Compiler),u(t=ca(e),r),ya("processSync","process",n),t;function r(e){n=!0,ra(e)}},s;function s(){for(var t=e(),r=-1;++r<n.length;)t.use.apply(null,n[r]);return t.data(ia(!0,{},o)),t}function a(){var e,o;if(t)return s;for(;++i<n.length;)!1!==(e=n[i])[1]&&(!0===e[1]&&(e[1]=void 0),"function"==typeof(o=e[0].apply(s,e.slice(1)))&&r.use(o));return t=!0,i=1/0,s}function c(e){for(var t=-1;++t<n.length;)if(n[t][0]===e)return n[t]}function l(e,t,n){if(ga(e),a(),n||"function"!=typeof t||(n=t,t=null),!n)return new Promise(o);function o(o,i){r.run(e,ca(t),(function(t,r,s){r=r||e,t?i(t):o?o(r):n(null,r,s)}))}o(null,n)}function u(e,t){if(a(),ha("process",s.Parser),ma("process",s.Compiler),!t)return new Promise(n);function n(n,r){var o=ca(e);da.run(s,{file:o},(function(e){e?r(e):n?n(o):t(null,o)}))}n(null,t)}}().freeze(),ua=[].slice,fa={}.hasOwnProperty,da=aa().use((function(e,t){t.tree=e.parse(t.file)})).use((function(e,t,n){e.run(t.tree,t.file,(function(e,r,o){e?n(e):(t.tree=r,t.file=o,n())}))})).use((function(e,t){var n=e.stringify(t.tree,t.file);null==n||("string"==typeof n||oa(n)?("value"in t.file&&(t.file.value=n),t.file.contents=n):t.file.result=n)}));function pa(e,t){return"function"==typeof e&&e.prototype&&(function(e){var t;for(t in e)return!0;return!1}(e.prototype)||t in e.prototype)}function ha(e,t){if("function"!=typeof t)throw new Error("Cannot `"+e+"` without `Parser`")}function ma(e,t){if("function"!=typeof t)throw new Error("Cannot `"+e+"` without `Compiler`")}function va(e,t){if(t)throw new Error("Cannot invoke `"+e+"` on a frozen processor.\nCreate a new processor first, by invoking it: use `processor()` instead of `processor`.")}function ga(e){if(!e||"string"!=typeof e.type)throw new Error("Expected node, got `"+e+"`")}function ya(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}var ba=wa;function wa(e){return e&&(e.value||e.alt||e.title||"children"in e&&ka(e.children)||"length"in e&&ka(e))||""}function ka(e){for(var t=[],n=-1;++n<e.length;)t[n]=wa(e[n]);return t.join("")}var xa=Object.assign,Sa={}.hasOwnProperty;var Ca=function(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()},Ma=String.fromCharCode,Oa=Ma;var Aa=function(e,t){var n=parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535==(65535&n)||65534==(65535&n)||n>1114111?"�":Oa(n)},Ea={};var Ta=function(e){return e<-2};var Na=function(e){return-2===e||-1===e||32===e},Da=Na;var za=function(e,t,n,r){var o=r?r-1:1/0,i=0;return function(r){if(Da(r))return e.enter(n),s(r);return t(r)};function s(r){return Da(r)&&i++<o?(e.consume(r),s):(e.exit(n),t(r))}};Object.defineProperty(Ea,"__esModule",{value:!0});var Ia=Ta,$a=za,Ra=function(e){var t,n=e.attempt(this.parser.constructs.contentInitial,(function(t){if(null===t)return void e.consume(t);return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),$a(e,n,"linePrefix")}),(function(t){return e.enter("paragraph"),r(t)}));return n;function r(n){var r=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=r),t=r,o(n)}function o(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):Ia(t)?(e.consume(t),e.exit("chunkText"),r):(e.consume(t),o)}};Ea.tokenize=Ra;var Fa={},Pa=Ta,_a=za;var ja={tokenize:function(e,t,n){return _a(e,(function(e){return null===e||Pa(e)?t(e):n(e)}),"linePrefix")},partial:!0};Object.defineProperty(Fa,"__esModule",{value:!0});var Ba=Ta,La=za,Va=ja,Wa=function(e){var t,n,r,o=this,i=[],s=0,a={tokenize:function(e,r){var s=0;return t={},a;function a(r){return s<i.length?(o.containerState=i[s][1],e.attempt(i[s][0].continuation,c,l)(r)):n.currentConstruct&&n.currentConstruct.concrete?(t.flowContinue=!0,d(r)):(o.interrupt=n.currentConstruct&&n.currentConstruct.interruptible,o.containerState={},e.attempt(qa,f,d)(r))}function c(e){return s++,o.containerState._closeFlow?f(e):a(e)}function l(t){return n.currentConstruct&&n.currentConstruct.lazy?(o.containerState={},e.attempt(qa,f,e.attempt(Ha,f,e.check(Va,f,u)))(t)):f(t)}function u(e){return s=i.length,t.lazy=!0,t.flowContinue=!0,d(e)}function f(e){return t.flowEnd=!0,d(e)}function d(e){return t.continued=s,o.interrupt=o.containerState=void 0,r(e)}},partial:!0};return c;function c(t){return s<i.length?(o.containerState=i[s][1],e.attempt(i[s][0].continuation,l,u)(t)):u(t)}function l(e){return s++,c(e)}function u(r){return t&&t.flowContinue?d(r):(o.interrupt=n&&n.currentConstruct&&n.currentConstruct.interruptible,o.containerState={},e.attempt(qa,f,d)(r))}function f(e){return i.push([o.currentConstruct,o.containerState]),o.containerState=void 0,u(e)}function d(t){return null===t?(v(0,!0),void e.consume(t)):(n=n||o.parser.flow(o.now()),e.enter("chunkFlow",{contentType:"flow",previous:r,_tokenizer:n}),p(t))}function p(t){return null===t?(m(e.exit("chunkFlow")),d(t)):Ba(t)?(e.consume(t),m(e.exit("chunkFlow")),e.check(a,h)):(e.consume(t),p)}function h(e){return v(t.continued,t&&t.flowEnd),s=0,c(e)}function m(e){r&&(r.next=e),r=e,n.lazy=t&&t.lazy,n.defineSkip(e.start),n.write(o.sliceStream(e))}function v(t,s){var a=i.length;for(n&&s&&(n.write([null]),r=n=void 0);a-- >t;)o.containerState=i[a][1],i[a][0].exit.call(o,e);i.length=t}},qa={tokenize:function(e,t,n){return La(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},Ha={tokenize:function(e,t,n){return La(e,e.lazy(this.parser.constructs.flow,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}};Fa.tokenize=Wa;var Ja={};var Ka=function(e){for(var t=-1,n=0;++t<e.length;)n+="string"==typeof e[t]?e[t].length:1;return n},Ua=Ka;var Ga=function(e,t){var n=e[e.length-1];return n&&n[1].type===t?Ua(n[2].sliceStream(n[1])):0},Qa=[].splice;var Xa=function(e,t,n,r){var o,i=e.length,s=0;if(t=t<0?-t>i?0:i+t:t>i?i:t,n=n>0?n:0,r.length<1e4)(o=Array.from(r)).unshift(t,n),Qa.apply(e,o);else for(n&&Qa.apply(e,[t,n]);s<r.length;)(o=r.slice(s,s+1e4)).unshift(t,0),Qa.apply(e,o),s+=1e4,t+=1e4},Za=xa;var Ya=function(e){return Za({},e)},ec=xa,tc=Xa,nc=Ya;function rc(e,t){for(var n,r,o,i,s,a,c=e[t][1],l=e[t][2],u=t-1,f=[],d=c._tokenizer||l.parser[c.contentType](c.start),p=d.events,h=[],m={};c;){for(;e[++u][1]!==c;);f.push(u),c._tokenizer||(n=l.sliceStream(c),c.next||n.push(null),r&&d.defineSkip(c.start),c.isInFirstContentOfListItem&&(d._gfmTasklistFirstContentOfListItem=!0),d.write(n),c.isInFirstContentOfListItem&&(d._gfmTasklistFirstContentOfListItem=void 0)),r=c,c=c.next}for(c=r,o=p.length;o--;)"enter"===p[o][0]?i=!0:i&&p[o][1].type===p[o-1][1].type&&p[o][1].start.line!==p[o][1].end.line&&(v(p.slice(o+1,s)),c._tokenizer=c.next=void 0,c=c.previous,s=o+1);for(d.events=c._tokenizer=c.next=void 0,v(p.slice(0,s)),o=-1,a=0;++o<h.length;)m[a+h[o][0]]=a+h[o][1],a+=h[o][1]-h[o][0]-1;return m;function v(t){var n=f.pop();h.unshift([n,n+t.length-1]),tc(e,n,2,t)}}var oc=function(e){for(var t,n,r,o,i,s,a,c={},l=-1;++l<e.length;){for(;l in c;)l=c[l];if(t=e[l],l&&"chunkFlow"===t[1].type&&"listItemPrefix"===e[l-1][1].type&&((r=0)<(s=t[1]._tokenizer.events).length&&"lineEndingBlank"===s[r][1].type&&(r+=2),r<s.length&&"content"===s[r][1].type))for(;++r<s.length&&"content"!==s[r][1].type;)"chunkText"===s[r][1].type&&(s[r][1].isInFirstContentOfListItem=!0,r++);if("enter"===t[0])t[1].contentType&&(ec(c,rc(e,l)),l=c[l],a=!0);else if(t[1]._container||t[1]._movePreviousLineEndings){for(r=l,n=void 0;r--&&("lineEnding"===(o=e[r])[1].type||"lineEndingBlank"===o[1].type);)"enter"===o[0]&&(n&&(e[n][1].type="lineEndingBlank"),o[1].type="lineEnding",n=r);n&&(t[1].end=nc(e[n][1].start),(i=e.slice(n,l)).unshift(t),tc(e,n,l-n+1,i))}}return!a},ic=Ta,sc=Ga,ac=oc,cc=za,lc={tokenize:function(e,t){var n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),r(t)};function r(t){return null===t?o(t):ic(t)?e.check(uc,i,o)(t):(e.consume(t),r)}function o(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function i(t){return e.consume(t),e.exit("chunkContent"),n=n.next=e.enter("chunkContent",{contentType:"content",previous:n}),r}},resolve:function(e){return ac(e),e},interruptible:!0,lazy:!0},uc={tokenize:function(e,t,n){var r=this;return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),cc(e,o,"linePrefix")};function o(o){return null===o||ic(o)?n(o):r.parser.constructs.disable.null.indexOf("codeIndented")>-1||sc(r.events,"linePrefix")<4?e.interrupt(r.parser.constructs.flow,n,t)(o):t(o)}},partial:!0};var fc=lc;Object.defineProperty(Ja,"__esModule",{value:!0});var dc=fc,pc=za,hc=ja,mc=function(e){var t=this,n=e.attempt(hc,(function(r){if(null===r)return void e.consume(r);return e.enter("lineEndingBlank"),e.consume(r),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}),e.attempt(this.parser.constructs.flowInitial,r,pc(e,e.attempt(this.parser.constructs.flow,r,e.attempt(dc,r)),"linePrefix")));return n;function r(r){if(null!==r)return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(r)}};Ja.tokenize=mc;var vc={};Object.defineProperty(vc,"__esModule",{value:!0});var gc=xa,yc=Ya,bc=xc("text"),wc=xc("string"),kc={resolveAll:Sc()};function xc(e){return{tokenize:function(t){var n=this,r=this.parser.constructs[e],o=t.attempt(r,i,s);return i;function i(e){return c(e)?o(e):s(e)}function s(e){if(null!==e)return t.enter("data"),t.consume(e),a;t.consume(e)}function a(e){return c(e)?(t.exit("data"),o(e)):(t.consume(e),a)}function c(e){var t=r[e],o=-1;if(null===e)return!0;if(t)for(;++o<t.length;)if(!t[o].previous||t[o].previous.call(n,n.previous))return!0}},resolveAll:Sc("text"===e?Cc:void 0)}}function Sc(e){return function(t,n){var r,o=-1;for(;++o<=t.length;)void 0===r?t[o]&&"data"===t[o][1].type&&(r=o,o++):t[o]&&"data"===t[o][1].type||(o!==r+2&&(t[r][1].end=t[o-1][1].end,t.splice(r+2,o-r-2),o=r+2),r=void 0);return e?e(t,n):t}}function Cc(e,t){for(var n,r,o,i,s,a,c,l,u=-1;++u<=e.length;)if((u===e.length||"lineEnding"===e[u][1].type)&&"data"===e[u-1][1].type){for(r=e[u-1][1],i=(n=t.sliceStream(r)).length,s=-1,a=0,c=void 0;i--;)if("string"==typeof(o=n[i])){for(s=o.length;32===o.charCodeAt(s-1);)a++,s--;if(s)break;s=-1}else if(-2===o)c=!0,a++;else if(-1!==o){i++;break}a&&(l={type:u===e.length||c||a<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-a,offset:r.end.offset-a,_index:r.start._index+i,_bufferIndex:i?s:r.start._bufferIndex+s},end:yc(r.end)},r.end=yc(l.start),r.start.offset===r.end.offset?gc(r,l):(e.splice(u,0,["enter",l,t],["exit",l,t]),u+=2)),u++}return e}vc.resolver=kc,vc.string=wc,vc.text=bc;var Mc=function(e){return null==e?[]:"length"in e?e:[e]},Oc=Sa,Ac=Xa,Ec=Mc;function Tc(e,t){var n,r,o,i;for(n in t)for(i in r=Oc.call(e,n)?e[n]:e[n]={},o=t[n])r[i]=Nc(Ec(o[i]),Oc.call(r,i)?r[i]:[])}function Nc(e,t){for(var n=-1,r=[];++n<e.length;)("after"===e[n].add?t:r).push(e[n]);return Ac(t,0,0,r),t}var Dc=function(e){for(var t={},n=-1;++n<e.length;)Tc(t,e[n]);return t},zc=Xa;var Ic=function(e,t){return e.length?(zc(e,e.length,0,t),e):t};var $c=function(e,t,n){for(var r,o=[],i=-1;++i<e.length;)(r=e[i].resolveAll)&&o.indexOf(r)<0&&(t=r(t,n),o.push(r));return t},Rc=Ma;var Fc=xa,Pc=Ta,_c=Ic,jc=Xa,Bc=Mc,Lc=$c,Vc=function(e){for(var t,n,r,o=-1,i=[];++o<e.length;){if("string"==typeof(t=e[o]))n=t;else if(-5===t)n="\r";else if(-4===t)n="\n";else if(-3===t)n="\r\n";else if(-2===t)n="\t";else if(-1===t){if(r)continue;n=" "}else n=Rc(t);r=-2===t,i.push(n)}return i.join("")},Wc=Ya,qc=function(e,t){var n,r=t.start._index,o=t.start._bufferIndex,i=t.end._index,s=t.end._bufferIndex;return r===i?n=[e[r].slice(o,s)]:(n=e.slice(r,i),o>-1&&(n[0]=n[0].slice(o)),s>0&&n.push(e[i].slice(0,s))),n};var Hc=function(e,t,n){var r=n?Wc(n):{line:1,column:1,offset:0},o={},i=[],s=[],a=[],c={consume:function(e){Pc(e)?(r.line++,r.column=1,r.offset+=-3===e?2:1,y()):-1!==e&&(r.column++,r.offset++);r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===s[r._index].length&&(r._bufferIndex=-1,r._index++));l.previous=e},enter:function(e,t){var n=t||{};return n.type=e,n.start=d(),l.events.push(["enter",n,l]),a.push(n),n},exit:function(e){var t=a.pop();return t.end=d(),l.events.push(["exit",t,l]),t},attempt:v((function(e,t){g(e,t.from)})),check:v(m),interrupt:v(m,{interrupt:!0}),lazy:v(m,{lazy:!0})},l={previous:null,events:[],parser:e,sliceStream:f,sliceSerialize:function(e){return Vc(f(e))},now:d,defineSkip:function(e){o[e.line]=e.column,y()},write:function(e){if(s=_c(s,e),p(),null!==s[s.length-1])return[];return g(t,0),l.events=Lc(i,l.events,l),l.events}},u=t.tokenize.call(l,c);return t.resolveAll&&i.push(t),r._index=0,r._bufferIndex=-1,l;function f(e){return qc(s,e)}function d(){return Wc(r)}function p(){for(var e,t;r._index<s.length;)if("string"==typeof(t=s[r._index]))for(e=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===e&&r._bufferIndex<t.length;)h(t.charCodeAt(r._bufferIndex));else h(t)}function h(e){u=u(e)}function m(e,t){t.restore()}function v(e,t){return function(n,o,i){var s,u,f,p;return n.tokenize||"length"in n?h(Bc(n)):function(e){if(e in n||null in n)return h(n.null?Bc(n[e]).concat(Bc(n.null)):n[e])(e);return i(e)};function h(e){return s=e,m(e[u=0])}function m(e){return function(n){p=function(){var e=d(),t=l.previous,n=l.currentConstruct,o=l.events.length,i=Array.from(a);return{restore:s,from:o};function s(){r=e,l.previous=t,l.currentConstruct=n,l.events.length=o,a=i,y()}}(),f=e,e.partial||(l.currentConstruct=e);if(e.name&&l.parser.constructs.disable.null.indexOf(e.name)>-1)return g();return e.tokenize.call(t?Fc({},l,t):l,c,v,g)(n)}}function v(t){return e(f,p),o}function g(e){return p.restore(),++u<s.length?m(s[u]):i}}}function g(e,t){e.resolveAll&&i.indexOf(e)<0&&i.push(e),e.resolve&&jc(l.events,t,l.events.length-t,e.resolve(l.events.slice(t),l)),e.resolveTo&&(l.events=e.resolveTo(l.events,l))}function y(){r.line in o&&r.column<2&&(r.column=o[r.line],r.offset+=o[r.line]-1)}},Jc={};var Kc=function(e){return e<0||32===e},Uc=Ma;var Gc=function(e){return function(t){return e.test(Uc(t))}},Qc=Gc(/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/),Xc=Gc(/\s/),Zc=Kc,Yc=Qc,el=Xc;var tl=function(e){return null===e||Zc(e)||el(e)?1:Yc(e)?2:void 0};var nl=Ic,rl=Xa,ol=tl,il=function(e,t){return e.column+=t,e.offset+=t,e._bufferIndex+=t,e},sl=$c,al=Ya;var cl={name:"attention",tokenize:function(e,t){var n,r=ol(this.previous);return function(t){return e.enter("attentionSequence"),n=t,o(t)};function o(i){var s,a,c,l;return i===n?(e.consume(i),o):(s=e.exit("attentionSequence"),c=!(a=ol(i))||2===a&&r,l=!r||2===r&&a,s._open=42===n?c:c&&(r||!l),s._close=42===n?l:l&&(a||!c),t(i))}},resolveAll:function(e,t){var n,r,o,i,s,a,c,l,u=-1;for(;++u<e.length;)if("enter"===e[u][0]&&"attentionSequence"===e[u][1].type&&e[u][1]._close)for(n=u;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[u][1]).charCodeAt(0)){if((e[n][1]._close||e[u][1]._open)&&(e[u][1].end.offset-e[u][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[u][1].end.offset-e[u][1].start.offset)%3))continue;a=e[n][1].end.offset-e[n][1].start.offset>1&&e[u][1].end.offset-e[u][1].start.offset>1?2:1,i={type:a>1?"strongSequence":"emphasisSequence",start:il(al(e[n][1].end),-a),end:al(e[n][1].end)},s={type:a>1?"strongSequence":"emphasisSequence",start:al(e[u][1].start),end:il(al(e[u][1].start),a)},o={type:a>1?"strongText":"emphasisText",start:al(e[n][1].end),end:al(e[u][1].start)},r={type:a>1?"strong":"emphasis",start:al(i.start),end:al(s.end)},e[n][1].end=al(i.start),e[u][1].start=al(s.end),c=[],e[n][1].end.offset-e[n][1].start.offset&&(c=nl(c,[["enter",e[n][1],t],["exit",e[n][1],t]])),c=nl(c,[["enter",r,t],["enter",i,t],["exit",i,t],["enter",o,t]]),c=nl(c,sl(t.parser.constructs.insideSpan.null,e.slice(n+1,u),t)),c=nl(c,[["exit",o,t],["enter",s,t],["exit",s,t],["exit",r,t]]),e[u][1].end.offset-e[u][1].start.offset?(l=2,c=nl(c,[["enter",e[u][1],t],["exit",e[u][1],t]])):l=0,rl(e,n-1,u-n+3,c),u=n+c.length-l-2;break}u=-1;for(;++u<e.length;)"attentionSequence"===e[u][1].type&&(e[u][1].type="data");return e}},ll=Gc(/[A-Za-z]/),ul=Gc(/[\dA-Za-z]/),fl=Gc(/[#-'*+\--9=?A-Z^-~]/);var dl=function(e){return e<32||127===e},pl=ll,hl=ul,ml=fl,vl=dl;var gl={name:"autolink",tokenize:function(e,t,n){var r=1;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o};function o(t){return pl(t)?(e.consume(t),i):ml(t)?c(t):n(t)}function i(e){return 43===e||45===e||46===e||hl(e)?s(e):c(e)}function s(t){return 58===t?(e.consume(t),a):(43===t||45===t||46===t||hl(t))&&r++<32?(e.consume(t),s):c(t)}function a(t){return 62===t?(e.exit("autolinkProtocol"),d(t)):32===t||60===t||vl(t)?n(t):(e.consume(t),a)}function c(t){return 64===t?(e.consume(t),r=0,l):ml(t)?(e.consume(t),c):n(t)}function l(e){return hl(e)?u(e):n(e)}function u(t){return 46===t?(e.consume(t),r=0,l):62===t?(e.exit("autolinkProtocol").type="autolinkEmail",d(t)):f(t)}function f(t){return(45===t||hl(t))&&r++<63?(e.consume(t),45===t?f:u):n(t)}function d(n){return e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t}}},yl=Na,bl=za,wl={name:"blockQuote",tokenize:function(e,t,n){var r=this;return function(t){if(62===t)return r.containerState.open||(e.enter("blockQuote",{_container:!0}),r.containerState.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),o;return n(t)};function o(n){return yl(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}},continuation:{tokenize:function(e,t,n){return bl(e,e.attempt(wl,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},exit:function(e){e.exit("blockQuote")}};var kl=wl,xl=Gc(/[!-/:-@[-`{-~]/);var Sl,Cl={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),r};function r(r){return xl(r)?(e.enter("characterEscapeValue"),e.consume(r),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(r)}}},Ml=function(e){var t,n="&"+e+";";if((Sl=Sl||document.createElement("i")).innerHTML=n,59===(t=Sl.textContent).charCodeAt(t.length-1)&&"semi"!==e)return!1;return t!==n&&t};var Ol=Gc(/\d/),Al=Gc(/[\dA-Fa-f]/),El=ul,Tl=Ol,Nl=Al;function Dl(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var zl=Dl(Ml);var Il={name:"characterReference",tokenize:function(e,t,n){var r,o,i=this,s=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),a};function a(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),r=31,o=El,l(t))}function c(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),r=6,o=Nl,l):(e.enter("characterReferenceValue"),r=7,o=Tl,l(t))}function l(a){var c;return 59===a&&s?(c=e.exit("characterReferenceValue"),o!==El||zl.default(i.sliceSerialize(c))?(e.enter("characterReferenceMarker"),e.consume(a),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(a)):o(a)&&s++<r?(e.consume(a),l):n(a)}}},$l=Ta,Rl=Kc,Fl=Ga,Pl=za;var _l={name:"codeFenced",tokenize:function(e,t,n){var r,o=this,i={tokenize:function(e,t,n){var o=0;return Pl(e,i,"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4);function i(t){return e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),s(t)}function s(t){return t===r?(e.consume(t),o++,s):o<a?n(t):(e.exit("codeFencedFenceSequence"),Pl(e,c,"whitespace")(t))}function c(r){return null===r||$l(r)?(e.exit("codeFencedFence"),t(r)):n(r)}},partial:!0},s=Fl(this.events,"linePrefix"),a=0;return function(t){return e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),r=t,c(t)};function c(t){return t===r?(e.consume(t),a++,c):(e.exit("codeFencedFenceSequence"),a<3?n(t):Pl(e,l,"whitespace")(t))}function l(t){return null===t||$l(t)?p(t):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),u(t))}function u(t){return null===t||Rl(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Pl(e,f,"whitespace")(t)):96===t&&t===r?n(t):(e.consume(t),u)}function f(t){return null===t||$l(t)?p(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return null===t||$l(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),p(t)):96===t&&t===r?n(t):(e.consume(t),d)}function p(n){return e.exit("codeFencedFence"),o.interrupt?t(n):h(n)}function h(t){return null===t?v(t):$l(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),e.attempt(i,v,s?Pl(e,h,"linePrefix",s+1):h)):(e.enter("codeFlowValue"),m(t))}function m(t){return null===t||$l(t)?(e.exit("codeFlowValue"),h(t)):(e.consume(t),m)}function v(n){return e.exit("codeFenced"),t(n)}},concrete:!0},jl=Ta,Bl=Xa,Ll=Ga,Vl=za,Wl={name:"codeIndented",tokenize:function(e,t,n){return e.attempt(ql,r,n);function r(n){return null===n?t(n):jl(n)?e.attempt(ql,r,t)(n):(e.enter("codeFlowValue"),o(n))}function o(t){return null===t||jl(t)?(e.exit("codeFlowValue"),r(t)):(e.consume(t),o)}},resolve:function(e,t){var n={type:"codeIndented",start:e[0][1].start,end:e[e.length-1][1].end};return Bl(e,0,0,[["enter",n,t]]),Bl(e,e.length,0,[["exit",n,t]]),e}},ql={tokenize:function(e,t,n){var r=this;return Vl(e,(function o(i){if(jl(i))return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),Vl(e,o,"linePrefix",5);return Ll(r.events,"linePrefix")<4?n(i):t(i)}),"linePrefix",5)},partial:!0};var Hl=Wl,Jl=Ta;var Kl={name:"codeText",tokenize:function(e,t,n){var r,o,i=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),s(t)};function s(t){return 96===t?(e.consume(t),i++,s):(e.exit("codeTextSequence"),a(t))}function a(t){return null===t?n(t):96===t?(o=e.enter("codeTextSequence"),r=0,l(t)):32===t?(e.enter("space"),e.consume(t),e.exit("space"),a):Jl(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),a):(e.enter("codeTextData"),c(t))}function c(t){return null===t||32===t||96===t||Jl(t)?(e.exit("codeTextData"),a(t)):(e.consume(t),c)}function l(n){return 96===n?(e.consume(n),r++,l):r===i?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(o.type="codeTextData",c(n))}},resolve:function(e){var t,n,r=e.length-4,o=3;if(!("lineEnding"!==e[o][1].type&&"space"!==e[o][1].type||"lineEnding"!==e[r][1].type&&"space"!==e[r][1].type))for(t=o;++t<r;)if("codeTextData"===e[t][1].type){e[r][1].type=e[o][1].type="codeTextPadding",o+=2,r-=2;break}t=o-1,r++;for(;++t<=r;)void 0===n?t!==r&&"lineEnding"!==e[t][1].type&&(n=t):t!==r&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),r-=t-n-2,t=n+2),n=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}},Ul=dl,Gl=Kc,Ql=Ta;var Xl=function(e,t,n,r,o,i,s,a,c){var l=c||1/0,u=0;return function(t){if(60===t)return e.enter(r),e.enter(o),e.enter(i),e.consume(t),e.exit(i),f;if(Ul(t)||41===t)return n(t);return e.enter(r),e.enter(s),e.enter(a),e.enter("chunkString",{contentType:"string"}),h(t)};function f(n){return 62===n?(e.enter(i),e.consume(n),e.exit(i),e.exit(o),e.exit(r),t):(e.enter(a),e.enter("chunkString",{contentType:"string"}),d(n))}function d(t){return 62===t?(e.exit("chunkString"),e.exit(a),f(t)):null===t||60===t||Ql(t)?n(t):(e.consume(t),92===t?p:d)}function p(t){return 60===t||62===t||92===t?(e.consume(t),d):d(t)}function h(o){return 40===o?++u>l?n(o):(e.consume(o),h):41===o?u--?(e.consume(o),h):(e.exit("chunkString"),e.exit(a),e.exit(s),e.exit(r),t(o)):null===o||Gl(o)?u?n(o):(e.exit("chunkString"),e.exit(a),e.exit(s),e.exit(r),t(o)):Ul(o)?n(o):(e.consume(o),92===o?m:h)}function m(t){return 40===t||41===t||92===t?(e.consume(t),h):h(t)}},Zl=Ta,Yl=Na;var eu=function(e,t,n,r,o,i){var s,a=this,c=0;return function(t){return e.enter(r),e.enter(o),e.consume(t),e.exit(o),e.enter(i),l};function l(f){return null===f||91===f||93===f&&!s||94===f&&!c&&"_hiddenFootnoteSupport"in a.parser.constructs||c>999?n(f):93===f?(e.exit(i),e.enter(o),e.consume(f),e.exit(o),e.exit(r),t):Zl(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),l):(e.enter("chunkString",{contentType:"string"}),u(f))}function u(t){return null===t||91===t||93===t||Zl(t)||c++>999?(e.exit("chunkString"),l(t)):(e.consume(t),s=s||!Yl(t),92===t?f:u)}function f(t){return 91===t||92===t||93===t?(e.consume(t),c++,u):u(t)}},tu=Ta,nu=Na,ru=za;var ou=function(e,t){var n;return function r(o){if(tu(o))return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n=!0,r;if(nu(o))return ru(e,r,n?"linePrefix":"lineSuffix")(o);return t(o)}},iu=Ta,su=za;var au=function(e,t,n,r,o,i){var s;return function(t){return e.enter(r),e.enter(o),e.consume(t),e.exit(o),s=40===t?41:t,a};function a(n){return n===s?(e.enter(o),e.consume(n),e.exit(o),e.exit(r),t):(e.enter(i),c(n))}function c(t){return t===s?(e.exit(i),a(s)):null===t?n(t):iu(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),su(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),l(t))}function l(t){return t===s||null===t||iu(t)?(e.exit("chunkString"),c(t)):(e.consume(t),92===t?u:l)}function u(t){return t===s||92===t?(e.consume(t),l):l(t)}},cu=Ta,lu=Kc,uu=Ca,fu=Xl,du=eu,pu=za,hu=ou,mu=au,vu={name:"definition",tokenize:function(e,t,n){var r,o=this;return function(t){return e.enter("definition"),du.call(o,e,i,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)};function i(t){return r=uu(o.sliceSerialize(o.events[o.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),hu(e,fu(e,e.attempt(gu,pu(e,s,"whitespace"),pu(e,s,"whitespace")),n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):n(t)}function s(i){return null===i||cu(i)?(e.exit("definition"),o.parser.defined.indexOf(r)<0&&o.parser.defined.push(r),t(i)):n(i)}}},gu={tokenize:function(e,t,n){return function(t){return lu(t)?hu(e,r)(t):n(t)};function r(t){return 34===t||39===t||40===t?mu(e,pu(e,o,"whitespace"),n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t):n(t)}function o(e){return null===e||cu(e)?t(e):n(e)}},partial:!0};var yu=vu,bu=Ta;var wu={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.enter("escapeMarker"),e.consume(t),r};function r(r){return bu(r)?(e.exit("escapeMarker"),e.exit("hardBreakEscape"),t(r)):n(r)}}},ku=Ta,xu=Kc,Su=Na,Cu=Xa,Mu=za;var Ou={name:"headingAtx",tokenize:function(e,t,n){var r=this,o=0;return function(t){return e.enter("atxHeading"),e.enter("atxHeadingSequence"),i(t)};function i(a){return 35===a&&o++<6?(e.consume(a),i):null===a||xu(a)?(e.exit("atxHeadingSequence"),r.interrupt?t(a):s(a)):n(a)}function s(n){return 35===n?(e.enter("atxHeadingSequence"),a(n)):null===n||ku(n)?(e.exit("atxHeading"),t(n)):Su(n)?Mu(e,s,"whitespace")(n):(e.enter("atxHeadingText"),c(n))}function a(t){return 35===t?(e.consume(t),a):(e.exit("atxHeadingSequence"),s(t))}function c(t){return null===t||35===t||xu(t)?(e.exit("atxHeadingText"),s(t)):(e.consume(t),c)}},resolve:function(e,t){var n,r,o=e.length-2,i=3;"whitespace"===e[i][1].type&&(i+=2);o-2>i&&"whitespace"===e[o][1].type&&(o-=2);"atxHeadingSequence"===e[o][1].type&&(i===o-1||o-4>i&&"whitespace"===e[o-2][1].type)&&(o-=i+1===o?2:4);o>i&&(n={type:"atxHeadingText",start:e[i][1].start,end:e[o][1].end},r={type:"chunkText",start:e[i][1].start,end:e[o][1].end,contentType:"text"},Cu(e,i,o-i+1,[["enter",n,t],["enter",r,t],["exit",r,t],["exit",n,t]]));return e}},Au=ll,Eu=ul,Tu=Ta,Nu=Kc,Du=Na,zu=Ma,Iu=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],$u=["pre","script","style","textarea"],Ru=ja,Fu={name:"htmlFlow",tokenize:function(e,t,n){var r,o,i,s,a,c=this;return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),l};function l(s){return 33===s?(e.consume(s),u):47===s?(e.consume(s),p):63===s?(e.consume(s),r=3,c.interrupt?t:I):Au(s)?(e.consume(s),i=zu(s),o=!0,h):n(s)}function u(o){return 45===o?(e.consume(o),r=2,f):91===o?(e.consume(o),r=5,i="CDATA[",s=0,d):Au(o)?(e.consume(o),r=4,c.interrupt?t:I):n(o)}function f(r){return 45===r?(e.consume(r),c.interrupt?t:I):n(r)}function d(r){return r===i.charCodeAt(s++)?(e.consume(r),s===i.length?c.interrupt?t:O:d):n(r)}function p(t){return Au(t)?(e.consume(t),i=zu(t),h):n(t)}function h(s){return null===s||47===s||62===s||Nu(s)?47!==s&&o&&$u.indexOf(i.toLowerCase())>-1?(r=1,c.interrupt?t(s):O(s)):Iu.indexOf(i.toLowerCase())>-1?(r=6,47===s?(e.consume(s),m):c.interrupt?t(s):O(s)):(r=7,c.interrupt?n(s):o?g(s):v(s)):45===s||Eu(s)?(e.consume(s),i+=zu(s),h):n(s)}function m(r){return 62===r?(e.consume(r),c.interrupt?t:O):n(r)}function v(t){return Du(t)?(e.consume(t),v):C(t)}function g(t){return 47===t?(e.consume(t),C):58===t||95===t||Au(t)?(e.consume(t),y):Du(t)?(e.consume(t),g):C(t)}function y(t){return 45===t||46===t||58===t||95===t||Eu(t)?(e.consume(t),y):b(t)}function b(t){return 61===t?(e.consume(t),w):Du(t)?(e.consume(t),b):g(t)}function w(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),a=t,k):Du(t)?(e.consume(t),w):(a=void 0,x(t))}function k(t){return t===a?(e.consume(t),S):null===t||Tu(t)?n(t):(e.consume(t),k)}function x(t){return null===t||34===t||39===t||60===t||61===t||62===t||96===t||Nu(t)?b(t):(e.consume(t),x)}function S(e){return 47===e||62===e||Du(e)?g(e):n(e)}function C(t){return 62===t?(e.consume(t),M):n(t)}function M(t){return Du(t)?(e.consume(t),M):null===t||Tu(t)?O(t):n(t)}function O(t){return 45===t&&2===r?(e.consume(t),T):60===t&&1===r?(e.consume(t),N):62===t&&4===r?(e.consume(t),$):63===t&&3===r?(e.consume(t),I):93===t&&5===r?(e.consume(t),z):!Tu(t)||6!==r&&7!==r?null===t||Tu(t)?A(t):(e.consume(t),O):e.check(Pu,$,A)(t)}function A(t){return e.exit("htmlFlowData"),E(t)}function E(t){return null===t?R(t):Tu(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),E):(e.enter("htmlFlowData"),O(t))}function T(t){return 45===t?(e.consume(t),I):O(t)}function N(t){return 47===t?(e.consume(t),i="",D):O(t)}function D(t){return 62===t&&$u.indexOf(i.toLowerCase())>-1?(e.consume(t),$):Au(t)&&i.length<8?(e.consume(t),i+=zu(t),D):O(t)}function z(t){return 93===t?(e.consume(t),I):O(t)}function I(t){return 62===t?(e.consume(t),$):O(t)}function $(t){return null===t||Tu(t)?(e.exit("htmlFlowData"),R(t)):(e.consume(t),$)}function R(n){return e.exit("htmlFlow"),t(n)}},resolveTo:function(e){var t=e.length;for(;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2));return e},concrete:!0},Pu={tokenize:function(e,t,n){return function(r){return e.exit("htmlFlowData"),e.enter("lineEndingBlank"),e.consume(r),e.exit("lineEndingBlank"),e.attempt(Ru,t,n)}},partial:!0};var _u=Fu,ju=ll,Bu=ul,Lu=Ta,Vu=Kc,Wu=Na,qu=za;var Hu={name:"htmlText",tokenize:function(e,t,n){var r,o,i,s,a=this;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),c};function c(t){return 33===t?(e.consume(t),l):47===t?(e.consume(t),x):63===t?(e.consume(t),w):ju(t)?(e.consume(t),M):n(t)}function l(t){return 45===t?(e.consume(t),u):91===t?(e.consume(t),o="CDATA[",i=0,m):ju(t)?(e.consume(t),b):n(t)}function u(t){return 45===t?(e.consume(t),f):n(t)}function f(t){return null===t||62===t?n(t):45===t?(e.consume(t),d):p(t)}function d(e){return null===e||62===e?n(e):p(e)}function p(t){return null===t?n(t):45===t?(e.consume(t),h):Lu(t)?(s=p,I(t)):(e.consume(t),p)}function h(t){return 45===t?(e.consume(t),R):p(t)}function m(t){return t===o.charCodeAt(i++)?(e.consume(t),i===o.length?v:m):n(t)}function v(t){return null===t?n(t):93===t?(e.consume(t),g):Lu(t)?(s=v,I(t)):(e.consume(t),v)}function g(t){return 93===t?(e.consume(t),y):v(t)}function y(t){return 62===t?R(t):93===t?(e.consume(t),y):v(t)}function b(t){return null===t||62===t?R(t):Lu(t)?(s=b,I(t)):(e.consume(t),b)}function w(t){return null===t?n(t):63===t?(e.consume(t),k):Lu(t)?(s=w,I(t)):(e.consume(t),w)}function k(e){return 62===e?R(e):w(e)}function x(t){return ju(t)?(e.consume(t),S):n(t)}function S(t){return 45===t||Bu(t)?(e.consume(t),S):C(t)}function C(t){return Lu(t)?(s=C,I(t)):Wu(t)?(e.consume(t),C):R(t)}function M(t){return 45===t||Bu(t)?(e.consume(t),M):47===t||62===t||Vu(t)?O(t):n(t)}function O(t){return 47===t?(e.consume(t),R):58===t||95===t||ju(t)?(e.consume(t),A):Lu(t)?(s=O,I(t)):Wu(t)?(e.consume(t),O):R(t)}function A(t){return 45===t||46===t||58===t||95===t||Bu(t)?(e.consume(t),A):E(t)}function E(t){return 61===t?(e.consume(t),T):Lu(t)?(s=E,I(t)):Wu(t)?(e.consume(t),E):O(t)}function T(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),r=t,N):Lu(t)?(s=T,I(t)):Wu(t)?(e.consume(t),T):(e.consume(t),r=void 0,z)}function N(t){return t===r?(e.consume(t),D):null===t?n(t):Lu(t)?(s=N,I(t)):(e.consume(t),N)}function D(e){return 62===e||47===e||Vu(e)?O(e):n(e)}function z(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):62===t||Vu(t)?O(t):(e.consume(t),z)}function I(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),qu(e,$,"linePrefix",a.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function $(t){return e.enter("htmlTextData"),s(t)}function R(r){return 62===r?(e.consume(r),e.exit("htmlTextData"),e.exit("htmlText"),t):n(r)}}},Ju=Kc,Ku=Ic,Uu=Xa,Gu=Ca,Qu=$c,Xu=Ya,Zu=Xl,Yu=eu,ef=au,tf=ou,nf={name:"labelEnd",tokenize:function(e,t,n){var r,o,i=this,s=i.events.length;for(;s--;)if(("labelImage"===i.events[s][1].type||"labelLink"===i.events[s][1].type)&&!i.events[s][1]._balanced){r=i.events[s][1];break}return function(t){if(!r)return n(t);return r._inactive?c(t):(o=i.parser.defined.indexOf(Gu(i.sliceSerialize({start:r.end,end:i.now()})))>-1,e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),a)};function a(n){return 40===n?e.attempt(rf,t,o?t:c)(n):91===n?e.attempt(of,t,o?e.attempt(sf,t,c):c)(n):o?t(n):c(n)}function c(e){return r._balanced=!0,n(e)}},resolveTo:function(e,t){var n,r,o,i,s,a,c,l=e.length,u=0;for(;l--;)if(i=e[l][1],s){if("link"===i.type||"labelLink"===i.type&&i._inactive)break;"enter"===e[l][0]&&"labelLink"===i.type&&(i._inactive=!0)}else if(a){if("enter"===e[l][0]&&("labelImage"===i.type||"labelLink"===i.type)&&!i._balanced&&(s=l,"labelLink"!==i.type)){u=2;break}}else"labelEnd"===i.type&&(a=l);return n={type:"labelLink"===e[s][1].type?"link":"image",start:Xu(e[s][1].start),end:Xu(e[e.length-1][1].end)},r={type:"label",start:Xu(e[s][1].start),end:Xu(e[a][1].end)},o={type:"labelText",start:Xu(e[s+u+2][1].end),end:Xu(e[a-2][1].start)},c=Ku(c=[["enter",n,t],["enter",r,t]],e.slice(s+1,s+u+3)),c=Ku(c,[["enter",o,t]]),c=Ku(c,Qu(t.parser.constructs.insideSpan.null,e.slice(s+u+4,a-3),t)),c=Ku(c,[["exit",o,t],e[a-2],e[a-1],["exit",r,t]]),c=Ku(c,e.slice(a+1)),c=Ku(c,[["exit",n,t]]),Uu(e,s,e.length,c),e},resolveAll:function(e){var t,n=-1;for(;++n<e.length;)(t=e[n][1])._used||"labelImage"!==t.type&&"labelLink"!==t.type&&"labelEnd"!==t.type||(e.splice(n+1,"labelImage"===t.type?4:2),t.type="data",n++);return e}},rf={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),tf(e,r)};function r(t){return 41===t?s(t):Zu(e,o,n,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(t)}function o(t){return Ju(t)?tf(e,i)(t):s(t)}function i(t){return 34===t||39===t||40===t?ef(e,tf(e,s),n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):s(t)}function s(r){return 41===r?(e.enter("resourceMarker"),e.consume(r),e.exit("resourceMarker"),e.exit("resource"),t):n(r)}}},of={tokenize:function(e,t,n){var r=this;return function(t){return Yu.call(r,e,o,n,"reference","referenceMarker","referenceString")(t)};function o(e){return r.parser.defined.indexOf(Gu(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))<0?n(e):t(e)}}},sf={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),r};function r(r){return 93===r?(e.enter("referenceMarker"),e.consume(r),e.exit("referenceMarker"),e.exit("reference"),t):n(r)}}};var af=nf;var cf={name:"labelStartImage",tokenize:function(e,t,n){var r=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),o};function o(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),i):n(t)}function i(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}},resolveAll:af.resolveAll};var lf={name:"labelStartLink",tokenize:function(e,t,n){var r=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),o};function o(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}},resolveAll:af.resolveAll},uf=za;var ff={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),uf(e,t,"linePrefix")}}},df=Ta,pf=Na,hf=za;var mf={name:"thematicBreak",tokenize:function(e,t,n){var r,o=0;return function(t){return e.enter("thematicBreak"),r=t,i(t)};function i(a){return a===r?(e.enter("thematicBreakSequence"),s(a)):pf(a)?hf(e,i,"whitespace")(a):o<3||null!==a&&!df(a)?n(a):(e.exit("thematicBreak"),t(a))}function s(t){return t===r?(e.consume(t),o++,s):(e.exit("thematicBreakSequence"),i(t))}}},vf=Ol,gf=Na,yf=Ga,bf=Ka,wf=za,kf=ja,xf=mf,Sf={name:"list",tokenize:function(e,t,n){var r=this,o=yf(r.events,"linePrefix"),i=0;return function(t){var o=r.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===o?!r.containerState.marker||t===r.containerState.marker:vf(t)){if(r.containerState.type||(r.containerState.type=o,e.enter(o,{_container:!0})),"listUnordered"===o)return e.enter("listItemPrefix"),42===t||45===t?e.check(xf,n,a)(t):a(t);if(!r.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),s(t)}return n(t)};function s(t){return vf(t)&&++i<10?(e.consume(t),s):(!r.interrupt||i<2)&&(r.containerState.marker?t===r.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),a(t)):n(t)}function a(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||t,e.check(kf,r.interrupt?n:c,e.attempt(Cf,u,l))}function c(e){return r.containerState.initialBlankLine=!0,o++,u(e)}function l(t){return gf(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),u):n(t)}function u(n){return r.containerState.size=o+bf(r.sliceStream(e.exit("listItemPrefix"))),t(n)}},continuation:{tokenize:function(e,t,n){var r=this;return r.containerState._closeFlow=void 0,e.check(kf,(function(n){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,wf(e,t,"listItemIndent",r.containerState.size+1)(n)}),(function(n){if(r.containerState.furtherBlankLines||!gf(n))return r.containerState.furtherBlankLines=r.containerState.initialBlankLine=void 0,o(n);return r.containerState.furtherBlankLines=r.containerState.initialBlankLine=void 0,e.attempt(Mf,t,o)(n)}));function o(o){return r.containerState._closeFlow=!0,r.interrupt=void 0,wf(e,e.attempt(Sf,t,n),"linePrefix",r.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)(o)}}},exit:function(e){e.exit(this.containerState.type)}},Cf={tokenize:function(e,t,n){var r=this;return wf(e,(function(e){return gf(e)||!yf(r.events,"listItemPrefixWhitespace")?n(e):t(e)}),"listItemPrefixWhitespace",r.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:5)},partial:!0},Mf={tokenize:function(e,t,n){var r=this;return wf(e,(function(e){return yf(r.events,"listItemIndent")===r.containerState.size?t(e):n(e)}),"listItemIndent",r.containerState.size+1)},partial:!0};var Of=Sf,Af=Ta,Ef=Ya,Tf=za;var Nf={name:"setextUnderline",tokenize:function(e,t,n){var r,o,i=this,s=i.events.length;for(;s--;)if("lineEnding"!==i.events[s][1].type&&"linePrefix"!==i.events[s][1].type&&"content"!==i.events[s][1].type){o="paragraph"===i.events[s][1].type;break}return function(t){if(!i.lazy&&(i.interrupt||o))return e.enter("setextHeadingLine"),e.enter("setextHeadingLineSequence"),r=t,a(t);return n(t)};function a(t){return t===r?(e.consume(t),a):(e.exit("setextHeadingLineSequence"),Tf(e,c,"lineSuffix")(t))}function c(r){return null===r||Af(r)?(e.exit("setextHeadingLine"),t(r)):n(r)}},resolveTo:function(e,t){var n,r,o,i,s=e.length;for(;s--;)if("enter"===e[s][0]){if("content"===e[s][1].type){n=s;break}"paragraph"===e[s][1].type&&(r=s)}else"content"===e[s][1].type&&e.splice(s,1),o||"definition"!==e[s][1].type||(o=s);i={type:"setextHeading",start:Ef(e[r][1].start),end:Ef(e[e.length-1][1].end)},e[r][1].type="setextHeadingText",o?(e.splice(r,0,["enter",i,t]),e.splice(o+1,0,["exit",e[n][1],t]),e[n][1].end=Ef(e[o][1].end)):e[n][1]=i;return e.push(["exit",i,t]),e}};Object.defineProperty(Jc,"__esModule",{value:!0});var Df={42:Of,43:Of,45:Of,48:Of,49:Of,50:Of,51:Of,52:Of,53:Of,54:Of,55:Of,56:Of,57:Of,62:kl},zf={91:yu},If={"-2":Hl,"-1":Hl,32:Hl},$f={35:Ou,42:mf,45:[Nf,mf],60:_u,61:Nf,95:mf,96:_l,126:_l},Rf={38:Il,92:Cl},Ff={"-5":ff,"-4":ff,"-3":ff,33:cf,38:Il,42:cl,60:[gl,Hu],91:lf,92:[wu,Cl],93:af,95:cl,96:Kl},Pf={null:[cl,vc.resolver]};Jc.contentInitial=zf,Jc.disable={null:[]},Jc.document=Df,Jc.flow=$f,Jc.flowInitial=If,Jc.insideSpan=Pf,Jc.string=Rf,Jc.text=Ff;var _f=Ea,jf=Fa,Bf=Ja,Lf=vc,Vf=Dc,Wf=Hc,qf=Mc,Hf=Jc;var Jf=/[\0\t\n\r]/g;var Kf=oc;var Uf=function(e,t,n){"string"!=typeof t&&(n=t,t=void 0);return function(e){var t=e||{},n=function(e,t){var n=-1;for(;++n<t.length;)id(e,t[n]);return e}({transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:l(oe),autolinkProtocol:T,autolinkEmail:T,atxHeading:l(ee),blockQuote:l(G),characterEscape:T,characterReference:T,codeFenced:l(Q),codeFencedFenceInfo:u,codeFencedFenceMeta:u,codeIndented:l(Q,u),codeText:l(X,u),codeTextData:T,data:T,codeFlowValue:T,definition:l(Z),definitionDestinationString:u,definitionLabelString:u,definitionTitleString:u,emphasis:l(Y),hardBreakEscape:l(te),hardBreakTrailing:l(te),htmlFlow:l(ne,u),htmlFlowData:T,htmlText:l(ne,u),htmlTextData:T,image:l(re),label:u,link:l(oe),listItem:l(se),listItemValue:v,listOrdered:l(ie,m),listUnordered:l(ie),paragraph:l(ae),reference:W,referenceString:u,resourceDestinationString:u,resourceTitleString:u,setextHeading:l(ee),strong:l(ce),thematicBreak:l(ue)},exit:{atxHeading:d(),atxHeadingSequence:M,autolink:d(),autolinkEmail:U,autolinkProtocol:K,blockQuote:d(),characterEscapeValue:N,characterReferenceMarkerHexadecimal:H,characterReferenceMarkerNumeric:H,characterReferenceValue:J,codeFenced:d(w),codeFencedFence:b,codeFencedFenceInfo:g,codeFencedFenceMeta:y,codeFlowValue:N,codeIndented:d(k),codeText:d(R),codeTextData:N,data:N,definition:d(),definitionDestinationString:C,definitionLabelString:x,definitionTitleString:S,emphasis:d(),hardBreakEscape:d(z),hardBreakTrailing:d(z),htmlFlow:d(I),htmlFlowData:N,htmlText:d($),htmlTextData:N,image:d(P),label:j,labelText:_,lineEnding:D,link:d(F),listItem:d(),listOrdered:d(),listUnordered:d(),paragraph:d(),referenceString:q,resourceDestinationString:B,resourceTitleString:L,resource:V,setextHeading:d(E),setextHeadingLineSequence:A,setextHeadingText:O,strong:d(),thematicBreak:d()}},t.mdastExtensions||[]),r={};return o;function o(e){for(var t,r={type:"root",children:[]},o=[],l=[],d=-1,m={stack:[r],tokenStack:o,config:n,enter:f,exit:p,buffer:u,resume:h,setData:s,getData:a};++d<e.length;)"listOrdered"!==e[d][1].type&&"listUnordered"!==e[d][1].type||("enter"===e[d][0]?l.push(d):d=i(e,l.pop(d),d));for(d=-1;++d<e.length;)t=n[e[d][0]],Xf.call(t,e[d][1].type)&&t[e[d][1].type].call(Qf({sliceSerialize:e[d][2].sliceSerialize},m),e[d][1]);if(o.length)throw new Error("Cannot close document, a token (`"+o[o.length-1].type+"`, "+od({start:o[o.length-1].start,end:o[o.length-1].end})+") is still open");for(r.position={start:c(e.length?e[0][1].start:{line:1,column:1,offset:0}),end:c(e.length?e[e.length-2][1].end:{line:1,column:1,offset:0})},d=-1;++d<n.transforms.length;)r=n.transforms[d](r)||r;return r}function i(e,t,n){for(var r,o,i,s,a,l,u,f=t-1,d=-1,p=!1;++f<=n;)if("listUnordered"===(a=e[f])[1].type||"listOrdered"===a[1].type||"blockQuote"===a[1].type?("enter"===a[0]?d++:d--,u=void 0):"lineEndingBlank"===a[1].type?"enter"===a[0]&&(!r||u||d||l||(l=f),u=void 0):"linePrefix"===a[1].type||"listItemValue"===a[1].type||"listItemMarker"===a[1].type||"listItemPrefix"===a[1].type||"listItemPrefixWhitespace"===a[1].type||(u=void 0),!d&&"enter"===a[0]&&"listItemPrefix"===a[1].type||-1===d&&"exit"===a[0]&&("listUnordered"===a[1].type||"listOrdered"===a[1].type)){if(r){for(o=f,i=void 0;o--;)if("lineEnding"===(s=e[o])[1].type||"lineEndingBlank"===s[1].type){if("exit"===s[0])continue;i&&(e[i][1].type="lineEndingBlank",p=!0),s[1].type="lineEnding",i=o}else if("linePrefix"!==s[1].type&&"blockQuotePrefix"!==s[1].type&&"blockQuotePrefixWhitespace"!==s[1].type&&"blockQuoteMarker"!==s[1].type&&"listItemIndent"!==s[1].type)break;l&&(!i||l<i)&&(r._spread=!0),r.end=c(i?e[i][1].start:a[1].end),e.splice(i||f,0,["exit",r,a[2]]),f++,n++}"listItemPrefix"===a[1].type&&(r={type:"listItem",_spread:!1,start:c(a[1].start)},e.splice(f,0,["enter",r,a[2]]),f++,n++,l=void 0,u=!0)}return e[t][1]._spread=p,n}function s(e,t){r[e]=t}function a(e){return r[e]}function c(e){return{line:e.line,column:e.column,offset:e.offset}}function l(e,t){return n;function n(n){f.call(this,e(n),n),t&&t.call(this,n)}}function u(){this.stack.push({type:"fragment",children:[]})}function f(e,t){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push(t),e.position={start:c(t.start)},e}function d(e){return t;function t(t){e&&e.call(this,t),p.call(this,t)}}function p(e){var t=this.stack.pop(),n=this.tokenStack.pop();if(!n)throw new Error("Cannot close `"+e.type+"` ("+od({start:e.start,end:e.end})+"): it’s not open");if(n.type!==e.type)throw new Error("Cannot close `"+e.type+"` ("+od({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+od({start:n.start,end:n.end})+") is open");return t.position.end=c(e.end),t}function h(){return Gf(this.stack.pop())}function m(){s("expectingFirstListItemValue",!0)}function v(e){a("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=parseInt(this.sliceSerialize(e),10),s("expectingFirstListItemValue"))}function g(){var e=this.resume();this.stack[this.stack.length-1].lang=e}function y(){var e=this.resume();this.stack[this.stack.length-1].meta=e}function b(){a("flowCodeInside")||(this.buffer(),s("flowCodeInside",!0))}function w(){var e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),s("flowCodeInside")}function k(){var e=this.resume();this.stack[this.stack.length-1].value=e}function x(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=Zf(this.sliceSerialize(e)).toLowerCase()}function S(){var e=this.resume();this.stack[this.stack.length-1].title=e}function C(){var e=this.resume();this.stack[this.stack.length-1].url=e}function M(e){this.stack[this.stack.length-1].depth||(this.stack[this.stack.length-1].depth=this.sliceSerialize(e).length)}function O(){s("setextHeadingSlurpLineEnding",!0)}function A(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).charCodeAt(0)?1:2}function E(){s("setextHeadingSlurpLineEnding")}function T(e){var t=this.stack[this.stack.length-1].children,n=t[t.length-1];n&&"text"===n.type||((n=le()).position={start:c(e.start)},this.stack[this.stack.length-1].children.push(n)),this.stack.push(n)}function N(e){var t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=c(e.end)}function D(e){var t=this.stack[this.stack.length-1];if(a("atHardBreak"))return t.children[t.children.length-1].position.end=c(e.end),void s("atHardBreak");!a("setextHeadingSlurpLineEnding")&&n.canContainEols.indexOf(t.type)>-1&&(T.call(this,e),N.call(this,e))}function z(){s("atHardBreak",!0)}function I(){var e=this.resume();this.stack[this.stack.length-1].value=e}function $(){var e=this.resume();this.stack[this.stack.length-1].value=e}function R(){var e=this.resume();this.stack[this.stack.length-1].value=e}function F(){var e=this.stack[this.stack.length-1];a("inReference")?(e.type+="Reference",e.referenceType=a("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),s("referenceType")}function P(){var e=this.stack[this.stack.length-1];a("inReference")?(e.type+="Reference",e.referenceType=a("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),s("referenceType")}function _(e){this.stack[this.stack.length-2].identifier=Zf(this.sliceSerialize(e)).toLowerCase()}function j(){var e=this.stack[this.stack.length-1],t=this.resume();this.stack[this.stack.length-1].label=t,s("inReference",!0),"link"===this.stack[this.stack.length-1].type?this.stack[this.stack.length-1].children=e.children:this.stack[this.stack.length-1].alt=t}function B(){var e=this.resume();this.stack[this.stack.length-1].url=e}function L(){var e=this.resume();this.stack[this.stack.length-1].title=e}function V(){s("inReference")}function W(){s("referenceType","collapsed")}function q(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=Zf(this.sliceSerialize(e)).toLowerCase(),s("referenceType","full")}function H(e){s("characterReferenceType",e.type)}function J(e){var t,n,r=this.sliceSerialize(e),o=a("characterReferenceType");o?(t=Yf(r,"characterReferenceMarkerNumeric"===o?10:16),s("characterReferenceType")):t=rd(r),(n=this.stack.pop()).value+=t,n.position.end=c(e.end)}function K(e){N.call(this,e),this.stack[this.stack.length-1].url=this.sliceSerialize(e)}function U(e){N.call(this,e),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)}function G(){return{type:"blockquote",children:[]}}function Q(){return{type:"code",lang:null,meta:null,value:""}}function X(){return{type:"inlineCode",value:""}}function Z(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Y(){return{type:"emphasis",children:[]}}function ee(){return{type:"heading",depth:void 0,children:[]}}function te(){return{type:"break"}}function ne(){return{type:"html",value:""}}function re(){return{type:"image",title:null,url:"",alt:null}}function oe(){return{type:"link",title:null,url:"",children:[]}}function ie(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}function se(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}}function ae(){return{type:"paragraph",children:[]}}function ce(){return{type:"strong",children:[]}}function le(){return{type:"text",value:""}}function ue(){return{type:"thematicBreak"}}}(n)(nd(ed(n).document().write(td()(e,t,!0))))},Gf=ba,Qf=xa,Xf=Sa,Zf=Ca,Yf=Aa,ed=function(e){var t={defined:[],constructs:Vf([Hf].concat(qf((e||{}).extensions))),content:n(_f),document:n(jf),flow:n(Bf),string:n(Lf.string),text:n(Lf.text)};return t;function n(e){return function(n){return Wf(t,e,n)}}},td=function(){var e,t=!0,n=1,r="";return function(o,i,s){var a,c,l,u,f,d=[];o=r+o.toString(i),l=0,r="",t&&(65279===o.charCodeAt(0)&&l++,t=void 0);for(;l<o.length;){if(Jf.lastIndex=l,a=Jf.exec(o),u=a?a.index:o.length,f=o.charCodeAt(u),!a){r=o.slice(l);break}if(10===f&&l===u&&e)d.push(-3),e=void 0;else if(e&&(d.push(-5),e=void 0),l<u&&(d.push(o.slice(l,u)),n+=u-l),0===f)d.push(65533),n++;else if(9===f)for(c=4*Math.ceil(n/4),d.push(-2);n++<c;)d.push(-1);else 10===f?(d.push(-4),n=1):(e=!0,n=1);l=u+1}s&&(e&&d.push(-5),r&&d.push(r),d.push(null));return d}},nd=function(e){for(;!Kf(e););return e},rd=Ml,od=Ds;function id(e,t){var n,r;for(n in t)r=Xf.call(e,n)?e[n]:e[n]={},"canContainEols"===n||"transforms"===n?e[n]=[].concat(r,t[n]):Object.assign(r,t[n])}var sd=function(e){var t=this;this.Parser=function(n){return ad(n,Object.assign({},t.data("settings"),e,{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}},ad=Uf;var cd=function(e,t){var n=t||{};function r(t){var n=r.invalid,o=r.handlers;return t&&ud.call(t,e)&&(n=ud.call(o,t[e])?o[t[e]]:r.unknown),(n||ld).apply(this,arguments)}return r.handlers=n.handlers||{},r.invalid=n.invalid,r.unknown=n.unknown,r},ld=Function.prototype,ud={}.hasOwnProperty;var fd=function e(t,n){var r,o=-1;if(n.extensions)for(;++o<n.extensions.length;)e(t,n.extensions[o]);for(r in n)"extensions"===r||("unsafe"===r||"join"===r?t[r]=t[r].concat(n[r]||[]):"handlers"===r?t[r]=Object.assign(t[r],n[r]||{}):t.options[r]=n[r]);return t};var dd,pd={},hd="",md=function(e,t){if("string"!=typeof e)throw new TypeError("expected a string");if(1===t)return e;if(2===t)return e+e;var n=e.length*t;if(dd!==e||void 0===dd)dd=e,hd="";else if(hd.length>=n)return hd.substr(0,n);for(;n>hd.length&&t>1;)1&t&&(hd+=e),t>>=1,e+=e;return hd=(hd+=e).substr(0,n)};
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var vd=function(e,t){var n,r=e.children||[],o=[],i=-1;for(;++i<r.length;)n=r[i],o.push(t.handle(n,e,t,{before:"\n",after:"\n"})),i+1<r.length&&o.push(s(n,r[i+1]));return o.join("");function s(n,r){for(var o,i=-1;++i<t.join.length&&!0!==(o=t.join[i](n,r,e,t))&&1!==o;){if("number"==typeof o)return gd("\n",1+Number(o));if(!1===o)return"\n\n\x3c!----\x3e\n\n"}return"\n\n"}},gd=md;var yd=function(e,t){var n,r=[],o=0,i=0;for(;n=bd.exec(e);)s(e.slice(o,n.index)),r.push(n[0]),o=n.index+n[0].length,i++;return s(e.slice(o)),r.join("");function s(e){r.push(t(e,i,!e))}},bd=/\r?\n|\r/g;var wd=function(e,t,n){var r=n.enter("blockquote"),o=xd(kd(e,n),Sd);return r(),o},kd=vd,xd=yd;function Sd(e,t,n){return">"+(n?"":" ")+e}var Cd=function(e,t){return Md(e,t.inConstruct,!0)&&!Md(e,t.notInConstruct)};function Md(e,t,n){var r;if(!t)return n;for("string"==typeof t&&(t=[t]),r=-1;++r<t.length;)if(-1!==e.indexOf(t[r]))return!0;return!1}var Od=function(e,t,n,r){var o=-1;for(;++o<n.unsafe.length;)if("\n"===n.unsafe[o].character&&Ad(n.stack,n.unsafe[o]))return/[ \t]/.test(r.before)?"":" ";return"\\\n"},Ad=Cd;var Ed=function(e,t){return!t.options.fences&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value)};var Td=function(e){var t,n;e._compiled||(t=e.before?"(?:"+e.before+")":"",n=e.after?"(?:"+e.after+")":"",e.atBreak&&(t="[\\r\\n][\\t ]*"+t),e._compiled=new RegExp((t?"("+t+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(n||""),"g"));return e._compiled};var Nd=function(e,t,n){var r,o,i,s,a,c,l,u,f=(n.before||"")+(t||"")+(n.after||""),d=[],p=[],h={},m=-1;for(;++m<e.unsafe.length;)if(s=e.unsafe[m],zd(e.stack,s))for(a=Dd(s);c=a.exec(f);)r="before"in s||s.atBreak,o="after"in s,i=c.index+(r?c[1].length:0),-1===d.indexOf(i)?(d.push(i),h[i]={before:r,after:o}):(h[i].before&&!r&&(h[i].before=!1),h[i].after&&!o&&(h[i].after=!1));d.sort(Id),l=n.before?n.before.length:0,u=f.length-(n.after?n.after.length:0),m=-1;for(;++m<d.length;)(i=d[m])<l||i>=u||i+1<u&&d[m+1]===i+1&&h[i].after&&!h[i+1].before&&!h[i+1].after||(l!==i&&p.push($d(f.slice(l,i),"\\")),l=i,!/[!-/:-@[-`{-~]/.test(f.charAt(i))||n.encode&&-1!==n.encode.indexOf(f.charAt(i))?(p.push("&#x"+f.charCodeAt(i).toString(16).toUpperCase()+";"),l++):p.push("\\"));return p.push($d(f.slice(l,u),n.after)),p.join("")},Dd=Td,zd=Cd;function Id(e,t){return e-t}function $d(e,t){for(var n,r=/\\(?=[!-/:-@[-`{-~])/g,o=[],i=[],s=-1,a=0,c=e+t;n=r.exec(c);)o.push(n.index);for(;++s<o.length;)a!==o[s]&&i.push(e.slice(a,o[s])),i.push("\\"),a=o[s];return i.push(e.slice(a)),i.join("")}var Rd=function(e,t,n){var r,o,i,s,a=jd(n),c=e.value||"",l="`"===a?"GraveAccent":"Tilde";_d(e,n)?(i=n.enter("codeIndented"),r=Bd(c,Vd)):(o=Fd(a,Math.max(Pd(c,a)+1,3)),i=n.enter("codeFenced"),r=o,e.lang&&(s=n.enter("codeFencedLang"+l),r+=Ld(n,e.lang,{before:"`",after:" ",encode:["`"]}),s()),e.lang&&e.meta&&(s=n.enter("codeFencedMeta"+l),r+=" "+Ld(n,e.meta,{before:" ",after:"\n",encode:["`"]}),s()),r+="\n",c&&(r+=c+"\n"),r+=o);return i(),r},Fd=md,Pd=function(e,t){var n,r,o=0,i=0;if("string"!=typeof t||1!==t.length)throw new Error("Expected character");e=String(e),r=e.indexOf(t),n=r;for(;-1!==r;)o++,r===n?o>i&&(i=o):o=1,n=r+1,r=e.indexOf(t,n);return i},_d=Ed,jd=function(e){var t=e.options.fence||"`";if("`"!==t&&"~"!==t)throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t},Bd=yd,Ld=Nd;function Vd(e,t,n){return(n?"":"    ")+e}var Wd=function(e){if(e.label||!e.identifier)return e.label||"";return e.identifier.replace(Hd,"$1").replace(Jd,Kd)},qd=Ml,Hd=/\\([!-/:-@[-`{-~])/g,Jd=/&(#(\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function Kd(e,t){return qd(t)||e}var Ud=function(e){var t=e.options.quote||'"';if('"'!==t&&"'"!==t)throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t};var Gd=function(e,t,n){var r=Xd(n),o='"'===r?"Quote":"Apostrophe",i=n.enter("definition"),s=n.enter("label"),a="["+Zd(n,Qd(e),{before:"[",after:"]"})+"]: ";s(),!e.url||/[ \t\r\n]/.test(e.url)?(s=n.enter("destinationLiteral"),a+="<"+Zd(n,e.url,{before:"<",after:">"})+">"):(s=n.enter("destinationRaw"),a+=Zd(n,e.url,{before:" ",after:" "}));s(),e.title&&(s=n.enter("title"+o),a+=" "+r+Zd(n,e.title,{before:r,after:r})+r,s());return i(),a},Qd=Wd,Xd=Ud,Zd=Nd;var Yd=function(e){var t=e.options.emphasis||"*";if("*"!==t&&"_"!==t)throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t};var ep=function(e,t,n){var r,o,i,s=e.children||[],a=[],c=-1,l=n.before;for(;++c<s.length;)i=s[c],c+1<s.length?((o=t.handle.handlers[s[c+1].type])&&o.peek&&(o=o.peek),r=o?o(s[c+1],e,t,{before:"",after:""}).charAt(0):""):r=n.after,a.length>0&&("\r"===l||"\n"===l)&&"html"===i.type&&(a[a.length-1]=a[a.length-1].replace(/(\r?\n|\r)$/," "),l=" "),a.push(t.handle(i,e,t,{before:l,after:r})),l=a[a.length-1].slice(-1);return a.join("")};var tp=op;op.peek=function(e,t,n){return n.options.emphasis||"*"};var np=Yd,rp=ep;function op(e,t,n){var r=np(n),o=n.enter("emphasis"),i=rp(e,n,{before:r,after:r});return o(),r+i+r}var ip=function(e,t){return t.options.setext&&(!e.depth||e.depth<3)&&sp(e)},sp=ba;var ap=function(e,t,n){var r,o,i,s,a=Math.max(Math.min(6,e.depth||1),1);if(lp(e,n))return r=n.enter("headingSetext"),o=n.enter("phrasing"),i=up(e,n,{before:"\n",after:"\n"}),o(),r(),i+"\n"+cp(1===a?"=":"-",i.length-(Math.max(i.lastIndexOf("\r"),i.lastIndexOf("\n"))+1));s=cp("#",a),r=n.enter("headingAtx"),o=n.enter("phrasing"),i=(i=up(e,n,{before:"# ",after:"\n"}))?s+" "+i:s,n.options.closeAtx&&(i+=" "+s);return o(),r(),i},cp=md,lp=ip,up=ep;var fp=dp;function dp(e){return e.value||""}dp.peek=function(){return"<"};var pp=vp;vp.peek=function(){return"!"};var hp=Ud,mp=Nd;function vp(e,t,n){var r=hp(n),o='"'===r?"Quote":"Apostrophe",i=n.enter("image"),s=n.enter("label"),a="!["+mp(n,e.alt,{before:"[",after:"]"})+"](";return s(),!e.url&&e.title||/[ \t\r\n]/.test(e.url)?(s=n.enter("destinationLiteral"),a+="<"+mp(n,e.url,{before:"<",after:">"})+">"):(s=n.enter("destinationRaw"),a+=mp(n,e.url,{before:"(",after:e.title?" ":")"})),s(),e.title&&(s=n.enter("title"+o),a+=" "+r+mp(n,e.title,{before:r,after:r})+r,s()),a+=")",i(),a}var gp=wp;wp.peek=function(){return"!"};var yp=Wd,bp=Nd;function wp(e,t,n){var r,o,i=e.referenceType,s=n.enter("imageReference"),a=n.enter("label"),c=bp(n,e.alt,{before:"[",after:"]"}),l="!["+c+"]";return a(),o=n.stack,n.stack=[],a=n.enter("reference"),r=bp(n,yp(e),{before:"[",after:"]"}),a(),n.stack=o,s(),"full"!==i&&c&&c===r?"shortcut"!==i&&(l+="[]"):l+="["+r+"]",l}var kp=Sp;Sp.peek=function(){return"`"};var xp=Td;function Sp(e,t,n){for(var r,o,i,s,a=e.value||"",c="`",l=-1;new RegExp("(^|[^`])"+c+"([^`]|$)").test(a);)c+="`";for(/[^ \r\n]/.test(a)&&(/[ \r\n`]/.test(a.charAt(0))||/[ \r\n`]/.test(a.charAt(a.length-1)))&&(a=" "+a+" ");++l<n.unsafe.length;)if((r=n.unsafe[l]).atBreak)for(o=xp(r);i=o.exec(a);)s=i.index,10===a.charCodeAt(s)&&13===a.charCodeAt(s-1)&&s--,a=a.slice(0,s)+" "+a.slice(i.index+1);return c+a+c}var Cp=function(e,t){var n=Mp(e);return!t.options.resourceLink&&e.url&&!e.title&&e.children&&1===e.children.length&&"text"===e.children[0].type&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url)},Mp=ba;var Op=Dp;Dp.peek=function(e,t,n){return Ep(e,n)?"<":"["};var Ap=Ud,Ep=Cp,Tp=ep,Np=Nd;function Dp(e,t,n){var r,o,i,s,a=Ap(n),c='"'===a?"Quote":"Apostrophe";return Ep(e,n)?(s=n.stack,n.stack=[],r=n.enter("autolink"),i="<"+Tp(e,n,{before:"<",after:">"})+">",r(),n.stack=s,i):(r=n.enter("link"),o=n.enter("label"),i="["+Tp(e,n,{before:"[",after:"]"})+"](",o(),!e.url&&e.title||/[ \t\r\n]/.test(e.url)?(o=n.enter("destinationLiteral"),i+="<"+Np(n,e.url,{before:"<",after:">"})+">"):(o=n.enter("destinationRaw"),i+=Np(n,e.url,{before:"(",after:e.title?" ":")"})),o(),e.title&&(o=n.enter("title"+c),i+=" "+a+Np(n,e.title,{before:a,after:a})+a,o()),i+=")",r(),i)}var zp=Fp;Fp.peek=function(){return"["};var Ip=Wd,$p=ep,Rp=Nd;function Fp(e,t,n){var r,o,i=e.referenceType,s=n.enter("linkReference"),a=n.enter("label"),c=$p(e,n,{before:"[",after:"]"}),l="["+c+"]";return a(),o=n.stack,n.stack=[],a=n.enter("reference"),r=Rp(n,Ip(e),{before:"[",after:"]"}),a(),n.stack=o,s(),"full"!==i&&c&&c===r?"shortcut"!==i&&(l+="[]"):l+="["+r+"]",l}var Pp=function(e,t,n){var r=n.enter("list"),o=_p(e,n);return r(),o},_p=vd;var jp=function(e,t,n){var r,o,i,s=Lp(n),a=Vp(n);t&&t.ordered&&(s=(t.start>-1?t.start:1)+(!1===n.options.incrementListMarker?0:t.children.indexOf(e))+".");r=s.length+1,("tab"===a||"mixed"===a&&(t&&t.spread||e.spread))&&(r=4*Math.ceil(r/4));return i=n.enter("listItem"),o=qp(Wp(e,n),(function(e,t,n){if(t)return(n?"":Bp(" ",r))+e;return(n?s:s+Bp(" ",r-s.length))+e})),i(),o},Bp=md,Lp=function(e){var t=e.options.bullet||"*";if("*"!==t&&"+"!==t&&"-"!==t)throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t},Vp=function(e){var t=e.options.listItemIndent||"tab";if(1===t||"1"===t)return"one";if("tab"!==t&&"one"!==t&&"mixed"!==t)throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t},Wp=vd,qp=yd;var Hp=function(e,t,n){var r=n.enter("paragraph"),o=n.enter("phrasing"),i=Jp(e,n,{before:"\n",after:"\n"});return o(),r(),i},Jp=ep;var Kp=function(e,t,n){return Up(e,n)},Up=vd;var Gp=function(e){var t=e.options.strong||"*";if("*"!==t&&"_"!==t)throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t};var Qp=Yp;Yp.peek=function(e,t,n){return n.options.strong||"*"};var Xp=Gp,Zp=ep;function Yp(e,t,n){var r=Xp(n),o=n.enter("strong"),i=Zp(e,n,{before:r,after:r});return o(),r+r+i+r+r}var eh=function(e,t,n,r){return th(n,e.value,r)},th=Nd;var nh=function(e,t,n){var r=rh(ih(n)+(n.options.ruleSpaces?" ":""),oh(n));return n.options.ruleSpaces?r.slice(0,-1):r},rh=md,oh=function(e){var t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t},ih=function(e){var t=e.options.rule||"*";if("*"!==t&&"-"!==t&&"_"!==t)throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t};pd.blockquote=wd,pd.break=Od,pd.code=Rd,pd.definition=Gd,pd.emphasis=tp,pd.hardBreak=Od,pd.heading=ap,pd.html=fp,pd.image=pp,pd.imageReference=gp,pd.inlineCode=kp,pd.link=Op,pd.linkReference=zp,pd.list=Pp,pd.listItem=jp,pd.paragraph=Hp,pd.root=Kp,pd.strong=Qp,pd.text=eh,pd.thematicBreak=nh;var sh=[function(e,t,n,r){if("list"===t.type&&t.type===e.type&&Boolean(e.ordered)===Boolean(t.ordered)||"code"===t.type&&ah(t,r)&&("list"===e.type||e.type===t.type&&ah(e,r)))return!1;if("boolean"==typeof n.spread){if("paragraph"===e.type&&(e.type===t.type||"definition"===t.type||"heading"===t.type&&ch(t,r)))return;return n.spread?1:0}}],ah=Ed,ch=ip;var lh=function(e,t){var n,r=t||{},o={enter:function(e){return o.stack.push(e),t;function t(){o.stack.pop()}},stack:[],unsafe:[],join:[],handlers:{},options:{}};fh(o,{unsafe:hh,join:ph,handlers:dh}),fh(o,r),o.options.tightDefinitions&&(o.join=[gh].concat(o.join));o.handle=uh("type",{invalid:mh,unknown:vh,handlers:o.handlers}),(n=o.handle(e,null,o,{before:"\n",after:"\n"}))&&10!==n.charCodeAt(n.length-1)&&13!==n.charCodeAt(n.length-1)&&(n+="\n");return n},uh=cd,fh=fd,dh=pd,ph=sh,hh=[{character:"\t",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:"\n",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing"},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:"(?:[\r\n]|$)"},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing"},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*"},{character:"*",inConstruct:"phrasing"},{atBreak:!0,character:"+"},{atBreak:!0,character:"-"},{atBreak:!0,before:"\\d+",character:".",after:"(?:[ \t\r\n]|$)"},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing"},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:["phrasing","label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{before:"[^A-Za-z]",character:"_",inConstruct:"phrasing"},{character:"_",after:"[^A-Za-z]",inConstruct:"phrasing"},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent","phrasing"]},{atBreak:!0,character:"~"}];function mh(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function vh(e){throw new Error("Cannot handle unknown node `"+e.type+"`")}function gh(e,t){if("definition"===e.type&&e.type===t.type)return 0}var yh=function(e){var t=this;this.Compiler=function(n){return bh(n,Object.assign({},t.data("settings"),e,{extensions:t.data("toMarkdownExtensions")||[]}))}},bh=lh;var wh=sd,kh=yh,xh=la().use(wh).use(kh).freeze();const Sh=$("ConfigReady"),Ch=O([],"prosePlugins"),Mh=e=>()=>t=>y(void 0,void 0,void 0,(function*(){yield t.wait(Dm);const n="function"==typeof e?[e(t)]:[e];t.update(Ch,(e=>e.concat(n.flat())))})),Oh=O([],"remarkPlugins"),Ah=e=>()=>t=>{t.update(Oh,(t=>t.concat([e].flat())))},Eh=$("InitReady"),Th=O([],"initTimer"),Nh=O({},"editor"),Dh=O(xh(),"remark"),zh=$("schemaReady"),Ih=O({},"schema"),$h=O([],"nodes"),Rh=O([],"marks"),Fh=O([],"schemaTimer"),Ph=e=>(e.inject(Ih).inject($h).inject(Rh).inject(Fh,[Eh]).record(zh),e=>y(void 0,void 0,void 0,(function*(){yield e.waitTimers(Fh);const t=e=>Object.fromEntries(e.map((({id:e,schema:t})=>[e,t]))),n=t(e.get($h)),r=t(e.get(Rh));e.set(Ih,new _e({nodes:n,marks:r})),e.done(zh)}))),_h=O((()=>null),"parser"),jh=O([],"parserTimer"),Bh=$("ParserReady"),Lh=e=>(e.inject(_h).inject(jh,[zh]).record(Bh),e=>y(void 0,void 0,void 0,(function*(){yield e.waitTimers(jh);const t=e.get($h),n=e.get(Rh),r=e.get(Dh),o=e.get(Ih),i=[...t.map((e=>Object.assign(Object.assign({},e),{is:"node"}))),...n.map((e=>Object.assign(Object.assign({},e),{is:"mark"})))],s=Object.fromEntries(i.map((({id:e,parser:t,is:n})=>[e,Object.assign(Object.assign({},t),{is:n,key:e})])));e.set(_h,hs(o,s,r)),e.done(Bh)}))),Vh=(e,t,n,r={})=>{const o={type:e,children:t,props:r,value:n,push:(...e)=>((e,t,...n)=>{e.children||(e.children=[]),e.children.push(t,...n)})(o,...e),pop:()=>(e=>{var t;return null===(t=e.children)||void 0===t?void 0:t.pop()})(o)};return o},{size:Wh,push:qh,open:Hh,close:Jh}=F(),Kh=e=>(t,n,r)=>Hh(e)(Vh(t,[],n,r)),Uh=e=>(t,n,r,o)=>{const i=(e=>{const t=Object.assign(Object.assign({},e.props),{type:e.type});return e.children&&(t.children=e.children),e.value&&(t.value=e.value),t})(Vh(t,n,r,o));return qh(e)(i),i},Gh=e=>()=>{const t=Jh(e);return Uh(e)(t.type,t.children,t.value,t.props)},Qh=e=>(t,n,r,o)=>{t.isInSet(e.marks)||(e.marks=t.addToSet(e.marks),Kh(e)(n,r,o))},Xh=e=>t=>t.isInSet(e.marks)?(e.marks=t.type.removeFromSet(e.marks),Gh(e)()):null,Zh=e=>()=>{let t=null;do{t=Gh(e)()}while(Wh(e));return t};var Yh,em,tm,nm,rm;class om{constructor(e,t,n){this.stack=e,this.schema=t,this.specMap=n,Yh.add(this),this.toString=e=>e.stringify(this.stack.build()),this.next=e=>{return t=e,Object.prototype.hasOwnProperty.call(t,"size")?(e.forEach((e=>{b(this,Yh,"m",rm).call(this,e)})),this):(b(this,Yh,"m",rm).call(this,e),this);var t},this.addNode=(...e)=>(this.stack.addNode(...e),this),this.openNode=(...e)=>(this.stack.openNode(...e),this),this.closeNode=(...e)=>(this.stack.closeNode(...e),this),this.withMark=(...e)=>(this.stack.openMark(...e),this)}run(e){return this.next(e),this}}Yh=new WeakSet,em=function(e){const t=Object.entries(this.specMap).map((([e,t])=>Object.assign({key:e},t))).find((t=>t.match(e)));if(!t)throw(e=>new Error(`Cannot match target serializer for node: ${x(e)}.`))(e.type);return t},tm=function(e){const{runner:t}=b(this,Yh,"m",em).call(this,e);t(this,e)},nm=function(e,t){const{runner:n}=b(this,Yh,"m",em).call(this,e);return n(this,e,t)},rm=function(e){const{marks:t}=e;t.every((t=>!b(this,Yh,"m",nm).call(this,t,e)))&&b(this,Yh,"m",tm).call(this,e),t.forEach((e=>this.stack.closeMark(e)))};const im=(e,t,n)=>r=>{const o=new om((()=>{const e={marks:[],elements:[]};return{build:Zh(e),openMark:Qh(e),closeMark:Xh(e),openNode:Kh(e),addNode:Uh(e),closeNode:Gh(e)}})(),e,t);return o.run(r),o.toString(n)},sm=O((()=>""),"serializer"),am=O([],"serializerTimer"),cm=$("SerializerReady"),lm=e=>(e.inject(sm).inject(am,[zh]).record(cm),e=>y(void 0,void 0,void 0,(function*(){yield e.waitTimers(am);const t=e.get($h),n=e.get(Rh),r=e.get(Dh),o=e.get(Ih),i=[...t,...n],s=Object.fromEntries(i.map((e=>[e.id,e.serializer])));e.set(sm,im(o,s,r)),e.done(cm)}))),um=O("","defaultValue"),fm=O({},"editorState"),dm=O({},"stateOptions"),pm=O([],"editorStateTimer"),hm=$("EditorStateReady"),mm=(e,t,n)=>{if("string"==typeof e)return t(e);if("html"===e.type)return Be.fromSchema(n).parse(e.dom);if("json"===e.type)return me.fromJSON(n,e.value);throw new Error(`Doc type error, unsupported type: ${x(e)}`)},vm=e=>(e.inject(um).inject(fm).inject(dm).inject(pm,[Ui,qi,Bh,cm]).record(hm),e=>y(void 0,void 0,void 0,(function*(){yield e.waitTimers(pm);const t=e.get(Ih),n=e.get(_h),r=e.get(Vi),o=e.get(Ji),i=e.get(dm),s=e.get(Ch),a=e.get(um),c=mm(a,n,t),l=Xt.create(Object.assign({schema:t,doc:c,plugins:[...s,...o,Bn(kn),Sn({rules:r})]},i));e.set(fm,l),e.done(hm)}))),gm=O({},"nodeView"),ym=O([],"nodeViewTimer"),bm=$("NodeViewReady"),wm=e=>(e.inject(gm).inject(ym,[zh]).record(bm),e=>y(void 0,void 0,void 0,(function*(){yield e.waitTimers(ym);const t=e.get($h),n=e.get(Rh),r=e.get(Ih),o=(e,t)=>e.map((({id:e,view:n})=>[R(e,r,t),{view:n,id:e}])).map((([e,{id:t,view:n}])=>e&&n?[t,(...e)=>n(...e)]:void 0)).filter((e=>!!e)),i=o(t,!0),s=o(n,!1),a=Object.fromEntries([...i,...s]);e.set(gm,a),e.done(bm)}))),km=O({},"editorView"),xm=O({},"editorViewOptions"),Sm=O(document.body,"root"),Cm=O([],"editorViewTimer"),Mm=$("EditorViewReady"),Om=e=>(e.inject(Sm,document.body).inject(km).inject(xm).inject(Cm,[hm,bm]).record(Mm),e=>y(void 0,void 0,void 0,(function*(){yield e.waitTimers(Cm);const t=e.get(fm),n=e.get(xm),r=e.get(gm),o=e.get(Sm),i=o?(e=>{const t=document.createElement("div");return t.className="milkdown",e.appendChild(t),t})(o):void 0,s=new Ti(i,Object.assign({state:t,nodeViews:r},n));var a;(a=s.dom).classList.add("editor"),a.setAttribute("role","textbox"),e.set(km,s),e.done(Mm)}))),Am=(e,t)=>[e,t],Em=O({},"commands"),Tm=()=>O((()=>()=>!1),"cmdKey"),Nm=O([],"commandsTimer"),Dm=$("KeymapReady"),zm=e=>{const t=M(),n={create:(e,n)=>e(t.sliceMap,n),get:e=>t.getSlice(e).get(),call:()=>{throw new Error("You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized")}};return e.inject(Em,n).inject(Nm,[zh]).record(Dm),e=>y(void 0,void 0,void 0,(function*(){yield e.waitTimers(Nm);const t=e.get($h),n=e.get(Rh),r=e.get(Ih),o=(e,t)=>e.map((e=>[R(e.id,r,t),e.commands])).map((([e,t])=>e&&(null==t?void 0:t(e,r)))).filter((e=>!!e)).flat(),i=[...o(t,!0),...o(n,!1)],s=e.get(Em);i.forEach((([e,t])=>{s.create(e,t)})),e.done(Dm),yield e.wait(Mm),e.update(Em,(t=>Object.assign(Object.assign({},t),{call:(t,n)=>{const r=s.get(t)(n),o=e.get(km);return r(o.state,o.dispatch,o)}})))}))},Im=e=>()=>t=>{const n="function"==typeof e?e(t):e;t.update(Rh,(e=>e.concat(n)))},$m=e=>()=>t=>{const n="function"==typeof e?e(t):e;t.update($h,(e=>e.concat(n)))};var Rm=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),Fm="-ms-",Pm="-moz-",_m="-webkit-",jm=Math.abs,Bm=String.fromCharCode;function Lm(e){return e.trim()}function Vm(e,t,n){return e.replace(t,n)}function Wm(e,t){return e.indexOf(t)}function qm(e,t){return 0|e.charCodeAt(t)}function Hm(e,t,n){return e.slice(t,n)}function Jm(e){return e.length}function Km(e){return e.length}function Um(e,t){return t.push(e),e}var Gm=1,Qm=1,Xm=0,Zm=0,Ym=0,ev="";function tv(e,t,n,r,o,i,s){return{value:e,root:t,parent:n,type:r,props:o,children:i,line:Gm,column:Qm,length:s,return:""}}function nv(e,t,n){return tv(e,t.root,t.parent,n,t.props,t.children,0)}function rv(){return Ym=Zm<Xm?qm(ev,Zm++):0,Qm++,10===Ym&&(Qm=1,Gm++),Ym}function ov(){return qm(ev,Zm)}function iv(){return Zm}function sv(e,t){return Hm(ev,e,t)}function av(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function cv(e){return Gm=Qm=1,Xm=Jm(ev=e),Zm=0,[]}function lv(e){return ev="",e}function uv(e){return Lm(sv(Zm-1,pv(91===e?e+2:40===e?e+1:e)))}function fv(e){for(;(Ym=ov())&&Ym<33;)rv();return av(e)>2||av(Ym)>3?"":" "}function dv(e,t){for(;--t&&rv()&&!(Ym<48||Ym>102||Ym>57&&Ym<65||Ym>70&&Ym<97););return sv(e,iv()+(t<6&&32==ov()&&32==rv()))}function pv(e){for(;rv();)switch(Ym){case e:return Zm;case 34:case 39:return pv(34===e||39===e?e:Ym);case 40:41===e&&pv(e);break;case 92:rv()}return Zm}function hv(e,t){for(;rv()&&e+Ym!==57&&(e+Ym!==84||47!==ov()););return"/*"+sv(t,Zm-1)+"*"+Bm(47===e?e:rv())}function mv(e){for(;!av(ov());)rv();return sv(e,Zm)}function vv(e){return lv(gv("",null,null,null,[""],e=cv(e),0,[0],e))}function gv(e,t,n,r,o,i,s,a,c){for(var l=0,u=0,f=s,d=0,p=0,h=0,m=1,v=1,g=1,y=0,b="",w=o,k=i,x=r,S=b;v;)switch(h=y,y=rv()){case 34:case 39:case 91:case 40:S+=uv(y);break;case 9:case 10:case 13:case 32:S+=fv(h);break;case 92:S+=dv(iv()-1,7);continue;case 47:switch(ov()){case 42:case 47:Um(bv(hv(rv(),iv()),t,n),c);break;default:S+="/"}break;case 123*m:a[l++]=Jm(S)*g;case 125*m:case 59:case 0:switch(y){case 0:case 125:v=0;case 59+u:p>0&&Jm(S)-f&&Um(p>32?wv(S+";",r,n,f-1):wv(Vm(S," ","")+";",r,n,f-2),c);break;case 59:S+=";";default:if(Um(x=yv(S,t,n,l,u,o,a,b,w=[],k=[],f),i),123===y)if(0===u)gv(S,t,x,x,w,i,f,a,k);else switch(d){case 100:case 109:case 115:gv(e,x,x,r&&Um(yv(e,x,x,0,0,o,a,b,o,w=[],f),k),o,k,f,a,r?w:k);break;default:gv(S,x,x,x,[""],k,f,a,k)}}l=u=p=0,m=g=1,b=S="",f=s;break;case 58:f=1+Jm(S),p=h;default:if(m<1)if(123==y)--m;else if(125==y&&0==m++&&125==(Ym=Zm>0?qm(ev,--Zm):0,Qm--,10===Ym&&(Qm=1,Gm--),Ym))continue;switch(S+=Bm(y),y*m){case 38:g=u>0?1:(S+="\f",-1);break;case 44:a[l++]=(Jm(S)-1)*g,g=1;break;case 64:45===ov()&&(S+=uv(rv())),d=ov(),u=Jm(b=S+=mv(iv())),y++;break;case 45:45===h&&2==Jm(S)&&(m=0)}}return i}function yv(e,t,n,r,o,i,s,a,c,l,u){for(var f=o-1,d=0===o?i:[""],p=Km(d),h=0,m=0,v=0;h<r;++h)for(var g=0,y=Hm(e,f+1,f=jm(m=s[h])),b=e;g<p;++g)(b=Lm(m>0?d[g]+" "+y:Vm(y,/&\f/g,d[g])))&&(c[v++]=b);return tv(e,t,n,0===o?"rule":a,c,l,u)}function bv(e,t,n){return tv(e,t,n,"comm",Bm(Ym),Hm(e,2,-2),0)}function wv(e,t,n,r){return tv(e,t,n,"decl",Hm(e,0,r),Hm(e,r+1,-1),r)}function kv(e,t){switch(function(e,t){return(((t<<2^qm(e,0))<<2^qm(e,1))<<2^qm(e,2))<<2^qm(e,3)}(e,t)){case 5103:return _m+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return _m+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return _m+e+Pm+e+Fm+e+e;case 6828:case 4268:return _m+e+Fm+e+e;case 6165:return _m+e+Fm+"flex-"+e+e;case 5187:return _m+e+Vm(e,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+e;case 5443:return _m+e+Fm+"flex-item-"+Vm(e,/flex-|-self/,"")+e;case 4675:return _m+e+Fm+"flex-line-pack"+Vm(e,/align-content|flex-|-self/,"")+e;case 5548:return _m+e+Fm+Vm(e,"shrink","negative")+e;case 5292:return _m+e+Fm+Vm(e,"basis","preferred-size")+e;case 6060:return _m+"box-"+Vm(e,"-grow","")+_m+e+Fm+Vm(e,"grow","positive")+e;case 4554:return _m+Vm(e,/([^-])(transform)/g,"$1-webkit-$2")+e;case 6187:return Vm(Vm(Vm(e,/(zoom-|grab)/,_m+"$1"),/(image-set)/,_m+"$1"),e,"")+e;case 5495:case 3959:return Vm(e,/(image-set\([^]*)/,_m+"$1$`$1");case 4968:return Vm(Vm(e,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+_m+e+e;case 4095:case 3583:case 4068:case 2532:return Vm(e,/(.+)-inline(.+)/,_m+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Jm(e)-1-t>6)switch(qm(e,t+1)){case 109:if(45!==qm(e,t+4))break;case 102:return Vm(e,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1"+Pm+(108==qm(e,t+3)?"$3":"$2-$3"))+e;case 115:return~Wm(e,"stretch")?kv(Vm(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==qm(e,t+1))break;case 6444:switch(qm(e,Jm(e)-3-(~Wm(e,"!important")&&10))){case 107:return Vm(e,":",":"+_m)+e;case 101:return Vm(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+_m+(45===qm(e,14)?"inline-":"")+"box$3$1"+_m+"$2$3$1"+Fm+"$2box$3")+e}break;case 5936:switch(qm(e,t+11)){case 114:return _m+e+Fm+Vm(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return _m+e+Fm+Vm(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return _m+e+Fm+Vm(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return _m+e+Fm+e+e}return e}function xv(e,t){for(var n="",r=Km(e),o=0;o<r;o++)n+=t(e[o],o,e,t)||"";return n}function Sv(e,t,n,r){switch(e.type){case"@import":case"decl":return e.return=e.return||e.value;case"comm":return"";case"rule":e.value=e.props.join(",")}return Jm(n=xv(e.children,r))?e.return=e.value+"{"+n+"}":""}function Cv(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var Mv=function(e,t,n){for(var r=0,o=0;r=o,o=ov(),38===r&&12===o&&(t[n]=1),!av(o);)rv();return sv(e,Zm)},Ov=function(e,t){return lv(function(e,t){var n=-1,r=44;do{switch(av(r)){case 0:38===r&&12===ov()&&(t[n]=1),e[n]+=Mv(Zm-1,t,n);break;case 2:e[n]+=uv(r);break;case 4:if(44===r){e[++n]=58===ov()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=Bm(r)}}while(r=rv());return e}(cv(e),t))},Av=new WeakMap,Ev=function(e){if("rule"===e.type&&e.parent&&e.length){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Av.get(n))&&!r){Av.set(e,!0);for(var o=[],i=Ov(t,o),s=n.props,a=0,c=0;a<i.length;a++)for(var l=0;l<s.length;l++,c++)e.props[c]=o[a]?i[a].replace(/&\f/g,s[l]):s[l]+" "+i[a]}}},Tv=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}},Nv=[function(e,t,n,r){if(!e.return)switch(e.type){case"decl":e.return=kv(e.value,e.length);break;case"@keyframes":return xv([nv(Vm(e.value,"@","@"+_m),e,"")],r);case"rule":if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return xv([nv(Vm(t,/:(read-\w+)/,":-moz-$1"),e,"")],r);case"::placeholder":return xv([nv(Vm(t,/:(plac\w+)/,":-webkit-input-$1"),e,""),nv(Vm(t,/:(plac\w+)/,":-moz-$1"),e,""),nv(Vm(t,/:(plac\w+)/,Fm+"input-$1"),e,"")],r)}return""}))}}],Dv=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r,o,i=e.stylisPlugins||Nv,s={},a=[];r=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)s[t[n]]=!0;a.push(e)}));var c,l,u,f,d=[Sv,(f=function(e){c.insert(e)},function(e){e.root||(e=e.return)&&f(e)})],p=(l=[Ev,Tv].concat(i,d),u=Km(l),function(e,t,n,r){for(var o="",i=0;i<u;i++)o+=l[i](e,t,n,r)||"";return o});o=function(e,t,n,r){c=n,xv(vv(e?e+"{"+t.styles+"}":t.styles),p),r&&(h.inserted[t.name]=!0)};var h={key:t,sheet:new Rm({key:t,container:r,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend}),nonce:e.nonce,inserted:s,registered:{},insert:o};return h.sheet.hydrate(a),h};var zv={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Iv=/[A-Z]|^ms/g,$v=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Rv=function(e){return 45===e.charCodeAt(1)},Fv=function(e){return null!=e&&"boolean"!=typeof e},Pv=Cv((function(e){return Rv(e)?e:e.replace(Iv,"-$&").toLowerCase()})),_v=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace($v,(function(e,t,n){return Bv={name:t,styles:n,next:Bv},t}))}return 1===zv[e]||Rv(e)||"number"!=typeof t||0===t?t:t+"px"};function jv(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return Bv={name:n.name,styles:n.styles,next:Bv},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)Bv={name:r.name,styles:r.styles,next:Bv},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=jv(e,t,n[o])+";";else for(var i in n){var s=n[i];if("object"!=typeof s)null!=t&&void 0!==t[s]?r+=i+"{"+t[s]+"}":Fv(s)&&(r+=Pv(i)+":"+_v(i,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=t&&void 0!==t[s[0]]){var a=jv(e,t,s);switch(i){case"animation":case"animationName":r+=Pv(i)+":"+a+";";break;default:r+=i+"{"+a+"}"}}else for(var c=0;c<s.length;c++)Fv(s[c])&&(r+=Pv(i)+":"+_v(i,s[c])+";")}return r}(e,t,n);case"function":if(void 0!==e){var o=Bv,i=n(e);return Bv=o,jv(e,t,i)}}if(null==t)return n;var s=t[n];return void 0!==s?s:n}var Bv,Lv=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Vv=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,o="";Bv=void 0;var i=e[0];null==i||void 0===i.raw?(r=!1,o+=jv(n,t,i)):o+=i[0];for(var s=1;s<e.length;s++)o+=jv(n,t,e[s]),r&&(o+=i[s]);Lv.lastIndex=0;for(var a,c="";null!==(a=Lv.exec(o));)c+="-"+a[1];return{name:function(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(o)+c,styles:o,next:Bv}};function Wv(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r}var qv=function(e,t,n){var r=e.key+"-"+t.name;if(!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles),void 0===e.inserted[t.name]){var o=t;do{e.insert(t===o?"."+r:"",o,e.sheet,!0),o=o.next}while(void 0!==o)}};function Hv(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function Jv(e,t,n){var r=[],o=Wv(e,r,n);return r.length<2?n:o+t(r)}var Kv=function e(t){for(var n="",r=0;r<t.length;r++){var o=t[r];if(null!=o){var i=void 0;switch(typeof o){case"boolean":break;case"object":if(Array.isArray(o))i=e(o);else for(var s in i="",o)o[s]&&s&&(i&&(i+=" "),i+=s);break;default:i=o}i&&(n&&(n+=" "),n+=i)}}return n},Uv=function(e){var t=Dv(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=Vv(n,t.registered,void 0);return qv(t,o,!1),t.key+"-"+o.name};return{css:n,cx:function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return Jv(t.registered,n,Kv(r))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=Vv(n,t.registered);Hv(t,o)},keyframes:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=Vv(n,t.registered),i="animation-"+o.name;return Hv(t,{name:o.name,styles:"@keyframes "+i+"{"+o.styles+"}"}),i},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:Wv.bind(null,t.registered),merge:Jv.bind(null,t.registered,n)}}({key:"css"}),Gv=Uv.injectGlobal,Qv=Uv.css;const Xv={typography:"",code:""},Zv={radius:"0",lineWidth:"1px"},Yv={scrollbar:()=>"",shadow:()=>"",border:()=>""},eg={icon:e=>{const t=document.createElement("div");return t.className="milkdown-icon",t.textContent=e,t}},tg=e=>{if(e.startsWith("rgba"))return e.slice(5,-1).split(",").slice(0,-1).join(",");if(e.startsWith("rgb"))return e.slice(4,-1);const t=(e=>{const t=e.slice(1).replace(/^([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,n,r)=>t+t+n+n+r+r)),[n,r,o,i]=t.match(/^([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i)||[];return n?[r,o,i].map((e=>parseInt(e,16))):null})(e);return t?t.join(", "):(console.warn(`Invalid hex: ${e}`),e)},ng=(e={},t=(e=>`${e}`))=>Object.entries(e).map((([e,n])=>`--${e}: ${t(n)};`)).join("\n"),rg=(e={})=>ng(e,tg),og=e=>{const{color:t={},font:n,size:r={}}=e,{light:o,dark:i}=t,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(t,["light","dark"]);Gv`
        :root {
            ${rg(o)};
            ${rg(s)};
            ${ng(n,(e=>e.join(", ")))};
            ${ng(r)};
        }
        [data-theme='dark'] {
            ${rg(i)}
        }
    `},ig=O({mixin:{},font:{},size:{},slots:{},palette:()=>""},"ThemeTool"),sg=e=>t=>(t.inject(ig),t=>{og(e);const n=(e=>{const{font:t,size:n={},mixin:r,slots:o,global:i}=e,s=(e={})=>Object.fromEntries(Object.keys(e).map((e=>[e,`var(--${e})`]))),a={palette:(e,t=1)=>`rgba(var(--${e}), ${t})`,size:Object.assign(Object.assign({},Zv),s(n)),font:Object.assign(Object.assign({},Xv),s(t))},c=Object.assign(Object.assign({},Yv),null==r?void 0:r(a)),l=Object.assign(Object.assign({},a),{mixin:c}),u=Object.assign(Object.assign({},eg),null==o?void 0:o(l)),f=Object.assign(Object.assign({},l),{slots:u});return null==i||i(f),f})(e);t.set(ig,n)});var ag,cg,lg,ug,fg,dg,pg;class hg{constructor(){ag.set(this,M()),cg.set(this,I()),lg.set(this,new Set),ug.set(this,[]),fg.set(this,new D(b(this,ag,"f"),b(this,cg,"f"))),dg.set(this,new z(b(this,ag,"f"),b(this,cg,"f"))),pg.set(this,(()=>{const e=[Ph,Lh,lm,wm,zm,Gi,Hi,vm,Om],t=(n=e=>y(this,void 0,void 0,(function*(){yield Promise.all(b(this,ug,"f").map((t=>t(e))))})),e=>(e.record(Sh),e=>y(void 0,void 0,void 0,(function*(){yield n(e),e.done(Sh)}))));var n,r;this.use(e.concat((r=this,e=>(e.inject(Nh,r).inject(Ch).inject(Oh).inject(Dh,xh()).inject(Th,[Sh]).record(Eh),e=>y(void 0,void 0,void 0,(function*(){yield e.waitTimers(Th);const t=e.get(Dh),n=e.get(Oh).reduce(((e,t)=>e.use(t)),t);e.set(Dh,n),e.done(Eh)}))))).concat(t))})),this.use=e=>([e].flat().forEach((e=>{b(this,lg,"f").add(e(b(this,dg,"f")))})),this),this.config=e=>(b(this,ug,"f").push(e),this),this.create=()=>y(this,void 0,void 0,(function*(){return b(this,pg,"f").call(this),yield Promise.all([...b(this,lg,"f")].map((e=>e(b(this,fg,"f"))))),this})),this.action=e=>e(b(this,fg,"f"))}static make(){return new hg}}ag=new WeakMap,cg=new WeakMap,lg=new WeakMap,ug=new WeakMap,fg=new WeakMap,dg=new WeakMap,pg=new WeakMap;const mg=e=>Object.prototype.hasOwnProperty.call(e,"origin");class vg extends Array{configure(e,t){const n=this.findIndex((t=>mg(t)&&t.origin===e));return n<0||this.splice(n,1,e(t)),this}replace(e,t){const n=this.findIndex((t=>mg(t)&&t.origin===e));return n<0||this.splice(n,1,t),this}remove(e){const t=this.findIndex((t=>mg(t)&&t.origin===e));return t<0||this.splice(t,1),this}headless(){return this.filter(mg).forEach((e=>{this.configure(e.origin,{headless:!0})})),this}static create(e){return new vg(...e)}}const gg=(e,t,n)=>{try{const o=t.get(ig),i={ctx:t,getClassName:(r=null==n?void 0:n.className,(e,...t)=>{var n;const o=null!==(n=null==r?void 0:r(e))&&void 0!==n?n:t;return Array.isArray(o)?o.filter((e=>e)).join(" "):o}),getStyle:e=>(null==n?void 0:n.headless)?"":e(o)};return e(n,i)}catch(o){throw C()}var r},yg=(e,t,n)=>{var r;return null!==(r=null==n?void 0:n[e])&&void 0!==r?r:t},bg=(e,t,n)=>e.flatMap(((e,t)=>([n,{defaultKey:r,commandKey:o,args:i}])=>[yg(n,r,t)].flat().map((t=>[t,e(o)(i)])))(t,n)),wg=(e,t)=>e?(n,r,o)=>Object.fromEntries(bg((e=>Object.entries(e).filter((e=>!!e)))(e),o,t)):()=>({}),kg=e=>{const t=n=>{const r=Im((t=>{var o;const i=gg(e,t,n),s=null!==(o=null==n?void 0:n.view)&&void 0!==o?o:i.view,a=wg(i.shortcuts,null==n?void 0:n.keymap);return r.id=i.id,Object.assign(Object.assign({},i),{view:s,keymap:a})}));return r.origin=t,r};return t},xg=e=>{const t=n=>{const r=$m((t=>{var o;const i=gg(e,t,n),s=null!==(o=null==n?void 0:n.view)&&void 0!==o?o:i.view,a=wg(i.shortcuts,null==n?void 0:n.keymap);return r.id=i.id,Object.assign(Object.assign({},i),{view:s,keymap:a})}));return r.origin=t,r};return t},Sg=(e,t,n)=>({commandKey:e,defaultKey:t,args:n}),Cg={HardBreak:"HardBreak",Blockquote:"Blockquote",BulletList:"BulletList",OrderedList:"OrderedList",CodeFence:"CodeFence",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",Text:"Text",CodeInline:"CodeInline",Em:"Em",Bold:"Bold",NextListItem:"NextListItem",SinkListItem:"SinkListItem",LiftListItem:"LiftListItem"},Mg=Tm(),Og=kg(((e,t)=>{const n=t.getStyle((({palette:e,size:t,font:n})=>Qv`
                background-color: ${e("neutral")};
                color: ${e("background")};
                border-radius: ${t.radius};
                font-weight: 500;
                font-family: ${n.code};
                padding: 0 0.2rem;
            `));return{id:"code_inline",schema:{excludes:"_",parseDOM:[{tag:"code"}],toDOM:e=>["code",{class:t.getClassName(e.attrs,"code-inline",n)}]},parser:{match:e=>"inlineCode"===e.type,runner:(e,t,n)=>{e.openMark(n),e.addText(t.value),e.closeMark(n)}},serializer:{match:e=>"code_inline"===e.type.name,runner:(e,t,n)=>(e.addNode("inlineCode",void 0,n.text||""),!0)},inputRules:e=>[Fi(/(?:^|[^`])(`([^`]+)`)$/,e)],commands:e=>[Am(Mg,(()=>hn(e)))],shortcuts:{[Cg.CodeInline]:Sg(Mg,"Mod-e")}}})),Ag=Tm(),Eg=kg(((e,t)=>({id:"em",schema:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>"italic"===e}],toDOM:e=>["em",{class:t.getClassName(e.attrs,"em")}]},parser:{match:e=>"emphasis"===e.type,runner:(e,t,n)=>{e.openMark(n),e.next(t.children),e.closeMark(n)}},serializer:{match:e=>"em"===e.type.name,runner:(e,t)=>{e.withMark(t,"emphasis")}},inputRules:e=>[Fi(/(?:^|[^_])(_([^_]+)_)$/,e),Fi(/(?:^|[^*])(\*([^*]+)\*)$/,e)],commands:e=>[Am(Ag,(()=>hn(e)))],shortcuts:{[Cg.Em]:Sg(Ag,"Mod-i")}}))),Tg=Tm(),Ng=Tm(),Dg=kg(((e,t)=>{const n=t.getStyle((e=>{const t=e.palette("line");return Qv`
            color: ${e.palette("secondary")};
            cursor: pointer;
            transition: all 0.4s ease-in-out;
            font-weight: 500;
            &:hover {
                background-color: ${t};
                box-shadow: 0 0.2rem ${t}, 0 -0.2rem ${t};
            }
        `}));return{id:"link",schema:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM:e=>["a",Object.assign(Object.assign({},e.attrs),{class:t.getClassName(e.attrs,"link",n)})]},parser:{match:e=>"link"===e.type,runner:(e,t,n)=>{const r=t.url,o=t.title;e.openMark(n,{href:r,title:o}),e.next(t.children),e.closeMark(n)}},serializer:{match:e=>"link"===e.type.name,runner:(e,t)=>{e.withMark(t,"link",void 0,{title:t.attrs.title,url:t.attrs.href})}},commands:e=>[Am(Tg,((t="")=>hn(e,{href:t}))),Am(Ng,((t="")=>(n,r)=>{if(!r)return!1;const{marks:o}=n.schema;let i,s=-1;const{selection:a}=n;if(n.doc.nodesBetween(a.from,a.to,((e,t)=>{if(o.link.isInSet(e.marks))return i=e,s=t,!1})),!i)return!1;const c=i.marks.find((({type:t})=>t===e));if(!c)return!1;const l=s,u=s+i.nodeSize,{tr:f}=n,d=o.link.create(Object.assign(Object.assign({},c.attrs),{href:t}));return r(f.removeMark(l,u,c).addMark(l,u,d).setSelection(new _t(f.selection.$anchor)).scrollIntoView()),!0}))],inputRules:(e,t)=>[new xn(/\[(?<text>.*?)]\((?<href>.*?)(?=“|\))"?(?<title>[^"]+)?"?\)/,((n,r,o,i)=>{const[s,a="",c,l]=r,{tr:u}=n;if(s){const n=a||"link";u.replaceWith(o,i,t.text(n)).addMark(o,n.length+o,e.create({title:l,href:c}))}return u}))]}})),zg=Tm(),Ig=kg(((e,t)=>{const n=t.getStyle((()=>Qv`
                font-weight: 600;
            `));return{id:"strong",schema:{parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-style",getAttrs:e=>"bold"===e}],toDOM:e=>["strong",{class:t.getClassName(e.attrs,"strong",n)}]},parser:{match:e=>"strong"===e.type,runner:(e,t,n)=>{e.openMark(n),e.next(t.children),e.closeMark(n)}},serializer:{match:e=>"strong"===e.type.name,runner:(e,t)=>{e.withMark(t,"strong")}},inputRules:e=>[Fi(/(?:__)([^_]+)(?:__)$/,e),Fi(/(?:\*\*)([^*]+)(?:\*\*)$/,e)],commands:e=>[Am(zg,(()=>hn(e)))],shortcuts:{[Cg.Bold]:Sg(zg,"Mod-b")}}})),$g=[Og(),Eg(),Ig(),Dg()],Rg="blockquote",Fg=Tm(),Pg=xg(((e,t)=>{const n=t.getStyle((e=>Qv`
                padding-left: 1.875rem;
                line-height: 1.75rem;
                border-left: 4px solid ${e.palette("primary")};
                * {
                    font-size: 1rem;
                    line-height: 1.5rem;
                }
            `));return{id:Rg,schema:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:e=>["blockquote",{class:t.getClassName(e.attrs,Rg,n)},0]},parser:{match:({type:e})=>e===Rg,runner:(e,t,n)=>{e.openNode(n).next(t.children).closeNode()}},serializer:{match:e=>e.type.name===Rg,runner:(e,t)=>{e.openNode("blockquote").next(t.content).closeNode()}},inputRules:e=>[Mn(/^\s*>\s$/,e)],commands:e=>[Am(Fg,(()=>dn(e)))],shortcuts:{[Cg.Blockquote]:Sg(Fg,"Mod-Shift-b")}}})),_g=Tm(),jg=xg(((e,t)=>({id:"bullet_list",schema:{content:"listItem+",group:"block",parseDOM:[{tag:"ul"}],toDOM:e=>["ul",{class:t.getClassName(e.attrs,"bullet-list")},0]},parser:{match:({type:e,ordered:t})=>"list"===e&&!t,runner:(e,t,n)=>{e.openNode(n).next(t.children).closeNode()}},serializer:{match:e=>"bullet_list"===e.type.name,runner:(e,t)=>{e.openNode("list",void 0,{ordered:!1}).next(t.content).closeNode()}},inputRules:e=>[Mn(/^\s*([-+*])\s$/,e)],commands:e=>[Am(_g,(()=>dn(e)))],shortcuts:{[Cg.BulletList]:Sg(_g,"Mod-Shift-8")}}))),Bg=["","javascript","typescript","bash","sql","json","html","css","c","cpp","java","ruby","python","go","rust","markdown"],Lg=/^```(?<language>[a-z]*)? $/,Vg=Tm(),Wg=xg(((e,t)=>{const n=t.getStyle((({palette:e,mixin:t,size:n,font:r})=>{const{shadow:o,scrollbar:i,border:s}=t,{lineWidth:a,radius:c}=n;return Qv`
            background-color: ${e("background")};
            color: ${e("neutral")};
            font-size: 0.85rem;
            padding: 1.2rem 0.4rem 1.4rem;
            border-radius: ${c};
            font-family: ${r.typography};

            * {
                margin: 0;
            }

            .code-fence_select-wrapper {
                position: relative;
            }

            .code-fence_value {
                width: 10.25rem;
                box-sizing: border-box;
                border-radius: ${n.radius};
                margin: 0 1.2rem 1.2rem;
                ${s()};
                ${o()};
                cursor: pointer;
                background-color: ${e("surface")};
                position: relative;
                display: flex;
                color: ${e("neutral",.87)};
                letter-spacing: 0.5px;
                height: 2.625rem;
                align-items: center;

                & > *:last-child {
                    width: 2.625rem;
                    height: 100%;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    color: ${e("solid",.87)};
                    border-left: ${a} solid ${e("line")};

                    text-align: center;
                    transition: all 0.2s ease-in-out;
                    &:hover {
                        background: ${e("background")};
                        color: ${e("primary")};
                    }
                }

                > span:first-child {
                    padding-left: 1rem;
                    flex: 1;
                    font-weight: 500;
                }
            }

            .code-fence_select-option {
                list-style: none;
                line-height: 2rem;
                padding-left: 1rem;
                cursor: pointer;
                :hover {
                    background: ${e("secondary",.12)};
                    color: ${e("primary")};
                }
            }

            .code-fence_select {
                &[data-fold='true'] {
                    display: none;
                }

                font-weight: 500;
                position: absolute;
                z-index: 1;
                top: 2.625rem;
                box-sizing: border-box;
                left: 1.2rem;
                padding: 0.5rem 0;
                max-height: 16.75rem;
                width: 10.25rem;
                ${s()};
                ${o()};
                background-color: ${e("surface")};
                border-top: none;
                overflow-y: auto;
                display: flex;
                flex-direction: column;

                ${i("y")}
            }

            code {
                line-height: 1.5;
                font-family: ${r.code};
            }

            pre {
                font-family: ${r.code};
                margin: 0 1.2rem !important;
                overflow-x: scroll;
                white-space: pre !important;

                padding-bottom: 1.4rem;

                ${i("x")}
            }
        `}));return{id:"fence",schema:{content:"text*",group:"block",marks:"",defining:!0,code:!0,attrs:{language:{default:""},fold:{default:!0}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error("Parse DOM error.");return{language:e.dataset.language}}}],toDOM:e=>["div",{"data-language":e.attrs.language,class:t.getClassName(e.attrs,"code-fence",n)},["pre",["code",{spellCheck:"false"},0]]]},parser:{match:({type:e})=>"code"===e,runner:(e,t,n)=>{const r=t.lang,o=t.value;e.openNode(n,{language:r}),e.addText(o),e.closeNode()}},serializer:{match:e=>"fence"===e.type.name,runner:(e,t)=>{var n;e.addNode("code",void 0,(null===(n=t.content.firstChild)||void 0===n?void 0:n.text)||"",{lang:t.attrs.language})}},inputRules:e=>[On(Lg,e,(([e,t])=>{if(e)return{language:t}}))],commands:e=>[Am(Vg,(()=>pn(e)))],shortcuts:{[Cg.CodeFence]:Sg(Vg,"Mod-Alt-c")},view:(r,o,i)=>{const s=document.createElement("div"),a=document.createElement("div"),c=document.createElement("ul"),l=document.createElement("pre"),u=document.createElement("code"),f=document.createElement("div");f.className="code-fence_value";const d=document.createElement("span");return f.appendChild(d),f.appendChild(t.ctx.get(ig).slots.icon("downArrow")),c.className="code-fence_select",c.addEventListener("mousedown",(e=>{if(e.preventDefault(),e.stopPropagation(),!o.editable)return;const t=e.target;if(!(t instanceof HTMLLIElement))return;const{tr:n}=o.state;o.dispatch(n.setNodeMarkup(i(),void 0,{fold:!0,language:t.dataset.value}))})),f.addEventListener("mousedown",(e=>{if(e.preventDefault(),e.stopPropagation(),!o.editable)return;const{tr:t}=o.state;o.dispatch(t.setNodeMarkup(i(),void 0,{fold:!1,language:s.dataset.language}))})),document.addEventListener("mousedown",(()=>{if(!o.editable||"true"===c.dataset.fold)return;const{tr:e}=o.state;o.dispatch(e.setNodeMarkup(i(),void 0,{fold:!0,language:s.dataset.language}))})),((null==e?void 0:e.languageList)||Bg).forEach((e=>{const t=document.createElement("li");t.className="code-fence_select-option",t.innerText=e||"--",c.appendChild(t),t.setAttribute("data-value",e)})),u.spellcheck=!1,a.className="code-fence_select-wrapper",a.contentEditable="false",a.append(f),a.append(c),l.append(u),s.append(a,l),s.setAttribute("class",t.getClassName(r.attrs,"code-fence",n)),s.setAttribute("data-language",r.attrs.language),d.innerText=r.attrs.language||"--",c.setAttribute("data-fold",r.attrs.fold?"true":"false"),{dom:s,contentDOM:u,update:e=>{if("fence"!==e.type.name)return!1;const t=e.attrs.language;return s.dataset.language=t,d.innerText=t||"--",c.setAttribute("data-fold",e.attrs.fold?"true":"false"),!0}}}}})),qg=xg((()=>({id:"doc",schema:{content:"block+"},parser:{match:({type:e})=>"root"===e,runner:(e,t,n)=>{e.injectRoot(t,n)}},serializer:{match:e=>"doc"===e.type.name,runner:(e,t)=>{e.openNode("root"),e.next(t.content)}}}))),Hg="hardbreak",Jg=Tm(),Kg=xg(((e,t)=>({id:Hg,schema:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:e=>["br",{class:t.getClassName(e.attrs,Hg)}]},parser:{match:({type:e})=>"break"===e,runner:(e,t,n)=>{e.addNode(n)}},serializer:{match:e=>e.type.name===Hg,runner:e=>{e.addNode("break")}},commands:e=>[Am(Jg,(()=>(t,n)=>(null==n||n(t.tr.replaceSelectionWith(e.create()).scrollIntoView()),!0)))],shortcuts:{[Cg.HardBreak]:Sg(Jg,"Shift-Enter")}}))),Ug=Array(6).fill(0).map(((e,t)=>t+1)),Gg=Tm(),Qg=xg(((e,t)=>{const n="heading",r={1:Qv`
            font-size: 3rem;
            line-height: 3.5rem;
        `,2:Qv`
            font-size: 2.125rem;
            line-height: 2.25rem;
        `,3:Qv`
            font-size: 1.5rem;
            line-height: 1.5rem;
        `};return{id:n,schema:{content:"inline*",group:"block",attrs:{level:{default:1},id:{default:""}},parseDOM:Ug.map((e=>({tag:`h${e}`,attrs:{level:e}}))),toDOM:n=>{return[`h${n.attrs.level}`,{class:t.getClassName(n.attrs,`heading h${n.attrs.level}`,(o=n.attrs.level,(null==e?void 0:e.headless)?null:Qv`
                  ${r[o]||""}
                  margin: 2.5rem 0 !important;
                  font-weight: 400;
              `))},0];var o}},parser:{match:({type:e})=>e===n,runner:(e,t,n)=>{const r=t.depth;e.openNode(n,{level:r}),e.next(t.children),e.closeNode()}},serializer:{match:e=>e.type.name===n,runner:(e,t)=>{e.openNode("heading",void 0,{depth:t.attrs.level}),e.next(t.content),e.closeNode()}},inputRules:e=>Ug.map((t=>On(new RegExp(`^(#{1,${t}})\\s$`),e,(()=>({level:t}))))),commands:e=>[Am(Gg,((t=1)=>pn(e,{level:t})))],shortcuts:{[Cg.H1]:Sg(Gg,"Mod-Alt-1",1),[Cg.H2]:Sg(Gg,"Mod-Alt-2",2),[Cg.H3]:Sg(Gg,"Mod-Alt-3",3),[Cg.H4]:Sg(Gg,"Mod-Alt-4",4),[Cg.H5]:Sg(Gg,"Mod-Alt-5",5),[Cg.H6]:Sg(Gg,"Mod-Alt-6",6)}}})),Xg=Tm(),Zg=xg(((e,t)=>{const n=t.getStyle((e=>Qv`
            height: ${e.size.lineWidth};
            background-color: ${e.palette("line")};
            border-width: 0;
        `));return{id:"hr",schema:{group:"block",parseDOM:[{tag:"hr"}],toDOM:e=>["hr",{class:t.getClassName(e.attrs,"hr",n)}]},parser:{match:({type:e})=>"thematicBreak"===e,runner:(e,t,n)=>{e.addNode(n)}},serializer:{match:e=>"hr"===e.type.name,runner:e=>{e.addNode("thematicBreak")}},inputRules:e=>[new xn(/^(?:---|___\s|\*\*\*\s)$/,((t,n,r,o)=>{const{tr:i}=t;return n[0]&&i.replaceWith(r,o,e.create({})),i}))],commands:(e,t)=>[Am(Xg,(()=>(n,r)=>{if(!r)return!0;const{tr:o,selection:i}=n,s=i.from,a=e.create();if(!a)return!0;const c=o.replaceSelectionWith(a).insert(s,t.node("paragraph")),l=Rt.findFrom(c.doc.resolve(s),1,!0);return!l||(r(c.setSelection(l).scrollIntoView()),!0)}))]}})),Yg=Tm(),ey=Tm(),ty="image",ny=xg(((e,t)=>{var n,r;const o=Object.assign({loading:"Loading...",empty:"Add an Image",failed:"Image loads failed"},null!==(n=null==e?void 0:e.placeholder)&&void 0!==n?n:{}),i=null!==(r=null==e?void 0:e.isBlock)&&void 0!==r&&r,s=t.getStyle((e=>Qv`
                display: inline-block;
                position: relative;
                text-align: center;
                font-size: 0;
                vertical-align: text-bottom;
                ${i?"\n                width: 100%;\n                margin: 0 auto;\n                ":""}
                img {
                    max-width: 100%;
                    height: auto;
                    object-fit: contain;
                    margin: 0 2px;
                }
                .icon,
                .placeholder {
                    display: none;
                }

                &.system {
                    width: 100%;
                    padding: 0 2rem;

                    img {
                        width: 0;
                        height: 0;
                        display: none;
                    }

                    .icon,
                    .placeholder {
                        display: inline;
                    }

                    box-sizing: border-box;
                    height: 3rem;
                    background-color: ${e.palette("background")};
                    border-radius: ${e.size.radius};
                    display: inline-flex;
                    gap: 2rem;
                    justify-content: flex-start;
                    align-items: center;
                    .placeholder {
                        margin: 0;
                        line-height: 1;
                        &::before {
                            content: '';
                            font-size: 0.875rem;
                            color: ${e.palette("neutral",.6)};
                        }
                    }
                }

                &.loading {
                    .placeholder {
                        &::before {
                            content: '${o.loading}';
                        }
                    }
                }

                &.empty {
                    .placeholder {
                        &::before {
                            content: '${o.empty}';
                        }
                    }
                }

                &.failed {
                    .placeholder {
                        &::before {
                            content: '${o.failed}';
                        }
                    }
                }
            `)),a=t.getStyle((()=>Qv`
                display: inline-block;
                margin: 0 auto;
                object-fit: contain;
                width: 100%;
                position: relative;
                height: auto;
                text-align: center;
            `));return{id:ty,schema:{inline:!0,group:"inline",draggable:!0,marks:"",atom:!0,defining:!0,isolating:!0,attrs:{src:{default:""},alt:{default:null},title:{default:null},failed:{default:!1},loading:{default:!0},width:{default:0}},parseDOM:[{tag:"img[src]",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{failed:e.classList.contains("failed"),loading:e.classList.contains("loading"),src:e.getAttribute("src")||"",alt:e.getAttribute("alt"),title:e.getAttribute("title")||e.getAttribute("alt"),width:e.getAttribute("width")||0}}}],toDOM:e=>["img",Object.assign(Object.assign({},e.attrs),{class:t.getClassName(e.attrs,ty,e.attrs.failed?"failed":"",e.attrs.loading?"loading":"",a)})]},parser:{match:({type:e})=>e===ty,runner:(e,t,n)=>{const r=t.url,o=t.alt,i=t.title;e.addNode(n,{src:r,alt:o,title:i})}},serializer:{match:e=>e.type.name===ty,runner:(e,t)=>{e.addNode("image",void 0,void 0,{title:t.attrs.title,url:t.attrs.src,alt:t.attrs.alt})}},commands:e=>[Am(ey,((t="")=>(n,r)=>{if(!r)return!0;const{tr:o}=n,i=e.create({src:t});if(!i)return!0;return r(o.replaceSelectionWith(i).scrollIntoView()),!0})),Am(Yg,((t="")=>(n,r)=>{const o=Li(n.selection,e);if(!o)return!1;const{tr:i}=n;return null==r||r(i.setNodeMarkup(o.pos,void 0,Object.assign(Object.assign({},o.node.attrs),{loading:!0,src:t})).scrollIntoView()),!0}))],inputRules:e=>[new xn(/!\[(?<alt>.*?)]\((?<filename>.*?)\s*(?="|\))"?(?<title>[^"]+)?"?\)/,((t,n,r,o)=>{const[i,s,a="",c]=n,{tr:l}=t;return i&&l.replaceWith(r,o,e.create({src:a,alt:s,title:c})),l}))],view:(e,n,r)=>{const o=e.type,i=t.ctx.get(ig).slots.icon,a=document.createElement("span");a.className=t.getClassName(e.attrs,ty,s),a.contentEditable="false";const c=document.createElement("img");c.contentEditable="true",a.append(c);let l=i("image");const u=document.createElement("span");u.classList.add("placeholder"),a.append(l,u);const f=e=>{const t=i(e);a.replaceChild(t,l),l=t},d=t=>{a.classList.add("system","loading"),f("loading");const i=document.createElement("img");i.src=t,i.onerror=()=>{const{tr:i}=n.state,s=i.setNodeMarkup(r(),o,Object.assign(Object.assign({},e.attrs),{src:t,loading:!1,failed:!0}));n.dispatch(s)},i.onload=()=>{const{tr:s}=n.state,a=s.setNodeMarkup(r(),o,Object.assign(Object.assign({},e.attrs),{width:i.width,src:t,loading:!1,failed:!1}));n.dispatch(a)}},{src:p,loading:h,title:m,alt:v,width:g}=e.attrs;return c.src=p,c.title=m||v,c.alt=v,c.width=g,0===p.length?(a.classList.add("system","empty"),f("image")):h&&d(p),{dom:a,update:e=>{if(e.type.name!==ty)return!1;const{src:t,alt:n,title:r,loading:o,failed:i,width:s}=e.attrs;return c.src=t,c.alt=n,c.title=r||n,c.width=s,o?(d(t),!0):i?(a.classList.remove("loading","empty"),a.classList.add("system","failed"),f("brokenImage"),!0):t.length>0?(a.classList.remove("system","empty","loading"),!0):(a.classList.add("system","empty"),f("image"),!0)}}}}}));function ry(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,s=r.node;if(s&&s.isBlock||o.depth<2||!o.sameParent(i))return!1;var a=o.node(-1);if(a.type!=e)return!1;if(0==o.parent.content.size&&o.node(-1).childCount==o.indexAfter(-1)){if(2==o.depth||o.node(-3).type!=e||o.index(-2)!=o.node(-2).childCount-1)return!1;if(n){for(var c=L.empty,l=o.index(-1)?1:o.index(-2)?2:3,u=o.depth-l;u>=o.depth-3;u--)c=L.from(o.node(u).copy(c));var f=o.indexAfter(-1)<o.node(-2).childCount?1:o.indexAfter(-2)<o.node(-3).childCount?2:3;c=c.append(L.from(e.createAndFill()));var d=o.before(o.depth-(l-1)),p=t.tr.replace(d,o.after(-f),new U(c,4-l,0)),h=-1;p.doc.nodesBetween(d,p.doc.content.size,(function(e,t){if(h>-1)return!1;e.isTextblock&&0==e.content.size&&(h=t+1)})),h>-1&&p.setSelection(t.selection.constructor.near(p.doc.resolve(h))),n(p.scrollIntoView())}return!0}var m=i.pos==o.end()?a.contentMatchAt(0).defaultType:null,v=t.tr.delete(o.pos,i.pos),g=m&&[null,{type:m}];return!!bt(v.doc,o.pos,2,g)&&(n&&n(v.split(o.pos,2,g).scrollIntoView()),!0)}}function oy(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,s=o.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==e}));return!!s&&(!n||(o.node(s.depth-1).type==e?function(e,t,n,r){var o=e.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(o.step(new pt(i-1,s,i,s,new U(L.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new de(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth));return t(o.lift(r,vt(r)).scrollIntoView()),!0}(t,n,e,s):function(e,t,n){for(var r=e.tr,o=n.parent,i=n.end,s=n.endIndex-1,a=n.startIndex;s>a;s--)i-=o.child(s).nodeSize,r.delete(i-1,i+1);var c=r.doc.resolve(n.start),l=c.nodeAfter;if(r.mapping.map(n.end)!=n.start+c.nodeAfter.nodeSize)return!1;var u=0==n.startIndex,f=n.endIndex==o.childCount,d=c.node(-1),p=c.index(-1);if(!d.canReplace(p+(u?0:1),p+1,l.content.append(f?L.empty:L.from(o))))return!1;var h=c.pos,m=h+l.nodeSize;return r.step(new pt(h-(u?1:0),m+(f?1:0),h+1,m-1,new U((u?L.empty:L.from(o.copy(L.empty))).append(f?L.empty:L.from(o.copy(L.empty))),u?0:1,f?0:1),u?0:1)),t(r.scrollIntoView()),!0}(t,n,s)))}}function iy(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,s=o.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==e}));if(!s)return!1;var a=s.startIndex;if(0==a)return!1;var c=s.parent,l=c.child(a-1);if(l.type!=e)return!1;if(n){var u=l.lastChild&&l.lastChild.type==c.type,f=L.from(u?e.create():null),d=new U(L.from(e.create(null,L.from(c.type.create(null,f)))),u?3:1,0),p=s.start,h=s.end;n(t.tr.step(new pt(p-(u?3:1),h,p,h,d,1,!0)).scrollIntoView())}return!0}}const sy=Tm(),ay=Tm(),cy=Tm(),ly=xg(((e,t)=>{const n=t.getStyle((e=>Qv`
                &,
                & > * {
                    margin: 0.5rem 0;
                }

                &,
                li {
                    &::marker {
                        color: ${e.palette("primary")};
                    }
                }
            `));return{id:"list_item",schema:{group:"listItem",content:"paragraph block*",defining:!0,parseDOM:[{tag:"li"}],toDOM:e=>["li",{class:t.getClassName(e.attrs,"list-item",n)},0]},parser:{match:({type:e,checked:t})=>"listItem"===e&&null===t,runner:(e,t,n)=>{e.openNode(n),e.next(t.children),e.closeNode()}},serializer:{match:e=>"list_item"===e.type.name,runner:(e,t)=>{e.openNode("listItem"),e.next(t.content),e.closeNode()}},inputRules:e=>[Mn(/^\s*([-+*])\s$/,e)],commands:e=>[Am(sy,(()=>ry(e))),Am(ay,(()=>iy(e))),Am(cy,(()=>oy(e)))],shortcuts:{[Cg.NextListItem]:Sg(sy,"Enter"),[Cg.SinkListItem]:Sg(ay,"Mod-]"),[Cg.LiftListItem]:Sg(cy,"Mod-[")}}})),uy=Tm(),fy=xg(((e,t)=>({id:"ordered_list",schema:{content:"listItem+",group:"block",attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{order:e.hasAttribute("start")?Number(e.getAttribute("start")):1}}}],toDOM:e=>["ol",Object.assign(Object.assign({},1===e.attrs.order?{}:e.attrs.order),{class:t.getClassName(e.attrs,"ordered-list")}),0]},parser:{match:({type:e,ordered:t})=>"list"===e&&!!t,runner:(e,t,n)=>{e.openNode(n).next(t.children).closeNode()}},serializer:{match:e=>"ordered_list"===e.type.name,runner:(e,t)=>{e.openNode("list",void 0,{ordered:!0,start:1}),e.next(t.content),e.closeNode()}},inputRules:e=>[Mn(/^(\d+)\.\s$/,e,(e=>({order:Number(e[1])})),((e,t)=>t.childCount+t.attrs.order===Number(e[1])))],commands:e=>[Am(uy,(()=>dn(e)))],shortcuts:{[Cg.OrderedList]:Sg(uy,"Mod-Shift-7")}}))),dy=Tm(),py="paragraph",hy=xg(((e,t)=>{const n=(null==e?void 0:e.headless)?null:Qv`
              font-size: 1rem;
              line-height: 1.5;
              letter-spacing: 0.5px;
          `;return{id:py,schema:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:e=>["p",{class:t.getClassName(e.attrs,py,n)},0]},parser:{match:e=>"paragraph"===e.type,runner:(e,t,n)=>{e.openNode(n),t.children?e.next(t.children):e.addText(t.value),e.closeNode()}},serializer:{match:e=>"paragraph"===e.type.name,runner:(e,t)=>{e.openNode("paragraph"),e.next(t.content),e.closeNode()}},commands:e=>[Am(dy,(()=>pn(e)))],shortcuts:{[Cg.Text]:Sg(dy,"Mod-Alt-0")}}})),my=xg((()=>({id:"text",schema:{group:"inline"},parser:{match:({type:e})=>"text"===e,runner:(e,t)=>{e.addText(t.value)}},serializer:{match:e=>"text"===e.type.name,runner:(e,t)=>{e.addNode("text",void 0,t.text)}}}))),vy=[qg(),hy(),Kg(),Pg(),Wg(),jg(),fy(),ly(),Qg(),Zg(),ny(),my()];var gy=yy;function yy(e){if(null==e)return by;if("string"==typeof e)return function(e){return t;function t(t){return Boolean(t&&t.type===e)}}(e);if("object"==typeof e)return"length"in e?function(e){var t=[],n=-1;for(;++n<e.length;)t[n]=yy(e[n]);return r;function r(){for(var e=-1;++e<t.length;)if(t[e].apply(this,arguments))return!0;return!1}}(e):function(e){return t;function t(t){var n;for(n in e)if(t[n]!==e[n])return!1;return!0}}(e);if("function"==typeof e)return e;throw new Error("Expected function, string, or object as test")}function by(){return!0}var wy=Sy,ky=gy,xy=function(e){return e};function Sy(e,t,n,r){var o,i;"function"==typeof t&&"function"!=typeof n&&(r=n,n=t,t=null),i=ky(t),o=r?-1:1,function e(s,a,c){var l,u="object"==typeof s&&null!==s?s:{};"string"==typeof u.type&&(l="string"==typeof u.tagName?u.tagName:"string"==typeof u.name?u.name:void 0,f.displayName="node ("+xy(u.type+(l?"<"+l+">":""))+")");return f;function f(){var l,u,f=c.concat(s),d=[];if((!t||i(s,a,c[c.length-1]||null))&&false===(d=function(e){if(null!==e&&"object"==typeof e&&"length"in e)return e;if("number"==typeof e)return[true,e];return[e]}(n(s,c)))[0])return d;if(s.children&&"skip"!==d[0])for(u=(r?s.children.length:-1)+o;u>-1&&u<s.children.length;){if(false===(l=e(s.children[u],u,f)())[0])return l;u="number"==typeof l[1]?l[1]:u+o}return d}}(e,null,[])()}Sy.CONTINUE=true,Sy.SKIP="skip",Sy.EXIT=false;var Cy=Ty,My=wy,Oy=My.CONTINUE,Ay=My.SKIP,Ey=My.EXIT;function Ty(e,t,n,r){"function"==typeof t&&"function"!=typeof n&&(r=n,n=t,t=null),My(e,t,(function(e,t){var r=t[t.length-1],o=r?r.children.indexOf(e):null;return n(e,o,r)}),r)}Ty.CONTINUE=Oy,Ty.SKIP=Ay,Ty.EXIT=Ey;var Ny=Cy,Dy=function(e,t){return function(e){return t;function t(t){var n=t&&Iy(t);return n&&zy.call(e,n)?e[n]:null}}(function(e){var t={};if(!e||!e.type)throw new Error("mdast-util-definitions expected node");return Ny(e,"definition",n),t;function n(e){var n=Iy(e.identifier);zy.call(t,n)||(t[n]=e)}}(e))},zy={}.hasOwnProperty;function Iy(e){return e.toUpperCase()}var $y=Cy,Ry=Dy;const Fy=[Ah([function(){return function(e){var t=Ry(e);function n(e,n,r){var o,i,s;return"definition"===e.type?(r.children.splice(n,1),[$y.SKIP,n]):"imageReference"!==e.type&&"linkReference"!==e.type||!(o=t(e.identifier))?void 0:(i={type:(s="imageReference"===e.type)?"image":"link",url:o.url,title:o.title},s?i.alt=e.alt:i.children=e.children,r.children[n]=i,[$y.SKIP,n])}$y(e,n)}},()=>function(e){var t;t=e=>(e=>"html"===e.type)(e)?[]:[e],function e(n,r,o){if((e=>!!e.children)(n)){const t=[];for(let r=0,o=n.children.length;r<o;r++){const o=e(n.children[r],r,n);if(o)for(let e=0,n=o.length;e<n;e++)t.push(o[e])}n.children=t}return t(n,r,o)}(e,0,null)[0]}])],Py=vg.create([...vy,...$g]),_y=vg.create([...Fy,...Py]),jy={ToggleInlineCode:Mg,ToggleItalic:Ag,ToggleLink:Tg,ToggleBold:zg,ModifyLink:Ng,ModifyImage:Yg,WrapInBlockquote:Fg,WrapInBulletList:_g,WrapInOrderedList:uy,TurnIntoCodeFence:Vg,TurnIntoHeading:Gg,TurnIntoText:dy,InsertHardbreak:Jg,InsertHr:Xg,InsertImage:ey,SplitListItem:sy,SinkListItem:ay,LiftListItem:cy},By=O({},"listener"),Ly=e=>(e.inject(By),e=>y(void 0,void 0,void 0,(function*(){yield e.wait(cm);const t=e.get(By),n=e.get(sm),r=new tn({state:{init:()=>{},apply:e=>{var r,o;e.docChanged&&(null===(r=t.markdown)||void 0===r||r.forEach((t=>{t((()=>n(e.doc)))})),null===(o=t.doc)||void 0===o||o.forEach((t=>{t(e.doc)})))}}});e.update(Ch,(e=>e.concat(r)))}))),Vy=e=>Object.prototype.hasOwnProperty.call(e,"origin");class Wy extends Array{findThenRun(e,t){const n=this.findIndex((t=>Vy(t)&&t.origin===e));return n<0||t(n),this}configure(e,t){return this.findThenRun(e,(n=>{this.splice(n,1,e(t))}))}replace(e,t){return this.findThenRun(e,(e=>{this.splice(e,1,t)}))}remove(e){return this.findThenRun(e,(e=>{this.splice(e,1)}))}headless(){return this.filter(Vy).forEach((e=>{this.configure(e.origin,{headless:!0})})),this}static create(e){return new Wy(...e)}}const qy=(e,t,n)=>{try{const o=t.get(ig),i={ctx:t,getClassName:(r=null==n?void 0:n.className,(e,...t)=>{var n;const o=null!==(n=null==r?void 0:r(e))&&void 0!==n?n:t;return Array.isArray(o)?o.filter((e=>e)).join(" "):o}),getStyle:e=>(null==n?void 0:n.headless)?"":e(o)};return e(n,i)}catch(o){throw C()}var r},Hy=(e,t,n)=>{var r;return null!==(r=null==n?void 0:n[e])&&void 0!==r?r:t},Jy=(e,t,n)=>e.flatMap(((e,t)=>([n,{defaultKey:r,commandKey:o,args:i}])=>[Hy(n,r,t)].flat().map((t=>[t,e(o)(i)])))(t,n)),Ky=(e,t)=>e?(n,r,o)=>Object.fromEntries(Jy((e=>Object.entries(e).filter((e=>!!e)))(e),o,t)):()=>({}),Uy=e=>{const t=n=>{const r=$m((t=>{var o;const i=qy(e,t,n),s=null!==(o=null==n?void 0:n.view)&&void 0!==o?o:i.view,a=Ky(i.shortcuts,null==n?void 0:n.keymap);return r.id=i.id,Object.assign(Object.assign({},i),{view:s,keymap:a})}));return r.origin=t,r};return t},Gy=e=>{const t=n=>{const r=Mh((t=>{const o=qy(e,t,n);return r.id=o.id,o.plugin}));return r.origin=t,r};return t},Qy=(e,t,n)=>({commandKey:e,defaultKey:t,args:n});var Xy,Zy;if("undefined"!=typeof WeakMap){var Yy=new WeakMap;Xy=function(e){return Yy.get(e)},Zy=function(e,t){return Yy.set(e,t),t}}else{var eb=[],tb=0;Xy=function(e){for(var t=0;t<eb.length;t+=2)if(eb[t]==e)return eb[t+1]},Zy=function(e,t){return 10==tb&&(tb=0),eb[tb++]=e,eb[tb++]=t}}var nb=function(e,t,n,r){this.left=e,this.top=t,this.right=n,this.bottom=r},rb=function(e,t,n,r){this.width=e,this.height=t,this.map=n,this.problems=r};function ob(e){if(e.colwidth)return e.colwidth.slice();for(var t=[],n=0;n<e.colspan;n++)t.push(0);return t}function ib(e,t){var n=e.getAttribute("data-colwidth"),r=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map((function(e){return Number(e)})):null,o=Number(e.getAttribute("colspan")||1),i={colspan:o,rowspan:Number(e.getAttribute("rowspan")||1),colwidth:r&&r.length==o?r:null};for(var s in t){var a=t[s].getFromDOM,c=a&&a(e);null!=c&&(i[s]=c)}return i}function sb(e,t){var n={};for(var r in 1!=e.attrs.colspan&&(n.colspan=e.attrs.colspan),1!=e.attrs.rowspan&&(n.rowspan=e.attrs.rowspan),e.attrs.colwidth&&(n["data-colwidth"]=e.attrs.colwidth.join(",")),t){var o=t[r].setDOMAttr;o&&o(e.attrs[r],n)}return n}function ab(e){var t=e.cached.tableNodeTypes;if(!t)for(var n in t=e.cached.tableNodeTypes={},e.nodes){var r=e.nodes[n],o=r.spec.tableRole;o&&(t[o]=r)}return t}rb.prototype.findCell=function(e){for(var t=0;t<this.map.length;t++){var n=this.map[t];if(n==e){for(var r=t%this.width,o=t/this.width|0,i=r+1,s=o+1,a=1;i<this.width&&this.map[t+a]==n;a++)i++;for(var c=1;s<this.height&&this.map[t+this.width*c]==n;c++)s++;return new nb(r,o,i,s)}}throw new RangeError("No cell with offset "+e+" found")},rb.prototype.colCount=function(e){for(var t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw new RangeError("No cell with offset "+e+" found")},rb.prototype.nextCell=function(e,t,n){var r=this.findCell(e),o=r.left,i=r.right,s=r.top,a=r.bottom;return"horiz"==t?(n<0?0==o:i==this.width)?null:this.map[s*this.width+(n<0?o-1:i)]:(n<0?0==s:a==this.height)?null:this.map[o+this.width*(n<0?s-1:a)]},rb.prototype.rectBetween=function(e,t){var n=this.findCell(e),r=n.left,o=n.right,i=n.top,s=n.bottom,a=this.findCell(t),c=a.left,l=a.right,u=a.top,f=a.bottom;return new nb(Math.min(r,c),Math.min(i,u),Math.max(o,l),Math.max(s,f))},rb.prototype.cellsInRect=function(e){for(var t=[],n={},r=e.top;r<e.bottom;r++)for(var o=e.left;o<e.right;o++){var i=r*this.width+o,s=this.map[i];n[s]||(n[s]=!0,o==e.left&&o&&this.map[i-1]==s||r==e.top&&r&&this.map[i-this.width]==s||t.push(s))}return t},rb.prototype.positionAt=function(e,t,n){for(var r=0,o=0;;r++){var i=o+n.child(r).nodeSize;if(r==e){for(var s=t+e*this.width,a=(e+1)*this.width;s<a&&this.map[s]<o;)s++;return s==a?i-1:this.map[s]}o=i}},rb.get=function(e){return Xy(e)||Zy(e,function(e){if("table"!=e.type.spec.tableRole)throw new RangeError("Not a table node: "+e.type.name);for(var t=function(e){for(var t=-1,n=!1,r=0;r<e.childCount;r++){var o=e.child(r),i=0;if(n)for(var s=0;s<r;s++)for(var a=e.child(s),c=0;c<a.childCount;c++){var l=a.child(c);s+l.attrs.rowspan>r&&(i+=l.attrs.colspan)}for(var u=0;u<o.childCount;u++){var f=o.child(u);i+=f.attrs.colspan,f.attrs.rowspan>1&&(n=!0)}-1==t?t=i:t!=i&&(t=Math.max(t,i))}return t}(e),n=e.childCount,r=[],o=0,i=null,s=[],a=0,c=t*n;a<c;a++)r[a]=0;for(var l=0,u=0;l<n;l++){var f=e.child(l);u++;for(var d=0;;d++){for(;o<r.length&&0!=r[o];)o++;if(d==f.childCount)break;for(var p=f.child(d),h=p.attrs,m=h.colspan,v=h.rowspan,g=h.colwidth,y=0;y<v;y++){if(y+l>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:u,n:v-y});break}for(var b=o+y*t,w=0;w<m;w++){0==r[b+w]?r[b+w]=u:(i||(i=[])).push({type:"collision",row:l,pos:u,n:m-w});var k=g&&g[w];if(k){var x=(b+w)%t*2,S=s[x];null==S||S!=k&&1==s[x+1]?(s[x]=k,s[x+1]=1):S==k&&s[x+1]++}}}o+=m,u+=p.nodeSize}for(var C=(l+1)*t,M=0;o<C;)0==r[o++]&&M++;M&&(i||(i=[])).push({type:"missing",row:l,n:M}),u++}for(var O=new rb(t,n,r,i),A=!1,E=0;!A&&E<s.length;E+=2)null!=s[E]&&s[E+1]<n&&(A=!0);A&&function(e,t,n){e.problems||(e.problems=[]);for(var r=0,o={};r<e.map.length;r++){var i=e.map[r];if(!o[i]){o[i]=!0;for(var s=n.nodeAt(i),a=null,c=0;c<s.attrs.colspan;c++){var l=t[2*((r+c)%e.width)];null==l||s.attrs.colwidth&&s.attrs.colwidth[c]==l||((a||(a=ob(s.attrs)))[c]=l)}a&&e.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:a})}}}(O,s,e);return O}(e))};var cb=new on("selectingCells");function lb(e){for(var t=e.depth-1;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return e.node(0).resolve(e.before(t+1));return null}function ub(e){for(var t=e.selection.$head,n=t.depth;n>0;n--)if("row"==t.node(n).type.spec.tableRole)return!0;return!1}function fb(e){var t=e.selection;return t.$anchorCell?t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell:t.node&&"cell"==t.node.type.spec.tableRole?t.$anchor:lb(t.$head)||function(e){for(var t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){var r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n)}for(var o=e.nodeBefore,i=e.pos;o;o=o.lastChild,i--){var s=o.type.spec.tableRole;if("cell"==s||"header_cell"==s)return e.doc.resolve(i-o.nodeSize)}}(t.$head)}function db(e){return"row"==e.parent.type.spec.tableRole&&e.nodeAfter}function pb(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function hb(e,t,n){var r=e.start(-1),o=rb.get(e.node(-1)).nextCell(e.pos-r,t,n);return null==o?null:e.node(0).resolve(r+o)}function mb(e,t,n){var r={};for(var o in e)r[o]=e[o];return r[t]=n,r}function vb(e,t,n){void 0===n&&(n=1);var r=mb(e,"colspan",e.colspan-n);return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(t,n),r.colwidth.some((function(e){return e>0}))||(r.colwidth=null)),r}function gb(e,t,n){void 0===n&&(n=1);var r=mb(e,"colspan",e.colspan+n);if(r.colwidth){r.colwidth=r.colwidth.slice();for(var o=0;o<n;o++)r.colwidth.splice(t,0,0)}return r}var yb=function(e){function t(t,n){void 0===n&&(n=t);var r=t.node(-1),o=rb.get(r),i=t.start(-1),s=o.rectBetween(t.pos-i,n.pos-i),a=t.node(0),c=o.cellsInRect(s).filter((function(e){return e!=n.pos-i}));c.unshift(n.pos-i);var l=c.map((function(e){var t=r.nodeAt(e),n=e+i+1;return new Pt(a.resolve(n),a.resolve(n+t.content.size))}));e.call(this,l[0].$from,l[0].$to,l),this.$anchorCell=t,this.$headCell=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(e,n){var r=e.resolve(n.map(this.$anchorCell.pos)),o=e.resolve(n.map(this.$headCell.pos));if(db(r)&&db(o)&&pb(r,o)){var i=this.$anchorCell.node(-1)!=r.node(-1);return i&&this.isRowSelection()?t.rowSelection(r,o):i&&this.isColSelection()?t.colSelection(r,o):new t(r,o)}return _t.between(r,o)},t.prototype.content=function(){for(var e=this.$anchorCell.node(-1),t=rb.get(e),n=this.$anchorCell.start(-1),r=t.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),o={},i=[],s=r.top;s<r.bottom;s++){for(var a=[],c=s*t.width+r.left,l=r.left;l<r.right;l++,c++){var u=t.map[c];if(!o[u]){o[u]=!0;var f=t.findCell(u),d=e.nodeAt(u),p=r.left-f.left,h=f.right-r.right;if(p>0||h>0){var m=d.attrs;p>0&&(m=vb(m,0,p)),h>0&&(m=vb(m,m.colspan-h,h)),d=f.left<r.left?d.type.createAndFill(m):d.type.create(m,d.content)}if(f.top<r.top||f.bottom>r.bottom){var v=mb(d.attrs,"rowspan",Math.min(f.bottom,r.bottom)-Math.max(f.top,r.top));d=f.top<r.top?d.type.createAndFill(v):d.type.create(v,d.content)}a.push(d)}}i.push(e.child(s).copy(L.from(a)))}var g=this.isColSelection()&&this.isRowSelection()?e:i;return new U(L.from(g),1,1)},t.prototype.replace=function(t,n){void 0===n&&(n=U.empty);for(var r=t.steps.length,o=this.ranges,i=0;i<o.length;i++){var s=o[i],a=s.$from,c=s.$to,l=t.mapping.slice(r);t.replace(l.map(a.pos),l.map(c.pos),i?U.empty:n)}var u=e.findFrom(t.doc.resolve(t.mapping.slice(r).map(this.to)),-1);u&&t.setSelection(u)},t.prototype.replaceWith=function(e,t){this.replace(e,new U(L.from(t),0,0))},t.prototype.forEachCell=function(e){for(var t=this.$anchorCell.node(-1),n=rb.get(t),r=this.$anchorCell.start(-1),o=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r)),i=0;i<o.length;i++)e(t.nodeAt(o[i]),r+o[i])},t.prototype.isColSelection=function(){var e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;var n=e+this.$anchorCell.nodeAfter.attrs.rowspan,r=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(n,r)==this.$headCell.node(-1).childCount},t.colSelection=function(e,n){void 0===n&&(n=e);var r=rb.get(e.node(-1)),o=e.start(-1),i=r.findCell(e.pos-o),s=r.findCell(n.pos-o),a=e.node(0);return i.top<=s.top?(i.top>0&&(e=a.resolve(o+r.map[i.left])),s.bottom<r.height&&(n=a.resolve(o+r.map[r.width*(r.height-1)+s.right-1]))):(s.top>0&&(n=a.resolve(o+r.map[s.left])),i.bottom<r.height&&(e=a.resolve(o+r.map[r.width*(r.height-1)+i.right-1]))),new t(e,n)},t.prototype.isRowSelection=function(){var e=rb.get(this.$anchorCell.node(-1)),t=this.$anchorCell.start(-1),n=e.colCount(this.$anchorCell.pos-t),r=e.colCount(this.$headCell.pos-t);if(Math.min(n,r)>0)return!1;var o=n+this.$anchorCell.nodeAfter.attrs.colspan,i=r+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,i)==e.width},t.prototype.eq=function(e){return e instanceof t&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos},t.rowSelection=function(e,n){void 0===n&&(n=e);var r=rb.get(e.node(-1)),o=e.start(-1),i=r.findCell(e.pos-o),s=r.findCell(n.pos-o),a=e.node(0);return i.left<=s.left?(i.left>0&&(e=a.resolve(o+r.map[i.top*r.width])),s.right<r.width&&(n=a.resolve(o+r.map[r.width*(s.top+1)-1]))):(s.left>0&&(n=a.resolve(o+r.map[s.top*r.width])),i.right<r.width&&(e=a.resolve(o+r.map[r.width*(i.top+1)-1]))),new t(e,n)},t.prototype.toJSON=function(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}},t.fromJSON=function(e,n){return new t(e.resolve(n.anchor),e.resolve(n.head))},t.create=function(e,n,r){return void 0===r&&(r=n),new t(e.resolve(n),e.resolve(r))},t.prototype.getBookmark=function(){return new bb(this.$anchorCell.pos,this.$headCell.pos)},t}(Rt);yb.prototype.visible=!1,Rt.jsonID("cell",yb);var bb=function(e,t){this.anchor=e,this.head=t};function wb(e){if(!(e.selection instanceof yb))return null;var t=[];return e.selection.forEachCell((function(e,n){t.push(hi.node(n,n+e.nodeSize,{class:"selectedCell"}))})),yi.create(e.doc,t)}function kb(e){if(!e.size)return null;for(var t=e.content,n=e.openStart,r=e.openEnd;1==t.childCount&&(n>0&&r>0||"table"==t.firstChild.type.spec.tableRole);)n--,r--,t=t.firstChild.content;var o=t.firstChild,i=o.type.spec.tableRole,s=o.type.schema,a=[];if("row"==i)for(var c=0;c<t.childCount;c++){var l=t.child(c).content,u=c?0:Math.max(0,n-1),f=c<t.childCount-1?0:Math.max(0,r-1);(u||f)&&(l=xb(ab(s).row,new U(l,u,f)).content),a.push(l)}else{if("cell"!=i&&"header_cell"!=i)return null;a.push(n||r?xb(ab(s).row,new U(t,n,r)).content:t)}return function(e,t){for(var n=[],r=0;r<t.length;r++)for(var o=t[r],i=o.childCount-1;i>=0;i--)for(var s=o.child(i).attrs,a=s.rowspan,c=s.colspan,l=r;l<r+a;l++)n[l]=(n[l]||0)+c;for(var u=0,f=0;f<n.length;f++)u=Math.max(u,n[f]);for(var d=0;d<n.length;d++)if(d>=t.length&&t.push(L.empty),n[d]<u){for(var p=ab(e).cell.createAndFill(),h=[],m=n[d];m<u;m++)h.push(p);t[d]=t[d].append(L.from(h))}return{height:t.length,width:u,rows:t}}(s,a)}function xb(e,t){var n=e.createAndFill();return new st(n).replace(0,n.content.size,t).doc}function Sb(e,t,n,r,o,i,s,a){if(0==s||s==t.height)return!1;for(var c=!1,l=o;l<i;l++){var u=s*t.width+l,f=t.map[u];if(t.map[u-t.width]==f){c=!0;var d=n.nodeAt(f),p=t.findCell(f),h=p.top,m=p.left;e.setNodeMarkup(e.mapping.slice(a).map(f+r),null,mb(d.attrs,"rowspan",s-h)),e.insert(e.mapping.slice(a).map(t.positionAt(s,m,n)),d.type.createAndFill(mb(d.attrs,"rowspan",h+d.attrs.rowspan-s))),l+=d.attrs.colspan-1}}return c}function Cb(e,t,n,r,o,i,s,a){if(0==s||s==t.width)return!1;for(var c=!1,l=o;l<i;l++){var u=l*t.width+s,f=t.map[u];if(t.map[u-1]==f){c=!0;var d=n.nodeAt(f),p=t.colCount(f),h=e.mapping.slice(a).map(f+r);e.setNodeMarkup(h,null,vb(d.attrs,s-p,d.attrs.colspan-(s-p))),e.insert(h+d.nodeSize,d.type.createAndFill(vb(d.attrs,0,s-p))),l+=d.attrs.rowspan-1}}return c}function Mb(e,t,n,r,o){var i=n?e.doc.nodeAt(n-1):e.doc,s=rb.get(i),a=r.top,c=r.left,l=c+o.width,u=a+o.height,f=e.tr,d=0;function p(){i=n?f.doc.nodeAt(n-1):f.doc,s=rb.get(i),d=f.mapping.maps.length}(function(e,t,n,r,o,i,s){var a,c,l=ab(e.doc.type.schema);if(o>t.width)for(var u=0,f=0;u<t.height;u++){var d=n.child(u);f+=d.nodeSize;var p=[],h=void 0;h=null==d.lastChild||d.lastChild.type==l.cell?a||(a=l.cell.createAndFill()):c||(c=l.header_cell.createAndFill());for(var m=t.width;m<o;m++)p.push(h);e.insert(e.mapping.slice(s).map(f-1+r),p)}if(i>t.height){for(var v=[],g=0,y=(t.height-1)*t.width;g<Math.max(t.width,o);g++){var b=!(g>=t.width)&&n.nodeAt(t.map[y+g]).type==l.header_cell;v.push(b?c||(c=l.header_cell.createAndFill()):a||(a=l.cell.createAndFill()))}for(var w=l.row.create(null,L.from(v)),k=[],x=t.height;x<i;x++)k.push(w);e.insert(e.mapping.slice(s).map(r+n.nodeSize-2),k)}return!(!a&&!c)})(f,s,i,n,l,u,d)&&p(),Sb(f,s,i,n,c,l,a,d)&&p(),Sb(f,s,i,n,c,l,u,d)&&p(),Cb(f,s,i,n,a,u,c,d)&&p(),Cb(f,s,i,n,a,u,l,d)&&p();for(var h=a;h<u;h++){var m=s.positionAt(h,c,i),v=s.positionAt(h,l,i);f.replace(f.mapping.slice(d).map(m+n),f.mapping.slice(d).map(v+n),new U(o.rows[h-a],0,0))}p(),f.setSelection(new yb(f.doc.resolve(n+s.positionAt(a,c,i)),f.doc.resolve(n+s.positionAt(u-1,l-1,i)))),t(f)}bb.prototype.map=function(e){return new bb(e.map(this.anchor),e.map(this.head))},bb.prototype.resolve=function(e){var t=e.resolve(this.anchor),n=e.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&n.index()<n.parent.childCount&&pb(t,n)?new yb(t,n):Rt.near(n,1)};var Ob=Ln({ArrowLeft:Eb("horiz",-1),ArrowRight:Eb("horiz",1),ArrowUp:Eb("vert",-1),ArrowDown:Eb("vert",1),"Shift-ArrowLeft":Tb("horiz",-1),"Shift-ArrowRight":Tb("horiz",1),"Shift-ArrowUp":Tb("vert",-1),"Shift-ArrowDown":Tb("vert",1),Backspace:Nb,"Mod-Backspace":Nb,Delete:Nb,"Mod-Delete":Nb});function Ab(e,t,n){return!n.eq(e.selection)&&(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function Eb(e,t){return function(n,r,o){var i=n.selection;if(i instanceof yb)return Ab(n,r,Rt.near(i.$headCell,t));if("horiz"!=e&&!i.empty)return!1;var s=$b(o,e,t);if(null==s)return!1;if("horiz"==e)return Ab(n,r,Rt.near(n.doc.resolve(i.head+t),t));var a,c=n.doc.resolve(s),l=hb(c,e,t);return a=l?Rt.near(l,1):t<0?Rt.near(n.doc.resolve(c.before(-1)),-1):Rt.near(n.doc.resolve(c.after(-1)),1),Ab(n,r,a)}}function Tb(e,t){return function(n,r,o){var i=n.selection;if(!(i instanceof yb)){var s=$b(o,e,t);if(null==s)return!1;i=new yb(n.doc.resolve(s))}var a=hb(i.$headCell,e,t);return!!a&&Ab(n,r,new yb(i.$anchorCell,a))}}function Nb(e,t){var n=e.selection;if(!(n instanceof yb))return!1;if(t){var r=e.tr,o=ab(e.schema).cell.createAndFill().content;n.forEachCell((function(e,t){e.content.eq(o)||r.replace(r.mapping.map(t+1),r.mapping.map(t+e.nodeSize-1),new U(o,0,0))})),r.docChanged&&t(r)}return!0}function Db(e,t){var n=lb(e.state.doc.resolve(t));return!!n&&(e.dispatch(e.state.tr.setSelection(new yb(n))),!0)}function zb(e,t,n){if(!ub(e.state))return!1;var r=kb(n),o=e.state.selection;if(o instanceof yb){r||(r={width:1,height:1,rows:[L.from(xb(ab(e.state.schema).cell,n))]});var i=o.$anchorCell.node(-1),s=o.$anchorCell.start(-1),a=rb.get(i).rectBetween(o.$anchorCell.pos-s,o.$headCell.pos-s);return r=function(e,t,n){var r=e.width,o=e.height,i=e.rows;if(r!=t){for(var s=[],a=[],c=0;c<i.length;c++){for(var l=i[c],u=[],f=s[c]||0,d=0;f<t;d++){var p=l.child(d%l.childCount);f+p.attrs.colspan>t&&(p=p.type.create(vb(p.attrs,p.attrs.colspan,f+p.attrs.colspan-t),p.content)),u.push(p),f+=p.attrs.colspan;for(var h=1;h<p.attrs.rowspan;h++)s[c+h]=(s[c+h]||0)+p.attrs.colspan}a.push(L.from(u))}i=a,r=t}if(o!=n){for(var m=[],v=0,g=0;v<n;v++,g++){for(var y=[],b=i[g%o],w=0;w<b.childCount;w++){var k=b.child(w);v+k.attrs.rowspan>n&&(k=k.type.create(mb(k.attrs,"rowspan",Math.max(1,n-k.attrs.rowspan)),k.content)),y.push(k)}m.push(L.from(y))}i=m,o=n}return{width:r,height:o,rows:i}}(r,a.right-a.left,a.bottom-a.top),Mb(e.state,e.dispatch,s,a,r),!0}if(r){var c=fb(e.state),l=c.start(-1);return Mb(e.state,e.dispatch,l,rb.get(c.node(-1)).findCell(c.pos-l),r),!0}return!1}function Ib(e,t){if(!t.ctrlKey&&!t.metaKey){var n,r=Rb(e,t.target);if(t.shiftKey&&e.state.selection instanceof yb)o(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&r&&null!=(n=lb(e.state.selection.$anchor))&&Fb(e,t).pos!=n.pos)o(n,t),t.preventDefault();else if(!r)return;e.root.addEventListener("mouseup",i),e.root.addEventListener("dragstart",i),e.root.addEventListener("mousemove",s)}function o(t,n){var r=Fb(e,n),o=null==cb.getState(e.state);if(!r||!pb(t,r)){if(!o)return;r=t}var i=new yb(t,r);if(o||!e.state.selection.eq(i)){var s=e.state.tr.setSelection(i);o&&s.setMeta(cb,t.pos),e.dispatch(s)}}function i(){e.root.removeEventListener("mouseup",i),e.root.removeEventListener("dragstart",i),e.root.removeEventListener("mousemove",s),null!=cb.getState(e.state)&&e.dispatch(e.state.tr.setMeta(cb,-1))}function s(n){var s,a=cb.getState(e.state);if(null!=a)s=e.state.doc.resolve(a);else if(Rb(e,n.target)!=r&&!(s=Fb(e,t)))return i();s&&o(s,n)}}function $b(e,t,n){if(!(e.state.selection instanceof _t))return null;for(var r=e.state.selection.$head,o=r.depth-1;o>=0;o--){var i=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:i.childCount))return null;if("cell"==i.type.spec.tableRole||"header_cell"==i.type.spec.tableRole){var s=r.before(o),a="vert"==t?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(a)?s:null}}return null}function Rb(e,t){for(;t&&t!=e.dom;t=t.parentNode)if("TD"==t.nodeName||"TH"==t.nodeName)return t}function Fb(e,t){var n=e.posAtCoords({left:t.clientX,top:t.clientY});return n&&n?lb(e.state.doc.resolve(n.pos)):null}var Pb=new on("fix-tables");function _b(e,t,n,r){var o=e.childCount,i=t.childCount;e:for(var s=0,a=0;s<i;s++){for(var c=t.child(s),l=a,u=Math.min(o,s+3);l<u;l++)if(e.child(l)==c){a=l+1,n+=c.nodeSize;continue e}r(c,n),a<o&&e.child(a).sameMarkup(c)?_b(e.child(a),c,n+1,r):c.nodesBetween(0,c.content.size,r,n+1),n+=c.nodeSize}}function jb(e,t){var n,r=function(t,r){"table"==t.type.spec.tableRole&&(n=function(e,t,n,r){var o=rb.get(t);if(!o.problems)return r;r||(r=e.tr);for(var i,s,a=[],c=0;c<o.height;c++)a.push(0);for(var l=0;l<o.problems.length;l++){var u=o.problems[l];if("collision"==u.type){for(var f=t.nodeAt(u.pos),d=0;d<f.attrs.rowspan;d++)a[u.row+d]+=u.n;r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,vb(f.attrs,f.attrs.colspan-u.n,u.n))}else if("missing"==u.type)a[u.row]+=u.n;else if("overlong_rowspan"==u.type){var p=t.nodeAt(u.pos);r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,mb(p.attrs,"rowspan",p.attrs.rowspan-u.n))}else if("colwidth mismatch"==u.type){var h=t.nodeAt(u.pos);r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,mb(h.attrs,"colwidth",u.colwidth))}}for(var m=0;m<a.length;m++)a[m]&&(null==i&&(i=m),s=m);for(var v=0,g=n+1;v<o.height;v++){var y=t.child(v),b=g+y.nodeSize,w=a[v];if(w>0){var k="cell";y.firstChild&&(k=y.firstChild.type.spec.tableRole);for(var x=[],S=0;S<w;S++)x.push(ab(e.schema)[k].createAndFill());var C=0!=v&&i!=v-1||s!=v?b-1:g+1;r.insert(r.mapping.map(C),x)}g=b}return r.setMeta(Pb,{fixTables:!0})}(e,t,r,n))};return t?t.doc!=e.doc&&_b(t.doc,e.doc,0,r):e.doc.descendants(r),n}function Bb(e){var t,n=e.selection,r=fb(e),o=r.node(-1),i=r.start(-1),s=rb.get(o);return(t=n instanceof yb?s.rectBetween(n.$anchorCell.pos-i,n.$headCell.pos-i):s.findCell(r.pos-i)).tableStart=i,t.map=s,t.table=o,t}function Lb(e,t,n){var r=t.map,o=t.tableStart,i=t.table,s=n>0?-1:0;(function(e,t,n){for(var r=ab(t.type.schema).header_cell,o=0;o<e.height;o++)if(t.nodeAt(e.map[n+o*e.width]).type!=r)return!1;return!0})(r,i,n+s)&&(s=0==n||n==r.width?null:0);for(var a=0;a<r.height;a++){var c=a*r.width+n;if(n>0&&n<r.width&&r.map[c-1]==r.map[c]){var l=r.map[c],u=i.nodeAt(l);e.setNodeMarkup(e.mapping.map(o+l),null,gb(u.attrs,n-r.colCount(l))),a+=u.attrs.rowspan-1}else{var f=null==s?ab(i.type.schema).cell:i.nodeAt(r.map[c+s]).type,d=r.positionAt(a,n,i);e.insert(e.mapping.map(o+d),f.createAndFill())}}return e}function Vb(e,t){if(!ub(e))return!1;if(t){var n=Bb(e);t(Lb(e.tr,n,n.left))}return!0}function Wb(e,t){if(!ub(e))return!1;if(t){var n=Bb(e);t(Lb(e.tr,n,n.right))}return!0}function qb(e,t,n){for(var r=t.map,o=t.table,i=t.tableStart,s=e.mapping.maps.length,a=0;a<r.height;){var c=a*r.width+n,l=r.map[c],u=o.nodeAt(l);if(n>0&&r.map[c-1]==l||n<r.width-1&&r.map[c+1]==l)e.setNodeMarkup(e.mapping.slice(s).map(i+l),null,vb(u.attrs,n-r.colCount(l)));else{var f=e.mapping.slice(s).map(i+l);e.delete(f,f+u.nodeSize)}a+=u.attrs.rowspan}}function Hb(e,t){if(!ub(e))return!1;if(t){var n=Bb(e),r=e.tr;if(0==n.left&&n.right==n.map.width)return!1;for(var o=n.right-1;qb(r,n,o),o!=n.left;o--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=rb.get(n.table);t(r)}return!0}function Jb(e,t,n){for(var r=t.map,o=t.table,i=t.tableStart,s=0,a=0;a<n;a++)s+=o.child(a).nodeSize;var c=s+o.child(n).nodeSize,l=e.mapping.maps.length;e.delete(s+i,c+i);for(var u=0,f=n*r.width;u<r.width;u++,f++){var d=r.map[f];if(n>0&&d==r.map[f-r.width]){var p=o.nodeAt(d).attrs;e.setNodeMarkup(e.mapping.slice(l).map(d+i),null,mb(p,"rowspan",p.rowspan-1)),u+=p.colspan-1}else if(n<r.width&&d==r.map[f+r.width]){var h=o.nodeAt(d),m=h.type.create(mb(h.attrs,"rowspan",h.attrs.rowspan-1),h.content),v=r.positionAt(n+1,u,o);e.insert(e.mapping.slice(l).map(i+v),m),u+=h.attrs.colspan-1}}}function Kb(e,t){if(!ub(e))return!1;if(t){var n=Bb(e),r=e.tr;if(0==n.top&&n.bottom==n.map.height)return!1;for(var o=n.bottom-1;Jb(r,n,o),o!=n.top;o--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=rb.get(n.table);t(r)}return!0}function Ub(e,t){return function(n,r){if(!ub(n))return!1;var o=fb(n);if(o.nodeAfter.attrs[e]===t)return!1;if(r){var i=n.tr;n.selection instanceof yb?n.selection.forEachCell((function(n,r){n.attrs[e]!==t&&i.setNodeMarkup(r,null,mb(n.attrs,e,t))})):i.setNodeMarkup(o.pos,null,mb(o.nodeAfter.attrs,e,t)),r(i)}return!0}}function Gb(e,t,n){for(var r=t.map.cellsInRect({left:0,top:0,right:"row"==e?t.map.width:1,bottom:"column"==e?t.map.height:1}),o=0;o<r.length;o++){var i=t.table.nodeAt(r[o]);if(i&&i.type!==n.header_cell)return!1}return!0}function Qb(e,t){return(t=t||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(e){return function(t,n){if(!ub(t))return!1;if(n){for(var r=ab(t.schema),o=Bb(t),i=t.tr,s=o.map.cellsInRect("column"==e?new nb(o.left,0,o.right,o.map.height):"row"==e?new nb(0,o.top,o.map.width,o.bottom):o),a=s.map((function(e){return o.table.nodeAt(e)})),c=0;c<s.length;c++)a[c].type==r.header_cell&&i.setNodeMarkup(o.tableStart+s[c],r.cell,a[c].attrs);if(0==i.steps.length)for(var l=0;l<s.length;l++)i.setNodeMarkup(o.tableStart+s[l],r.header_cell,a[l].attrs);n(i)}return!0}}(e):function(t,n){if(!ub(t))return!1;if(n){var r=ab(t.schema),o=Bb(t),i=t.tr,s=Gb("row",o,r),a=Gb("column",o,r),c=("column"===e?s:"row"===e&&a)?1:0,l="column"==e?new nb(0,c,1,o.map.height):"row"==e?new nb(c,0,o.map.width,1):o,u="column"==e?a?r.cell:r.header_cell:"row"==e?s?r.cell:r.header_cell:r.cell;o.map.cellsInRect(l).forEach((function(e){var t=e+o.tableStart,n=i.doc.nodeAt(t);n&&i.setNodeMarkup(t,u,n.attrs)})),n(i)}return!0}}function Xb(e){return function(t,n){if(!ub(t))return!1;var r=function(e,t){if(t<0){var n=e.nodeBefore;if(n)return e.pos-n.nodeSize;for(var r=e.index(-1)-1,o=e.before();r>=0;r--){var i=e.node(-1).child(r);if(i.childCount)return o-1-i.lastChild.nodeSize;o-=i.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;for(var s=e.node(-1),a=e.indexAfter(-1),c=e.after();a<s.childCount;a++){var l=s.child(a);if(l.childCount)return c+1;c+=l.nodeSize}}}(fb(t),e);if(null!=r){if(n){var o=t.doc.resolve(r);n(t.tr.setSelection(_t.between(o,(i=o,i.node(0).resolve(i.pos+i.nodeAfter.nodeSize)))).scrollIntoView())}var i;return!0}}}function Zb(e,t){for(var n=e.selection.$anchor,r=n.depth;r>0;r--){if("table"==n.node(r).type.spec.tableRole)return t&&t(e.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0}return!1}Qb("row",{useDeprecatedLogic:!0}),Qb("column",{useDeprecatedLogic:!0}),Qb("cell",{useDeprecatedLogic:!0});var Yb=function(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ew(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))};function ew(e,t,n,r,o,i){for(var s=0,a=!0,c=t.firstChild,l=e.firstChild,u=0,f=0;u<l.childCount;u++)for(var d=l.child(u).attrs,p=d.colspan,h=d.colwidth,m=0;m<p;m++,f++){var v=o==f?i:h&&h[m],g=v?v+"px":"";s+=v||r,v||(a=!1),c?(c.style.width!=g&&(c.style.width=g),c=c.nextSibling):t.appendChild(document.createElement("col")).style.width=g}for(;c;){var y=c.nextSibling;c.parentNode.removeChild(c),c=y}a?(n.style.width=s+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=s+"px")}Yb.prototype.update=function(e){return e.type==this.node.type&&(this.node=e,ew(e,this.colgroup,this.table,this.cellMinWidth),!0)},Yb.prototype.ignoreMutation=function(e){return"attributes"==e.type&&(e.target==this.table||this.colgroup.contains(e.target))};var tw=new on("tableColumnResizing");function nw(e){void 0===e&&(e={});var t=e.handleWidth;void 0===t&&(t=5);var n=e.cellMinWidth;void 0===n&&(n=25);var r=e.View;void 0===r&&(r=Yb);var o=e.lastColumnResizable;return void 0===o&&(o=!0),new tn({key:tw,state:{init:function(e,t){return this.spec.props.nodeViews[ab(t.schema).table.name]=function(e,t){return new r(e,n,t)},new rw(-1,!1)},apply:function(e,t){return t.apply(e)}},props:{attributes:function(e){return tw.getState(e).activeHandle>-1?{class:"resize-cursor"}:null},handleDOMEvents:{mousemove:function(e,n){!function(e,t,n,r,o){var i=tw.getState(e.state);if(!i.dragging){var s=function(e){for(;e&&"TD"!=e.nodeName&&"TH"!=e.nodeName;)e=e.classList.contains("ProseMirror")?null:e.parentNode;return e}(t.target),a=-1;if(s){var c=s.getBoundingClientRect(),l=c.left,u=c.right;t.clientX-l<=n?a=ow(e,t,"left"):u-t.clientX<=n&&(a=ow(e,t,"right"))}if(a!=i.activeHandle){if(!o&&-1!==a){var f=e.state.doc.resolve(a),d=f.node(-1),p=rb.get(d),h=f.start(-1);if(p.colCount(f.pos-h)+f.nodeAfter.attrs.colspan-1==p.width-1)return}sw(e,a)}}}(e,n,t,0,o)},mouseleave:function(e){!function(e){var t=tw.getState(e.state);t.activeHandle>-1&&!t.dragging&&sw(e,-1)}(e)},mousedown:function(e,t){!function(e,t,n){var r=tw.getState(e.state);if(-1==r.activeHandle||r.dragging)return!1;var o=e.state.doc.nodeAt(r.activeHandle),i=function(e,t,n){var r=n.colspan,o=n.colwidth,i=o&&o[o.length-1];if(i)return i;var s=e.domAtPos(t),a=s.node.childNodes[s.offset].offsetWidth,c=r;if(o)for(var l=0;l<r;l++)o[l]&&(a-=o[l],c--);return a/c}(e,r.activeHandle,o.attrs);function s(t){window.removeEventListener("mouseup",s),window.removeEventListener("mousemove",a);var r=tw.getState(e.state);r.dragging&&(!function(e,t,n){for(var r=e.state.doc.resolve(t),o=r.node(-1),i=rb.get(o),s=r.start(-1),a=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,c=e.state.tr,l=0;l<i.height;l++){var u=l*i.width+a;if(!l||i.map[u]!=i.map[u-i.width]){var f=i.map[u],d=o.nodeAt(f).attrs,p=1==d.colspan?0:a-i.colCount(f);if(!d.colwidth||d.colwidth[p]!=n){var h=d.colwidth?d.colwidth.slice():aw(d.colspan);h[p]=n,c.setNodeMarkup(s+f,null,mb(d,"colwidth",h))}}}c.docChanged&&e.dispatch(c)}(e,r.activeHandle,iw(r.dragging,t,n)),e.dispatch(e.state.tr.setMeta(tw,{setDragging:null})))}function a(t){if(!t.which)return s(t);var r=tw.getState(e.state),o=iw(r.dragging,t,n);!function(e,t,n,r){var o=e.state.doc.resolve(t),i=o.node(-1),s=o.start(-1),a=rb.get(i).colCount(o.pos-s)+o.nodeAfter.attrs.colspan-1,c=e.domAtPos(o.start(-1)).node;for(;"TABLE"!=c.nodeName;)c=c.parentNode;ew(i,c.firstChild,c,r,a,n)}(e,r.activeHandle,o,n)}e.dispatch(e.state.tr.setMeta(tw,{setDragging:{startX:t.clientX,startWidth:i}})),window.addEventListener("mouseup",s),window.addEventListener("mousemove",a),t.preventDefault()}(e,t,n)}},decorations:function(e){var t=tw.getState(e);if(t.activeHandle>-1)return function(e,t){for(var n=[],r=e.doc.resolve(t),o=r.node(-1),i=rb.get(o),s=r.start(-1),a=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan,c=0;c<i.height;c++){var l=a+c*i.width-1;if(!(a!=i.width&&i.map[l]==i.map[l+1]||0!=c&&i.map[l-1]==i.map[l-1-i.width])){var u=i.map[l],f=s+u+o.nodeAt(u).nodeSize-1,d=document.createElement("div");d.className="column-resize-handle",n.push(hi.widget(f,d))}}return yi.create(e.doc,n)}(e,t.activeHandle)},nodeViews:{}}})}var rw=function(e,t){this.activeHandle=e,this.dragging=t};function ow(e,t,n){var r=e.posAtCoords({left:t.clientX,top:t.clientY});if(!r)return-1;var o=r.pos,i=lb(e.state.doc.resolve(o));if(!i)return-1;if("right"==n)return i.pos;var s=rb.get(i.node(-1)),a=i.start(-1),c=s.map.indexOf(i.pos-a);return c%s.width==0?-1:a+s.map[c-1]}function iw(e,t,n){var r=t.clientX-e.startX;return Math.max(n,e.startWidth+r)}function sw(e,t){e.dispatch(e.state.tr.setMeta(tw,{setHandle:t}))}function aw(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}function cw(e){void 0===e&&(e={});var t=e.allowTableNodeSelection;return void 0===t&&(t=!1),new tn({key:cb,state:{init:function(){return null},apply:function(e,t){var n=e.getMeta(cb);if(null!=n)return-1==n?null:n;if(null==t||!e.docChanged)return t;var r=e.mapping.mapResult(t),o=r.deleted,i=r.pos;return o?null:i}},props:{decorations:wb,handleDOMEvents:{mousedown:Ib},createSelectionBetween:function(e){if(null!=cb.getState(e.state))return e.state.selection},handleTripleClick:Db,handleKeyDown:Ob,handlePaste:zb},appendTransaction:function(e,n,r){return function(e,t,n){var r,o,i=(t||e).selection,s=(t||e).doc;if(i instanceof Bt&&(o=i.node.type.spec.tableRole)){if("cell"==o||"header_cell"==o)r=yb.create(s,i.from);else if("row"==o){var a=s.resolve(i.from+1);r=yb.rowSelection(a,a)}else if(!n){var c=rb.get(i.node),l=i.from+1,u=l+c.map[c.width*c.height-1];r=yb.create(s,l+1,u)}}else i instanceof _t&&function(e){var t=e.$from,n=e.$to;if(t.pos==n.pos||t.pos<t.pos-6)return!1;for(var r=t.pos,o=n.pos,i=t.depth;i>=0&&!(t.after(i+1)<t.end(i));i--,r++);for(var s=n.depth;s>=0&&!(n.before(s+1)>n.start(s));s--,o--);return r==o&&/row|table/.test(t.node(i).type.spec.tableRole)}(i)?r=_t.create(s,i.from):i instanceof _t&&function(e){for(var t,n,r=e.$from,o=e.$to,i=r.depth;i>0;i--){var s=r.node(i);if("cell"===s.type.spec.tableRole||"header_cell"===s.type.spec.tableRole){t=s;break}}for(var a=o.depth;a>0;a--){var c=o.node(a);if("cell"===c.type.spec.tableRole||"header_cell"===c.type.spec.tableRole){n=c;break}}return t!==n&&0===o.parentOffset}(i)&&(r=_t.create(s,i.$from.start(),i.$from.end()));return r&&(t||(t=e.tr)).setSelection(r),t}(r,jb(r,n),t)}})}rw.prototype.apply=function(e){var t=this,n=e.getMeta(tw);if(n&&null!=n.setHandle)return new rw(n.setHandle,null);if(n&&void 0!==n.setDragging)return new rw(t.activeHandle,n.setDragging);if(t.activeHandle>-1&&e.docChanged){var r=e.mapping.map(t.activeHandle,-1);db(e.doc.resolve(r))||(r=null),t=new rw(r,t.dragging)}return t};var lw={},uw=ll,fw=ul,dw=dl,pw=Ta,hw=Qc,mw=Xc,vw={tokenize:function(e,t,n){return function(t){return e.consume(t),r};function r(t){return 87===t||t-32==87?(e.consume(t),o):n(t)}function o(t){return 87===t||t-32==87?(e.consume(t),i):n(t)}function i(t){return 46===t?(e.consume(t),s):n(t)}function s(e){return null===e||pw(e)?n(e):t(e)}},partial:!0},gw={tokenize:function(e,t,n){var r,o;return i;function i(t){return 38===t?e.check(ww,a,s)(t):46===t||95===t?e.check(bw,a,s)(t):dw(t)||mw(t)||45!==t&&hw(t)?a(t):(e.consume(t),i)}function s(t){return 46===t?(o=r,r=void 0,e.consume(t),i):(95===t&&(r=!0),e.consume(t),i)}function a(e){return o||r?n(e):t(e)}},partial:!0},yw={tokenize:function(e,t){var n=0;return r;function r(s){return 38===s?e.check(ww,t,o)(s):(40===s&&n++,41===s?e.check(bw,i,o)(s):Aw(s)?t(s):Ow(s)?e.check(bw,t,o)(s):(e.consume(s),r))}function o(t){return e.consume(t),r}function i(e){return--n<0?t(e):o(e)}},partial:!0},bw={tokenize:function(e,t,n){return function(t){return e.consume(t),r};function r(o){return Ow(o)?(e.consume(o),r):Aw(o)?t(o):n(o)}},partial:!0},ww={tokenize:function(e,t,n){return function(t){return e.consume(t),r};function r(t){return uw(t)?(e.consume(t),r):59===t?(e.consume(t),o):n(t)}function o(e){return Aw(e)?t(e):n(e)}},partial:!0},kw={tokenize:function(e,t,n){var r=this;return function(t){if(87!==t&&t-32!=87||!Tw(r.previous)||zw(r.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(vw,e.attempt(gw,e.attempt(yw,o),n),n)(t)};function o(n){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(n)}},previous:Tw},xw={tokenize:function(e,t,n){var r=this;return function(t){if(72!==t&&t-32!=72||!Nw(r.previous)||zw(r.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),e.consume(t),o};function o(t){return 84===t||t-32==84?(e.consume(t),i):n(t)}function i(t){return 84===t||t-32==84?(e.consume(t),s):n(t)}function s(t){return 80===t||t-32==80?(e.consume(t),a):n(t)}function a(t){return 83===t||t-32==83?(e.consume(t),c):c(t)}function c(t){return 58===t?(e.consume(t),l):n(t)}function l(t){return 47===t?(e.consume(t),u):n(t)}function u(t){return 47===t?(e.consume(t),f):n(t)}function f(t){return dw(t)||mw(t)||hw(t)?n(t):e.attempt(gw,e.attempt(yw,d),n)(t)}function d(n){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(n)}},previous:Nw},Sw={tokenize:function(e,t,n){var r,o=this;return function(t){if(!Ew(t)||!Dw(o.previous)||zw(o.events))return n(t);return e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),i(t)};function i(t){return Ew(t)?(e.consume(t),i):64===t?(e.consume(t),s):n(t)}function s(t){return 46===t?e.check(bw,u,a)(t):45===t||95===t?e.check(bw,n,c)(t):fw(t)?(e.consume(t),s):u(t)}function a(t){return e.consume(t),r=!0,s}function c(t){return e.consume(t),l}function l(t){return 46===t?e.check(bw,n,a)(t):s(t)}function u(o){return r?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(o)):n(o)}},previous:Dw},Cw={};lw.text=Cw;for(var Mw=48;Mw<123;)Cw[Mw]=Sw,58===++Mw?Mw=65:91===Mw&&(Mw=97);function Ow(e){return 33===e||34===e||39===e||41===e||42===e||44===e||46===e||58===e||59===e||60===e||63===e||95===e||126===e}function Aw(e){return null===e||e<0||32===e||60===e}function Ew(e){return 43===e||45===e||46===e||95===e||fw(e)}function Tw(e){return null===e||e<0||32===e||40===e||42===e||95===e||126===e}function Nw(e){return null===e||!uw(e)}function Dw(e){return 47!==e&&Nw(e)}function zw(e){for(var t=e.length;t--;)if(("labelLink"===e[t][1].type||"labelImage"===e[t][1].type)&&!e[t][1]._balanced)return!0}Cw[43]=Sw,Cw[45]=Sw,Cw[46]=Sw,Cw[95]=Sw,Cw[72]=[Sw,xw],Cw[104]=[Sw,xw],Cw[87]=[Sw,kw],Cw[119]=[Sw,kw];var Iw=lw,$w=function(e){var t=(e||{}).singleTilde,n={tokenize:function(e,n,r){var o=this.previous,i=this.events,s=0;return a;function a(t){return 126!==t||126===o&&"characterEscape"!==i[i.length-1][1].type?r(t):(e.enter("strikethroughSequenceTemporary"),c(t))}function c(i){var a,l,u=Rw(o);return 126===i?s>1?r(i):(e.consume(i),s++,c):s<2&&!t?r(i):(a=e.exit("strikethroughSequenceTemporary"),l=Rw(i),a._open=!l||2===l&&u,a._close=!u||2===u&&l,n(i))}},resolveAll:function(e,t){var n,r,o,i,s=-1;for(;++s<e.length;)if("enter"===e[s][0]&&"strikethroughSequenceTemporary"===e[s][1].type&&e[s][1]._close)for(o=s;o--;)if("exit"===e[o][0]&&"strikethroughSequenceTemporary"===e[o][1].type&&e[o][1]._open&&e[s][1].end.offset-e[s][1].start.offset==e[o][1].end.offset-e[o][1].start.offset){e[s][1].type="strikethroughSequence",e[o][1].type="strikethroughSequence",n={type:"strikethrough",start:_w(e[o][1].start),end:_w(e[s][1].end)},r={type:"strikethroughText",start:_w(e[o][1].end),end:_w(e[s][1].start)},i=[["enter",n,t],["enter",e[o][1],t],["exit",e[o][1],t],["enter",r,t]],Fw(i,i.length,0,Pw(t.parser.constructs.insideSpan.null,e.slice(o+1,s),t)),Fw(i,i.length,0,[["exit",r,t],["enter",e[s][1],t],["exit",e[s][1],t],["exit",n,t]]),Fw(e,o-1,s-o+3,i),s=o+i.length-2;break}return function(e){var t=-1,n=e.length;for(;++t<n;)"strikethroughSequenceTemporary"===e[t][1].type&&(e[t][1].type="data");return e}(e)}};null==t&&(t=!0);return{text:{126:n},insideSpan:{null:n}}},Rw=tl,Fw=Xa,Pw=$c,_w=Ya;var jw={};jw.flow={null:{tokenize:function(e,t,n){var r,o,i=[],s=0;return function(t){if(null===t||-5===t||-4===t||-3===t)return n(t);if(e.enter("table")._align=i,e.enter("tableHead"),e.enter("tableRow"),124===t)return a(t);return s++,e.enter("temporaryTableCellContent"),u(t)};function a(t){return e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),r=!0,c}function c(t){return null===t||-5===t||-4===t||-3===t?function(t){if(null===t)return n(t);return e.exit("tableRow"),e.exit("tableHead"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),e.check(Lw,n,Bw(e,d,"linePrefix",4))}(t):-2===t||-1===t||32===t?(e.enter("whitespace"),e.consume(t),l):(r&&(r=void 0,s++),124===t?a(t):(e.enter("temporaryTableCellContent"),u(t)))}function l(t){return-2===t||-1===t||32===t?(e.consume(t),l):(e.exit("whitespace"),c(t))}function u(t){return null===t||t<0||32===t||124===t?(e.exit("temporaryTableCellContent"),c(t)):(e.consume(t),92===t?f:u)}function f(t){return 92===t||124===t?(e.consume(t),u):u(t)}function d(t){return null===t||t<0||32===t?n(t):(e.enter("tableDelimiterRow"),p(t))}function p(t){return null===t||-5===t||-4===t||-3===t?y(t):-2===t||-1===t||32===t?(e.enter("whitespace"),e.consume(t),h):45===t?(e.enter("tableDelimiterFiller"),e.consume(t),o=!0,i.push(null),m):58===t?(e.enter("tableDelimiterAlignment"),e.consume(t),e.exit("tableDelimiterAlignment"),i.push("left"),v):124===t?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),p):n(t)}function h(t){return-2===t||-1===t||32===t?(e.consume(t),h):(e.exit("whitespace"),p(t))}function m(t){return 45===t?(e.consume(t),m):(e.exit("tableDelimiterFiller"),58===t?(e.enter("tableDelimiterAlignment"),e.consume(t),e.exit("tableDelimiterAlignment"),i[i.length-1]="left"===i[i.length-1]?"center":"right",g):p(t))}function v(t){return 45===t?(e.enter("tableDelimiterFiller"),e.consume(t),o=!0,m):n(t)}function g(t){return null===t||-5===t||-4===t||-3===t?y(t):-2===t||-1===t||32===t?(e.enter("whitespace"),e.consume(t),h):124===t?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),p):n(t)}function y(t){return e.exit("tableDelimiterRow"),o&&s===i.length?null===t?b(t):e.check(Vw,b,w)(t):n(t)}function b(n){return e.exit("table"),t(n)}function w(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),Bw(e,k,"linePrefix",4)}function k(t){return e.enter("tableBody"),x(t)}function x(t){return e.enter("tableRow"),124===t?S(t):(e.enter("temporaryTableCellContent"),O(t))}function S(t){return e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),C}function C(t){return null===t||-5===t||-4===t||-3===t?function(t){if(e.exit("tableRow"),null===t)return E(t);return e.check(Vw,E,T)(t)}(t):-2===t||-1===t||32===t?(e.enter("whitespace"),e.consume(t),M):124===t?S(t):(e.enter("temporaryTableCellContent"),O(t))}function M(t){return-2===t||-1===t||32===t?(e.consume(t),M):(e.exit("whitespace"),C(t))}function O(t){return null===t||t<0||32===t||124===t?(e.exit("temporaryTableCellContent"),C(t)):(e.consume(t),92===t?A:O)}function A(t){return 92===t||124===t?(e.consume(t),O):O(t)}function E(t){return e.exit("tableBody"),b(t)}function T(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),Bw(e,x,"linePrefix",4)}},resolve:function(e,t){var n,r,o,i,s,a,c,l,u,f,d=e.length,p=-1;for(;++p<d;)n=e[p][1],i&&("temporaryTableCellContent"===n.type&&(l=l||p,u=p),"tableCellDivider"!==n.type&&"tableRow"!==n.type||!u||(a={type:"tableContent",start:e[l][1].start,end:e[u][1].end},c={type:"chunkText",start:a.start,end:a.end,contentType:"text"},e.splice(l,u-l+1,["enter",a,t],["enter",c,t],["exit",c,t],["exit",a,t]),p-=u-l-3,d=e.length,l=void 0,u=void 0)),"exit"===e[p][0]&&f&&f+1<p&&("tableCellDivider"===n.type||"tableRow"===n.type&&(f+3<p||"whitespace"!==e[f][1].type))&&(s={type:o?"tableDelimiter":r?"tableHeader":"tableData",start:e[f][1].start,end:e[p][1].end},e.splice(p+("tableCellDivider"===n.type?1:0),0,["exit",s,t]),e.splice(f,0,["enter",s,t]),p+=2,d=e.length,f=p+1),"tableRow"===n.type&&(i="enter"===e[p][0])&&(f=p+1),"tableDelimiterRow"===n.type&&(o="enter"===e[p][0])&&(f=p+1),"tableHead"===n.type&&(r="enter"===e[p][0]);return e},interruptible:!0}};var Bw=za,Lw={tokenize:function(e,t,n){return function(t){if(45!==t)return n(t);return e.enter("setextUnderline"),r(t)};function r(t){return 45===t?(e.consume(t),r):o(t)}function o(r){return-2===r||-1===r||32===r?(e.consume(r),o):null===r||-5===r||-4===r||-3===r?t(r):n(r)}},partial:!0},Vw={tokenize:function(e,t,n){var r=0;return function(t){return e.enter("check"),e.consume(t),o};function o(i){return-1===i||32===i?(e.consume(i),4===++r?t:o):null===i||i<0?t(i):n(i)}},partial:!0};var Ww=jw,qw={},Hw=Kc,Jw=za,Kw=Ga,Uw={tokenize:function(e,t,n){var r=this;return function(t){if(91!==t||null!==r.previous||!r._gfmTasklistFirstContentOfListItem)return n(t);return e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),o};function o(t){return-2===t||32===t?(e.enter("taskListCheckValueUnchecked"),e.consume(t),e.exit("taskListCheckValueUnchecked"),i):88===t||120===t?(e.enter("taskListCheckValueChecked"),e.consume(t),e.exit("taskListCheckValueChecked"),i):n(t)}function i(r){return 93===r?(e.enter("taskListCheckMarker"),e.consume(r),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),e.check({tokenize:Gw},t,n)):n(r)}}};function Gw(e,t,n){var r=this;return Jw(e,(function(e){return Kw(r.events,"whitespace")&&null!==e&&!Hw(e)?t(e):n(e)}),"whitespace")}qw.text={91:Uw};var Qw=Dc,Xw=Iw,Zw=$w,Yw=Ww,ek=qw;var tk=function(e){return Qw([Xw,Zw(e),Yw,ek])},nk={};var rk=function(e,t,n,r){var o,i;"string"==typeof t||t&&"function"==typeof t.exec?i=[[t,n]]:(i=t,r=n);return ck(e,o=r||{},function e(t){var n=t[0];return r;function r(r,i){var s,a,c,l,u=n[0],f=n[1],d=[],p=0,h=i.children.indexOf(r);for(u.lastIndex=0,a=u.exec(r.value);a&&(s=a.index,!1!==(l=f.apply(null,[].concat(a,{index:a.index,input:a.input})))&&(p!==s&&d.push({type:"text",value:r.value.slice(p,s)}),"string"==typeof l&&l.length>0&&(l={type:"text",value:l}),l&&(d=[].concat(d,l)),p=s+a[0].length),u.global);)a=u.exec(r.value);if(void 0===s?(d=[r],h--):(p<r.value.length&&d.push({type:"text",value:r.value.slice(p)}),d.unshift(h,1),ak.apply(i.children,d)),t.length>1)for(c=e(t.slice(1)),s=-1;++s<d.length;)"text"===(r=d[s]).type?c(r,i):ck(r,o,c);return h+d.length+1}}(function(e){var t,n,r=[];if("object"!=typeof e)throw new Error("Expected array or object as schema");if("length"in e)for(n=-1;++n<e.length;)r.push([lk(e[n][0]),uk(e[n][1])]);else for(t in e)r.push([lk(t),uk(e[t])]);return r}(i))),e},ok=wy,ik=gy,sk=e=>{if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},ak=[].splice;function ck(e,t,n){var r=ik(t.ignore||[]);return ok(e,"text",(function(e,t){var o,i,s=-1;for(;++s<t.length;){if(o=t[s],r(o,i?i.children.indexOf(o):void 0,i))return;i=o}return n(e,i)})),[]}function lk(e){return"string"==typeof e?new RegExp(sk(e),"g"):e}function uk(e){return"function"==typeof e?e:function(){return e}}var fk=function(e,t){var n,r=String(e),o=0;if("string"!=typeof t)throw new Error("Expected character");n=r.indexOf(t);for(;-1!==n;)o++,n=r.indexOf(t,n+t.length);return o},dk=rk,pk=Qc,hk=Xc;function mk(e){this.config.enter.autolinkProtocol.call(this,e)}function vk(e,t,n,r,o){var i,s,a="";return!!yk(o)&&(/^w/i.test(t)&&(n=t+n,t="",a="http://"),!!function(e){var t=e.split(".");if(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))return!1;return!0}(n)&&(!!(i=function(e){var t,n,r,o=/[!"&'),.:;<>?\]}]+$/.exec(e);if(o)for(e=e.slice(0,o.index),t=(o=o[0]).indexOf(")"),n=fk(e,"("),r=fk(e,")");-1!==t&&n>r;)e+=o.slice(0,t+1),t=(o=o.slice(t+1)).indexOf(")"),r++;return[e,o]}(n+r))[0]&&(s={type:"link",title:null,url:a+t+i[0],children:[{type:"text",value:t+i[0]}]},i[1]&&(s=[s,{type:"text",value:i[1]}]),s)))}function gk(e,t,n,r){return!(!yk(r,!0)||/[_-]$/.test(n))&&{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function yk(e,t){var n=e.input.charCodeAt(e.index-1);return(n!=n||hk(n)||pk(n))&&(!t||47!==n)}nk.transforms=[function(e){dk(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/i,vk],[/([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/,gk]],{ignore:["link","linkReference"]})}],nk.enter={literalAutolink:function(e){this.enter({type:"link",title:null,url:"",children:[]},e)},literalAutolinkEmail:mk,literalAutolinkHttp:mk,literalAutolinkWww:mk},nk.exit={literalAutolink:function(e){this.exit(e)},literalAutolinkEmail:function(e){this.config.exit.autolinkEmail.call(this,e)},literalAutolinkHttp:function(e){this.config.exit.autolinkProtocol.call(this,e)},literalAutolinkWww:function(e){this.config.exit.data.call(this,e),this.stack[this.stack.length-1].url="http://"+this.sliceSerialize(e)}};var bk={};bk.canContainEols=["delete"],bk.enter={strikethrough:function(e){this.enter({type:"delete",children:[]},e)}},bk.exit={strikethrough:function(e){this.exit(e)}};var wk={};function kk(e){this.exit(e)}function xk(e){this.enter({type:"tableCell",children:[]},e)}function Sk(e,t){return"|"===t?t:e}wk.enter={table:function(e){this.enter({type:"table",align:e._align,children:[]},e),this.setData("inTable",!0)},tableData:xk,tableHeader:xk,tableRow:function(e){this.enter({type:"tableRow",children:[]},e)}},wk.exit={codeText:function(e){var t=this.resume();this.getData("inTable")&&(t=t.replace(/\\([\\|])/g,Sk));this.stack[this.stack.length-1].value=t,this.exit(e)},table:function(e){this.exit(e),this.setData("inTable")},tableData:kk,tableHeader:kk,tableRow:kk};var Ck={};function Mk(e){this.stack[this.stack.length-2].checked="taskListCheckValueChecked"===e.type}Ck.exit={taskListCheckValueChecked:Mk,taskListCheckValueUnchecked:Mk,paragraph:function(e){var t,n=this.stack[this.stack.length-2],r=this.stack[this.stack.length-1],o=n.children,i=r.children[0],s=-1;if(n&&"listItem"===n.type&&"boolean"==typeof n.checked&&i&&"text"===i.type){for(;++s<o.length;)if("paragraph"===o[s].type){t=o[s];break}t===r&&(i.value=i.value.slice(1),0===i.value.length?r.children.shift():(i.position.start.column++,i.position.start.offset++,r.position.start=Object.assign({},i.position.start)))}this.exit(e)}};var Ok={}.hasOwnProperty,Ak=function(e){var t={transforms:[],canContainEols:[]},n=e.length,r=-1;for(;++r<n;)Ek(t,e[r]);return t}([nk,bk,wk,Ck]);function Ek(e,t){var n,r,o;for(n in t)r=Ok.call(e,n)?e[n]:e[n]={},o=t[n],"canContainEols"===n||"transforms"===n?e[n]=[].concat(r,o):Object.assign(r,o)}var Tk={},Nk=["autolink","link","image","label"];Tk.unsafe=[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:"phrasing",notInConstruct:Nk},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:"phrasing",notInConstruct:Nk},{character:":",before:"[ps]",after:"\\/",inConstruct:"phrasing",notInConstruct:Nk}];var Dk={},zk=ep;function Ik(e,t,n){var r=n.enter("emphasis"),o=zk(e,n,{before:"~",after:"~"});return r(),"~~"+o+"~~"}Dk.unsafe=[{character:"~",inConstruct:"phrasing"}],Dk.handlers={delete:Ik},Ik.peek=function(){return"~"};var $k=md,Rk=function(e,t){var n,r,o,i,s,a,c,l,u,f,d,p=t||{},h=!1!==p.padding,m=!1!==p.delimiterStart,v=!1!==p.delimiterEnd,g=(p.align||[]).concat(),y=!1!==p.alignDelimiters,b=[],w=p.stringLength||_k,k=-1,x=e.length,S=[],C=[],M=[],O=[],A=[],E=0;for(;++k<x;){for(n=e[k],r=-1,o=n.length,M=[],O=[],o>E&&(E=o);++r<o;)T=n[r],a=null==T?"":String(T),!0===y&&(s=w(a),O[r]=s,(void 0===(i=A[r])||s>i)&&(A[r]=s)),M.push(a);S[k]=M,C[k]=O}var T;if(r=-1,o=E,"object"==typeof g&&"length"in g)for(;++r<o;)b[r]=jk(g[r]);else for(d=jk(g);++r<o;)b[r]=d;r=-1,o=E,M=[],O=[];for(;++r<o;)d=b[r],u="",f="",108===d?u=":":d===Pk?f=":":99===d&&(u=":",f=":"),s=y?Math.max(1,A[r]-u.length-f.length):1,a=u+$k("-",s)+f,!0===y&&((s=u.length+s+f.length)>A[r]&&(A[r]=s),O[r]=s),M[r]=a;S.splice(1,0,M),C.splice(1,0,O),k=-1,x=S.length,c=[];for(;++k<x;){for(M=S[k],O=C[k],r=-1,o=E,l=[];++r<o;)a=M[r]||"",u="",f="",!0===y&&(s=A[r]-(O[r]||0),(d=b[r])===Pk?u=$k(" ",s):99===d?s%2==0?(u=$k(" ",s/2),f=u):(u=$k(" ",s/2+.5),f=$k(" ",s/2-.5)):f=$k(" ",s)),!0===m&&0===r&&l.push("|"),!0!==h||!1===y&&""===a||!0!==m&&0===r||l.push(" "),!0===y&&l.push(u),l.push(a),!0===y&&l.push(f),!0===h&&l.push(" "),!0!==v&&r===o-1||l.push("|");l=l.join(""),!1===v&&(l=l.replace(Fk,"")),c.push(l)}return c.join("\n")},Fk=/ +$/,Pk=114;function _k(e){return e.length}function jk(e){var t="string"==typeof e?e.charCodeAt(0):0;return 76===t||108===t?108:82===t||t===Pk?Pk:67===t||99===t?99:0}var Bk=ep,Lk=kp,Vk=Rk,Wk=function(e){var t=e||{},n=t.tableCellPadding,r=t.tablePipeAlign,o=t.stringLength,i=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:"\n",inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[\t :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{table:function(e,t,n){return a(function(e,t){var n=e.children,r=-1,o=n.length,i=[],s=t.enter("table");for(;++r<o;)i[r]=c(n[r],t);return s(),i}(e,n),e.align)},tableRow:function(e,t,n){var r=a([c(e,n)]);return r.slice(0,r.indexOf("\n"))},tableCell:s,inlineCode:function(e,t,n){var r=Lk(e,t,n);-1!==n.stack.indexOf("tableCell")&&(r=r.replace(/\|/g,"\\$&"));return r}}};function s(e,t,n){var r=n.enter("tableCell"),o=Bk(e,n,{before:i,after:i});return r(),o}function a(e,t){return Vk(e,{align:t,alignDelimiters:r,padding:n,stringLength:o})}function c(e,t){for(var n=e.children,r=-1,o=n.length,i=[],a=t.enter("tableRow");++r<o;)i[r]=s(n[r],0,t);return a(),i}};var qk={},Hk=jp;qk.unsafe=[{atBreak:!0,character:"-",after:"[:|-]"}],qk.handlers={listItem:function(e,t,n){var r=Hk(e,t,n),o=e.children[0];"boolean"==typeof e.checked&&o&&"paragraph"===o.type&&(r=r.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,(function(t){return t+"["+(e.checked?"x":" ")+"] "})));return r}};var Jk=Tk,Kk=Dk,Uk=Wk,Gk=qk,Qk=fd;var Xk,Zk=tk,Yk=Ak,ex=function(e){var t=Qk({handlers:{},join:[],unsafe:[],options:{}},{extensions:[Jk,Kk,Uk(e),Gk]});return Object.assign(t.options,{handlers:t.handlers,join:t.join,unsafe:t.unsafe})},tx=function(e){var t=this.data();!Xk&&(this.Parser&&this.Parser.prototype&&this.Parser.prototype.blockTokenizers||this.Compiler&&this.Compiler.prototype&&this.Compiler.prototype.visitors)&&(Xk=!0,console.warn("[remark-gfm] Warning: please upgrade to remark 13 to use this plugin"));function n(e,n){t[e]?t[e].push(n):t[e]=[n]}n("micromarkExtensions",Zk(e)),n("fromMarkdownExtensions",Yk),n("toMarkdownExtensions",ex(e))};const nx=e=>Bi((e=>"table"===e.type.spec.tableRole))(e),rx=(e,t=3,n=3)=>{const{cell:r,header_cell:o,row:i,table:s}=ab(e),a=Array(n).fill(0).map((()=>r.createAndFill(null))),c=Array(n).fill(0).map((()=>o.createAndFill(null))),l=Array(t).fill(0).map(((e,t)=>i.create(null,0===t?c:a)));return s.create(null,l)},ox=e=>t=>n=>{const r=nx(n.selection),o="row"===e;if(r){const e=rb.get(r.node);if(t>=0&&t<(o?e.height:e.width)){const i=e.positionAt(o?t:e.height-1,o?e.width-1:t,r.node),s=n.doc.resolve(r.start+i),a=o?yb.rowSelection:yb.colSelection,c=e.positionAt(o?t:0,o?0:t,r.node),l=n.doc.resolve(r.start+c);return ji(n.setSelection(a(s,l)))}}return n},ix=e=>{const t=(e=>{const t=nx(e);if(!t)return;const n=rb.get(t.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map((e=>{const n=t.node.nodeAt(e),r=e+t.start;return{pos:r,start:r+1,node:n}}))})(e.selection);if(t){const n=e.doc.resolve(t[0].pos),r=e.doc.resolve(t[t.length-1].pos);return ji(e.setSelection(new yb(r,n)))}return e};function sx(e,{map:t,tableStart:n,table:r},o){const i=Array(o).fill(0).reduce(((e,t,n)=>e+r.child(n).nodeSize),n),{cell:s,row:a}=ab(r.type.schema),c=Array(t.width).fill(0).map(((e,n)=>{const o=r.nodeAt(t.map[n]);return s.createAndFill({alignment:null==o?void 0:o.attrs.alignment})}));return e.insert(i,a.create(null,c)),e}const ax=function(e){var t=e.cellAttributes||{},n={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(var r in t)n[r]={default:t[r].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:e.tableGroup,parseDOM:[{tag:"table"}],toDOM:function(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM:function(){return["tr",0]}},table_cell:{content:e.cellContent,attrs:n,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:function(e){return ib(e,t)}}],toDOM:function(e){return["td",sb(e,t),0]}},table_header:{content:e.cellContent,attrs:n,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:function(e){return ib(e,t)}}],toDOM:function(e){return["th",sb(e,t),0]}}}}({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:e=>e.style.textAlign||"left",setDOMAttr:(e,t)=>{t.style=`text-align: ${e||"left"}`}}}}),cx=Qv`
    /* copy from https://github.com/ProseMirror/prosemirror-tables/blob/master/style/tables.css */
    .ProseMirror .tableWrapper {
        overflow-x: auto;
    }
    .ProseMirror table {
        border-collapse: collapse;
        table-layout: fixed;
        width: 100%;
        overflow: hidden;
    }
    .ProseMirror td,
    .ProseMirror th {
        vertical-align: top;
        box-sizing: border-box;
        position: relative;
    }
    .ProseMirror .column-resize-handle {
        position: absolute;
        right: -2px;
        top: 0;
        bottom: 0;
        width: 4px;
        z-index: 20;
        background-color: #adf;
        pointer-events: none;
    }
    .ProseMirror.resize-cursor {
        cursor: ew-resize;
        cursor: col-resize;
    }
    /* Give selected cells a blue overlay */
    .ProseMirror .selectedCell:after {
        z-index: 2;
        position: absolute;
        content: '';
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        background: rgba(200, 200, 255, 0.4);
        pointer-events: none;
    }
`,lx={NextCell:"NextCell",PrevCell:"PrevCell",ExitTable:"ExitTable"},ux=Tm(),fx=Tm(),dx=Tm(),px=Tm(),hx=Uy(((e,t)=>{const n="table";return(e=>{const t=Gv;e.getStyle((({size:e,palette:n,mixin:r})=>{var o,i,s;t`
            ${cx}

            .tableWrapper {
                margin: 0 !important;

                ${null===(o=r.scrollbar)||void 0===o?void 0:o.call(r,"x")};

                width: 100%;

                table {
                    width: calc(100% - 2rem) !important;
                    border-radius: ${e.radius};
                    box-sizing: border-box;
                    margin: 1rem 0 1rem 1rem !important;
                    overflow: auto !important;
                    * {
                        margin: 0 !important;
                        box-sizing: border-box;
                        font-size: 1rem;
                    }
                    tr {
                        ${null===(i=r.border)||void 0===i?void 0:i.call(r,"bottom")};
                    }

                    th {
                        background: ${n("background",.5)};
                        font-weight: 400;
                    }

                    th,
                    td {
                        min-width: 100px;
                        ${null===(s=r.border)||void 0===s?void 0:s.call(r)};
                        text-align: left;
                        position: relative;
                        line-height: 3rem;
                        box-sizing: border-box;
                        height: 3rem;
                    }

                    .selectedCell {
                        &::after {
                            background: ${n("secondary",.38)};
                        }
                        & ::selection {
                            background: transparent;
                        }
                    }

                    .column-resize-handle {
                        background: ${n("primary")};
                        width: ${e.lineWidth};
                    }

                    th,
                    td {
                        padding: 0 1rem;
                        p {
                            line-height: unset !important;
                        }
                    }

                    .milkdown-cell-left,
                    .milkdown-cell-point,
                    .milkdown-cell-top {
                        position: absolute;

                        &::after {
                            cursor: pointer;
                            position: absolute;
                            top: 0;
                            left: 0;
                            height: 100%;
                            width: 100%;
                            display: block;
                            transition: all 0.2s ease-in-out;
                            background: ${n("secondary",.12)};
                            content: '';
                        }
                        &:hover::after {
                            background: ${n("secondary",.38)};
                        }
                    }

                    .milkdown-cell-left {
                        left: calc(-6px - 0.5rem);
                        top: 0;
                        bottom: 0;
                        width: 0.5rem;
                    }

                    .milkdown-cell-top {
                        left: 0;
                        right: 0;
                        top: calc(-6px - 0.5rem);
                        height: 0.5rem;
                    }

                    .milkdown-cell-point {
                        left: calc(-2px - 1rem);
                        top: calc(-2px - 1rem);
                        width: 1rem;
                        height: 1rem;

                        .icon {
                            position: absolute;
                            top: 0;
                            bottom: 0;
                            left: 0;
                            right: 0;
                        }
                    }
                }
            }
        `}))})(t),{id:n,schema:ax.table,parser:{match:e=>"table"===e.type,runner:(e,t,n)=>{const r=t.align,o=t.children.map(((e,t)=>Object.assign(Object.assign({},e),{align:r,isHeader:0===t})));e.openNode(n),e.next(o),e.closeNode()}},serializer:{match:e=>e.type.name===n,runner:(e,t)=>{var n;const r=null===(n=t.content.firstChild)||void 0===n?void 0:n.content;if(!r)return;const o=[];r.forEach((e=>{o.push(e.attrs.alignment)})),e.openNode("table",void 0,{align:o}),e.next(t.content),e.closeNode()}},inputRules:(e,t)=>[new xn(/^\|\|\s$/,((n,r,o,i)=>{const s=n.doc.resolve(o);if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e))return null;const a=rx(t),c=n.tr.replaceRangeWith(o,i,a).scrollIntoView();return c.setSelection(_t.create(c.doc,o+3))}))],commands:(e,t)=>[Am(ux,(()=>Xb(-1))),Am(fx,(()=>Xb(1))),Am(dx,(()=>{return e=t.nodes.paragraph,(t,n)=>{if(!ub(t))return!1;const{$head:r}=t.selection,o=r.after(),i=t.tr.replaceWith(o,o,e.createAndFill());return i.setSelection(Rt.near(i.doc.resolve(o),1)),null==n||n(i.scrollIntoView()),!0};var e})),Am(px,(()=>(e,n)=>{const{selection:r,tr:o}=e,{from:i}=r,s=rx(t),a=o.replaceSelectionWith(s),c=Rt.findFrom(a.doc.resolve(i),1,!0);return c&&(null==n||n(a.setSelection(c))),!0}))],shortcuts:{[lx.NextCell]:Qy(fx,"Mod-]"),[lx.PrevCell]:Qy(ux,"Mod-["),[lx.ExitTable]:Qy(dx,"Mod-Enter")}}})),mx=Uy((()=>{const e="table_cell";return{id:e,schema:ax.table_cell,parser:{match:e=>"tableCell"===e.type&&!e.isHeader,runner:(e,t,n)=>{const r=t.align;e.openNode(n,{alignment:r}).openNode(e.schema.nodes.paragraph).next(t.children).closeNode().closeNode()}},serializer:{match:t=>t.type.name===e,runner:(e,t)=>{e.openNode("tableCell").next(t.content).closeNode()}}}})),vx=Uy((()=>{const e="table_header";return{id:e,schema:ax.table_header,parser:{match:e=>"tableCell"===e.type&&!!e.isHeader,runner:(e,t,n)=>{const r=t.align;e.openNode(n,{alignment:r}),e.openNode(e.schema.nodes.paragraph),e.next(t.children),e.closeNode(),e.closeNode()}},serializer:{match:t=>t.type.name===e,runner:(e,t)=>{e.openNode("tableCell"),e.next(t.content),e.closeNode()}}}})),gx=Uy((()=>{const e="table_row";return{id:e,schema:ax.table_row,parser:{match:e=>"tableRow"===e.type,runner:(e,t,n)=>{const r=t.align,o=t.children.map(((e,n)=>Object.assign(Object.assign({},e),{align:r[n],isHeader:t.isHeader})));e.openNode(n),e.next(o),e.closeNode()}},serializer:{match:t=>t.type.name===e,runner:(e,t)=>{e.openNode("tableRow"),e.next(t.content),e.closeNode()}}}})),yx=Wy.create([hx(),gx(),mx(),vx()]),bx=e=>e.state.selection;var wx,kx;(kx=wx||(wx={}))[kx.AddColLeft=0]="AddColLeft",kx[kx.AddColRight=1]="AddColRight",kx[kx.AddRowTop=2]="AddRowTop",kx[kx.AddRowBottom=3]="AddRowBottom",kx[kx.AlignLeft=4]="AlignLeft",kx[kx.AlignCenter=5]="AlignCenter",kx[kx.AlignRight=6]="AlignRight",kx[kx.Delete=7]="Delete";const xx=e=>({[wx.AddColLeft]:{$:e.ctx.get(ig).slots.icon("leftArrow"),command:()=>Vb,disable:e=>!bx(e).isColSelection()},[wx.AddColRight]:{$:e.ctx.get(ig).slots.icon("rightArrow"),command:()=>Wb,disable:e=>!bx(e).isColSelection()},[wx.AddRowTop]:{$:e.ctx.get(ig).slots.icon("upArrow"),command:()=>(e,t)=>{if(!ub(e))return!1;if(t){const n=Bb(e);t(sx(e.tr,n,n.top))}return!0},disable:e=>!bx(e).isRowSelection()||"table_header"===bx(e).$head.parent.type.name},[wx.AddRowBottom]:{$:e.ctx.get(ig).slots.icon("downArrow"),command:()=>(e,t)=>{if(!ub(e))return!1;if(t){const n=Bb(e);t(sx(e.tr,n,n.bottom))}return!0},disable:e=>!bx(e).isRowSelection()},[wx.AlignLeft]:{$:e.ctx.get(ig).slots.icon("alignLeft"),command:()=>Ub("alignment","left"),disable:e=>!bx(e).isColSelection()},[wx.AlignCenter]:{$:e.ctx.get(ig).slots.icon("alignCenter"),command:()=>Ub("alignment","center"),disable:e=>!bx(e).isColSelection()},[wx.AlignRight]:{$:e.ctx.get(ig).slots.icon("alignRight"),command:()=>Ub("alignment","right"),disable:e=>!bx(e).isColSelection()},[wx.Delete]:{$:e.ctx.get(ig).slots.icon("delete"),command:(e,t)=>{const n=bx(t),r=n.isColSelection(),o=n.isRowSelection();return r&&o?Zb:r?Hb:Kb},disable:e=>{const t=bx(e);return!!t.isRowSelection()&&(!t.isColSelection()&&(e=>{const t=rb.get(e.$anchorCell.node(-1)),n=e.$anchorCell.start(-1),r=t.cellsInRect({left:0,right:t.width,top:0,bottom:1}),o=t.cellsInRect(t.rectBetween(e.$anchorCell.pos-n,e.$headCell.pos-n));for(let i=0,s=r.length;i<s;i++)if(-1===o.indexOf(r[i]))return!1;return!0})(t))}}});var Sx,Cx;(Cx=Sx||(Sx={})).Left="Left",Cx.Top="Top",Cx.Point="Point";const Mx=({size:e,mixin:t,palette:n})=>{var r,o;return Qv`
    display: inline-flex;
    cursor: pointer;
    z-index: 2;

    justify-content: space-evenly;

    position: absolute;

    border-radius: ${e.radius};

    ${null===(r=t.border)||void 0===r?void 0:r.call(t)};

    ${null===(o=t.shadow)||void 0===o?void 0:o.call(t)};

    overflow: hidden;
    background: ${n("surface")};

    .icon {
        position: relative;
        color: ${n("solid",.87)};

        width: 3rem;
        line-height: 3rem;
        text-align: center;
        transition: all 0.4s ease-in-out;
        &:hover {
            background-color: ${n("secondary",.12)};
        }
        &.active {
            color: ${n("primary")};
        }
        &:not(:last-child)::after {
            content: '';
            position: absolute;
            right: 0px;
            top: 0;
            width: ${e.lineWidth};
            bottom: 0;
            background: ${n("line")};
        }
    }
    &.hide,
    .hide {
        display: none;
    }
`};function Ox(e,t,n,r=0){return hi.widget(t.pos+1,(t=>{const o=document.createElement("div");return o.classList.add((e=>{switch(e){case Sx.Left:return"milkdown-cell-left";case Sx.Top:return"milkdown-cell-top";case Sx.Point:default:return"milkdown-cell-point"}})(n)),n===Sx.Point&&o.appendChild(e.get(ig).slots.icon("select")),o.addEventListener("mousedown",(e=>{if(t)switch(e.preventDefault(),n){case Sx.Point:return void t.dispatch(ix(t.state.tr));case Sx.Left:return void t.dispatch(ox("row")(r)(t.state.tr));case Sx.Top:return void t.dispatch(ox("col")(r)(t.state.tr))}})),o}))}const Ax=Gy(((e,t)=>{const n=xx(t),r=document.createElement("div"),o=t.getStyle(Mx);o&&r.classList.add(o),r.classList.add("table-tooltip","hide");return{id:"table-operator",plugin:new tn({key:new on("MILKDOWN_TABLE_OP"),props:{decorations:e=>{const n=[],r=(o=0,e=>{const t=nx(e);if(!t)return;const n=rb.get(t.node);return o<0||o>=n.width?void 0:n.cellsInRect({left:o,right:o+1,top:0,bottom:n.height}).map((e=>{const n=t.node.nodeAt(e);if(!n)throw new Error;const r=e+t.start;return{pos:r,start:r+1,node:n}}))})(e.selection);var o;if(!r)return null;const i=(s=0,e=>{const t=nx(e);if(!t)return;const n=rb.get(t.node);return s<0||s>=n.height?void 0:n.cellsInRect({left:0,right:n.width,top:s,bottom:s+1}).map((e=>{const n=t.node.nodeAt(e);if(!n)throw new Error;const r=e+t.start;return{pos:r,start:r+1,node:n}}))})(e.selection);var s;if(!i)return null;const[a]=r;return n.push(Ox(t.ctx,a,Sx.Point)),r.forEach(((e,r)=>{n.push(Ox(t.ctx,e,Sx.Left,r))})),i.forEach(((e,r)=>{n.push(Ox(t.ctx,e,Sx.Top,r))})),yi.create(e.doc,n)}},view:e=>{var t;Object.values(n).forEach((({$:e})=>r.appendChild(e))),null===(t=e.dom.parentNode)||void 0===t||t.appendChild(r);const o=t=>{e&&(t.stopPropagation(),t.preventDefault(),Object.values(n).forEach((({$:n,command:r})=>{n.contains(t.target)&&r(t,e)(e.state,e.dispatch,e)})))},i=()=>{r.classList.add("hide")};return r.addEventListener("mousedown",o),{update:(e,t)=>{const o=e.state;if((null==t?void 0:t.doc.eq(o.doc))&&t.selection.eq(o.selection))return;o.selection instanceof yb&&e.editable?(((e,t)=>{Object.values(e).forEach((e=>{var n;(null===(n=e.disable)||void 0===n?void 0:n.call(e,t))?e.$.classList.add("hide"):e.$.classList.remove("hide")}))})(n,e),Object.values(n).every((({$:e})=>e.classList.contains("hide")))?i():(r.classList.remove("hide"),((e,t)=>{const{selection:n}=e.state,r=n.isColSelection(),o=n.isRowSelection();Pi(e,t,((e,t,n)=>{let i=o?e.left-n.left-t.width/2-8:e.left-n.left+(e.width-t.width)/2;return i<0&&(i=0),[e.top-n.top-t.height-(r?14:0)-14,i]}))})(e,r))):i()},destroy:()=>{r.removeEventListener("mousedown",o),r.remove()}}}})}})),Ex=Ah(tx),Tx=Mh((()=>[nw({}),cw()])),Nx=Wy.create([Ex,Tx,Ax()]);Wy.create([...Nx,...yx]);const Dx=Mh(Sn({rules:[new xn(/(https?:\/\/)?www\.[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z]{2,}\b(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)(?:[-a-zA-Z0-9@:%._+~#=?!&/]*)$/,((e,t,n,r)=>{const{schema:o}=e,[i]=t;return i?e.tr.replaceWith(n,r,o.text(i)).addMark(n,i.length+n,o.marks.link.create({href:i.startsWith("www")?`https://${i}`:i})):null}))]})),zx=Object.assign(Object.assign(Object.assign({},Cg),lx),{StrikeThrough:"StrikeThrough",TaskList:"TaskList"}),Ix=Tm(),$x=(e=>{const t=n=>{const r=Im((t=>{var o;const i=qy(e,t,n),s=null!==(o=null==n?void 0:n.view)&&void 0!==o?o:i.view,a=Ky(i.shortcuts,null==n?void 0:n.keymap);return r.id=i.id,Object.assign(Object.assign({},i),{view:s,keymap:a})}));return r.origin=t,r};return t})(((e,t)=>{const n="strike_through",r=t.getStyle((e=>Qv`
                text-decoration-color: ${e.palette("secondary")};
            `));return{id:n,schema:{parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:e=>"line-through"===e}],toDOM:e=>["del",{class:t.getClassName(e.attrs,"strike-through",r)}]},parser:{match:e=>"delete"===e.type,runner:(e,t,n)=>{e.openMark(n),e.next(t.children),e.closeMark(n)}},serializer:{match:e=>e.type.name===n,runner:(e,t)=>{e.withMark(t,"delete")}},inputRules:e=>[Fi(/(?:~~)([^~]+)(?:~~)$/,e),Fi(/(?:^|[^~])(~([^~]+)~)$/,e)],commands:e=>[Am(Ix,(()=>hn(e)))],shortcuts:{[zx.StrikeThrough]:Qy(Ix,"Mod-Alt-x")}}})),Rx=Tm(),Fx=Tm(),Px=Tm(),_x=Tm(),jx=Uy(((e,t)=>{const n="task_list_item",r=t.getStyle((({palette:e,size:t})=>Qv`
                list-style-type: none;
                position: relative;

                & > div {
                    overflow: hidden;
                    padding: 0 2px;
                }

                label {
                    position: absolute;
                    top: 0;
                    left: -2rem;
                    display: inline-block;
                    width: 1.5rem;
                    height: 1.5rem;
                    margin: 0.5rem 0;
                    input {
                        visibility: hidden;
                    }
                }
                label:before {
                    position: absolute;
                    top: 0;
                    right: 0;
                    bottom: 0;
                    left: 0;
                    border-radius: ${t.radius};
                }
                label:hover:before {
                    background: ${e("background")};
                }
                &[data-checked='true'] {
                    label {
                        color: ${e("primary")};
                    }
                }
                &[data-checked='false'] {
                    label {
                        color: ${e("solid",.87)};
                    }
                }
                .paragraph {
                    margin: 0.5rem 0;
                }
            `));return{id:n,schema:{group:"listItem",content:"paragraph block*",defining:!0,attrs:{checked:{default:!1}},parseDOM:[{tag:'li[data-type="task-list-item"]',getAttrs:e=>{if(!(e instanceof HTMLElement))throw new Error;return{checked:"true"===e.dataset.checked}}}],toDOM:e=>["li",{"data-type":"task-item","data-checked":e.attrs.checked?"true":"false",class:t.getClassName(e.attrs,"task-list-item",r)},0]},parser:{match:({type:e,checked:t})=>"listItem"===e&&null!==t,runner:(e,t,n)=>{e.openNode(n,{checked:t.checked}),e.next(t.children),e.closeNode()}},serializer:{match:e=>e.type.name===n,runner:(e,t)=>{e.openNode("listItem",void 0,{checked:t.attrs.checked}),e.next(t.content),e.closeNode()}},inputRules:e=>[Mn(/^\s*(\[([ |x])\])\s$/,e,(e=>({checked:"x"===e[e.length-1]})))],commands:e=>[Am(Rx,(()=>ry(e))),Am(Fx,(()=>iy(e))),Am(Px,(()=>oy(e))),Am(_x,(()=>dn(e)))],shortcuts:{[zx.NextListItem]:Qy(Rx,"Enter"),[zx.SinkListItem]:Qy(Fx,"Mod-]"),[zx.LiftListItem]:Qy(Px,"Mod-["),[zx.TaskList]:Qy(_x,"Mod-Alt-9")},view:(e,o,i)=>{const s=t.ctx.get(ig).slots.icon,a=document.createElement("li"),c=document.createElement("label"),l=document.createElement("span"),u=document.createElement("input"),f=document.createElement("div");let d=s("unchecked");c.appendChild(d);const p=e=>{const t=s(e);c.replaceChild(t,d),d=t};c.contentEditable="false",u.type="checkbox";const h=e=>{const t=e.target;if(!(t instanceof HTMLInputElement))return;if(!o.editable)return void(u.checked=!u.checked);const{tr:n}=o.state;o.dispatch(n.setNodeMarkup(i(),void 0,{checked:t.checked}))};u.addEventListener("change",h),a.dataset.checked=e.attrs.checked,e.attrs.checked&&u.setAttribute("checked","checked"),c.append(u,l),a.append(c,f);const m={"data-type":"task-item","data-checked":e.attrs.checked?"true":"false",class:t.getClassName(e.attrs,"task-list-item",r)};return Object.entries(m).forEach((([e,t])=>{a.setAttribute(e,t)})),p(e.attrs.checked?"checked":"unchecked"),{dom:a,contentDOM:f,update:e=>e.type.name===n&&(a.dataset.checked=e.attrs.checked,e.attrs.checked?u.setAttribute("checked","checked"):u.removeAttribute("checked"),p(e.attrs.checked?"checked":"unchecked"),!0),destroy:()=>{u.removeEventListener("change",h)}}}}})),Bx=Wy.create([...Py,...yx,$x(),jx()]),Lx=Wy.create([...Nx,...Fy,Dx]),Vx=Wy.create([...Bx,...Lx]);Object.assign(Object.assign({},jy),{ToggleStrikeThrough:Ix,TurnIntoTaskList:_x,SinkTaskListItem:Fx,LiftTaskListItem:Px,SplitTaskListItem:Rx});const Wx=({palette:e,size:t})=>({scrollbar:(t="y")=>Qv`
        scrollbar-width: thin;
        scrollbar-color: ${e("secondary",.38)} ${e("secondary",.12)};
        -webkit-overflow-scrolling: touch;

        &::-webkit-scrollbar {
            ${"y"===t?"width":"height"}: 4px;
            padding: 0 2px;
            background: ${e("surface")};
        }

        &::-webkit-scrollbar-track {
            border-radius: 4px;
            background: ${e("secondary",.12)};
        }

        &::-webkit-scrollbar-thumb {
            border-radius: 4px;
            background: ${e("secondary",.38)};
        }

        &::-webkit-scrollbar-thumb:hover {
            background: ${e("secondary")};
        }
    `,shadow:()=>{const{lineWidth:n}=t;return Qv`
            box-shadow: 0px ${n} ${n} ${e("shadow",.14)},
                0px 2px ${n} ${e("shadow",.12)}, 0px ${n} 3px ${e("shadow",.2)};
        `},border:n=>n?Qv`
            ${`border-${n}`}: ${t.lineWidth} solid ${e("line")};
        `:Qv`
                border: ${t.lineWidth} solid ${e("line")};
            `}),qx="#2e3440",Hx="#d8dee9",Jx="#eceff4",Kx={shadow:"#3b4252",primary:"#5e81ac",secondary:"#81a1c1",light:{neutral:qx,solid:"#4c566a",line:Hx,background:Jx,surface:"#fff"},dark:{neutral:Jx,solid:Hx,line:"#434c5e",background:"#252932",surface:qx}},Ux=({palette:e,mixin:t,size:n,font:r})=>{var o,i;return Qv`
    .milkdown {
        color: ${e("neutral",.87)};
        background: ${e("surface")};

        position: relative;
        font-family: ${r.typography};
        margin-left: auto;
        margin-right: auto;
        ${null===(o=t.shadow)||void 0===o?void 0:o.call(t)};
        padding: 3.125rem 1.25rem;
        box-sizing: border-box;

        .editor {
            outline: none;
            & > * {
                margin: 1.875rem 0;
            }
        }

        .ProseMirror-selectednode {
            outline: ${n.lineWidth} solid ${e("line")};
        }

        li.ProseMirror-selectednode {
            outline: none;
        }

        li.ProseMirror-selectednode::after {
            ${null===(i=t.border)||void 0===i?void 0:i.call(t)};
        }

        @media only screen and (min-width: 72rem) {
            max-width: 57.375rem;
            padding: 3.125rem 7.25rem;
        }

        & ::selection {
            background: ${e("secondary",.38)};
        }
    }
`},Gx={h1:"looks_one",h2:"looks_two",h3:"looks_3",loading:"hourglass_empty",quote:"format_quote",code:"code",table:"table_chart",divider:"horizontal_rule",image:"image",brokenImage:"broken_image",bulletList:"format_list_bulleted",orderedList:"format_list_numbered",taskList:"checklist",bold:"format_bold",italic:"format_italic",inlineCode:"code",strikeThrough:"strikethrough_s",link:"link",leftArrow:"chevron_left",rightArrow:"chevron_right",upArrow:"expand_less",downArrow:"expand_more",alignLeft:"format_align_left",alignRight:"format_align_right",alignCenter:"format_align_center",delete:"delete",select:"select_all",unchecked:"check_box_outline_blank",checked:"check_box"},Qx=Qv`
    /* copy from https://github.com/ProseMirror/@milkdown/prose/blob/master/style/prosemirror.css */
    .ProseMirror {
        position: relative;
    }

    .ProseMirror {
        word-wrap: break-word;
        white-space: pre-wrap;
        white-space: break-spaces;
        -webkit-font-variant-ligatures: none;
        font-variant-ligatures: none;
        font-feature-settings: 'liga' 0; /* the above doesn't seem to work in Edge */
    }

    .ProseMirror pre {
        white-space: pre-wrap;
    }

    .ProseMirror li {
        position: relative;
    }

    .ProseMirror-hideselection *::selection {
        background: transparent;
    }
    .ProseMirror-hideselection *::-moz-selection {
        background: transparent;
    }
    .ProseMirror-hideselection {
        caret-color: transparent;
    }

    .ProseMirror-selectednode {
        outline: 2px solid #8cf;
    }

    /* Make sure li selections wrap around markers */

    li.ProseMirror-selectednode {
        outline: none;
    }

    li.ProseMirror-selectednode:after {
        content: '';
        position: absolute;
        left: -32px;
        right: -2px;
        top: -2px;
        bottom: -2px;
        border: 2px solid #8cf;
        pointer-events: none;
    }
`,Xx={typography:["Roboto","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue","Helvetica","Arial","Lucida Grande","sans-serif"],code:["Consolas","Monaco","Andale Mono","Ubuntu Mono","monospace"]},Zx={radius:"4px",lineWidth:"1px"};sg({font:Xx,size:Zx,color:Kx,mixin:Wx,slots:()=>({icon:e=>{const t=document.createElement("span");return t.className="icon material-icons material-icons-outlined",t.textContent=Gx[e],t}}),global:e=>{Gv`
            ${Qx};
            ${Ux(e)}
        `}});const Yx={h1:"h1",h2:"h2",h3:"h3",loading:"loading",quote:"quote",code:"code",table:"table",divider:"line",image:"image",brokenImage:"image",bulletList:"unorder-list",orderedList:"order-list",taskList:"checklist",bold:"bold",italic:"italic",inlineCode:"code",strikeThrough:"text-delete",link:"link",leftArrow:"arrow-left",rightArrow:"arrow-right",upArrow:"arrow-up",downArrow:"arrow-down",alignLeft:"align-left",alignRight:"align-right",alignCenter:"align-center",delete:"delete",select:"select-all",unchecked:"unchecked",checked:"checked"};var eS=sg({font:Xx,size:Zx,color:Kx,mixin:Wx,slots:()=>({icon:e=>{const t=document.createElement("span");return t.className=`icon ed-icon icon-${Yx[e]}`,t}}),global:e=>{Gv`
          ${Qx};
          ${Ux(e)}
      `}});const tS=e({props:{enableTooltip:{type:Boolean,default:!1},enableSlash:{type:Boolean,default:!1},enableHistory:{type:Boolean,default:!1},enablePrism:{type:Boolean,default:!1},enableClipboard:{type:Boolean,default:!1},markdown:{type:String,default:""},textColor:{type:String,default:"#494e59"},fontSize:{type:Number,default:16}},emits:["change"],setup(e,{expose:d,emit:p}){const h=e;t((t=>({"2a471791":e.textColor,"5444bbd5":f(m)})));const m=n((()=>g(h.textColor,50))),v=r(),y=r(!0);o((()=>{w()}));let b="";const w=async()=>{const e=hg.make().config((e=>{e.set(Sm,v.value),e.set(um,h.markdown),e.set(xm,{editable:()=>!0}),e.set(By,{markdown:[e=>{b=e(),p("change",b)}]})})).use(eS).use(_y).use(Vx).use(Ly);if(h.enableTooltip){const{tooltip:t}=await i((()=>import("./index.57121718.js")),["assets/index.57121718.js","assets/index.78b2041b.js","assets/index.cb91438e.css","assets/color.556e4bcb.js"]);e.use(t)}if(h.enableSlash){const{slash:t}=await i((()=>import("./index.be295755.js")),["assets/index.be295755.js","assets/index.78b2041b.js","assets/index.cb91438e.css","assets/color.556e4bcb.js"]);e.use(t)}if(h.enablePrism){const{prism:t}=await i((()=>import("./index.bd31cd31.js")),["assets/index.bd31cd31.js","assets/index.78b2041b.js","assets/index.cb91438e.css","assets/color.556e4bcb.js"]);k(),e.use(t)}if(h.enableHistory){const{history:t}=await i((()=>import("./index.5d77d7c3.js")),["assets/index.5d77d7c3.js","assets/index.78b2041b.js","assets/index.cb91438e.css","assets/color.556e4bcb.js"]);e.use(t)}if(h.enableClipboard){const{clipboard:t}=await i((()=>import("./index.5e25bce6.js")),["assets/index.5e25bce6.js","assets/index.78b2041b.js","assets/index.cb91438e.css","assets/color.556e4bcb.js"]);e.use(t)}e.create()},k=()=>{const e=document.querySelector("#prism-theme");if(e)return e;const t=document.createElement("link");t.id="prism-theme",t.setAttribute("rel","stylesheet"),t.setAttribute("href","https://unpkg.com/prism-themes/themes/prism-material-light.css"),document.head.appendChild(t)};return d({update:async()=>{y.value=!1,await u(),y.value=!0,await u(),w()}}),(t,n)=>y.value?(s(),a("div",{key:0,ref:(e,t)=>{t.editorRef=e,v.value=e},class:"milkdown-wrapper",style:c({width:"100%",height:"100%",fontSize:e.fontSize+"px"})},null,4)):l("",!0)}});const nS={class:"wrapper"};var rS=d(e({props:{componentSetting:{type:Object,required:!0},element:{type:Object,required:!0},isAction:{type:Boolean,default:!1}},setup(e){const t=e,o=p(),i=n((()=>o.state.isLock)),l=r();h((()=>t.componentSetting.enableTooltip),(()=>l.value.update())),h((()=>t.componentSetting.enableSlash),(()=>l.value.update())),h((()=>t.componentSetting.enablePrism),(()=>l.value.update())),h((()=>t.componentSetting.enableHistory),(()=>l.value.update())),h((()=>t.componentSetting.enableClipboard),(()=>l.value.update()));const u=e=>{const n=JSON.parse(JSON.stringify(v(t.element)));t.isAction?(n.actionSetting.actionClickValue.componentSetting.markdown=e,o.commit("updateActionElement",n)):n.componentSetting.markdown=e,o.commit("editComponent",n)};return(t,n)=>(s(),a("div",nS,[m(tS,{ref:(e,t)=>{t.milkdown=e,l.value=e},style:c({padding:e.componentSetting.padding+"px",fontFamily:e.componentSetting.fontFamily,pointerEvents:f(i)?"auto":"none"}),textColor:e.componentSetting.textColor,fontSize:e.componentSetting.textFontSize,enableTooltip:e.componentSetting.enableTooltip,enableSlash:e.componentSetting.enableSlash,enableHistory:e.componentSetting.enableHistory,enablePrism:e.componentSetting.enablePrism,enableClipboard:e.componentSetting.enableClipboard,markdown:e.componentSetting.markdown,onChange:u},null,8,["style","textColor","fontSize","enableTooltip","enableSlash","enableHistory","enablePrism","enableClipboard","markdown"])]))}}),[["__scopeId","data-v-1f0ba506"]]),oS=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:rS});export{Gy as A,Wy as B,Ml as C,yi as D,ot as E,Bn as F,_h as G,sm as H,ey as I,oS as J,Ng as M,on as P,U as S,_t as T,_g as W,C as a,Em as b,Tm as c,Yg as d,Bi as e,Li as f,zg as g,Ag as h,Ix as i,Mg as j,Tg as k,_i as l,Qv as m,tn as n,Gg as o,Mh as p,uy as q,_x as r,Ih as s,ig as t,Fg as u,px as v,Vg as w,Xg as x,hi as y,Pi as z};
