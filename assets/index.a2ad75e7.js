var e=Object.defineProperty,n=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(n,t,a)=>t in n?e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[t]=a,o=(e,o)=>{for(var l in o||(o={}))t.call(o,l)&&i(e,l,o[l]);if(n)for(var l of n(o))a.call(o,l)&&i(e,l,o[l]);return e};import{_ as l,d as c,u as s,r,N as u,H as p,I as d,l as h,g as m,R as g,y as v,x as y,h as S,w as k,J as w,U as b,V as f,p as C,W as I,O as x,o as T,X as E,F as L,n as A,L as O,A as B,B as H,v as K}from"./index.b595840a.js";import{g as j}from"./images.4178b0a2.js";const N=c({name:"Search",props:{componentSetting:{type:Object,required:!0},element:{type:Object,required:!0},isAction:{type:Boolean,default:!1}},setup(e){const n=s(),t=r(0),a=r(!1),i=r(""),o=r([]),l=r(-1),c=r(!1),h=r(),m=u((()=>e.componentSetting.engineList[t.value]||e.componentSetting.engineList[0]));let g;const v=()=>{e.componentSetting.rememberHistory&&function(t){const a=JSON.parse(JSON.stringify(e.element)),i=a.componentSetting.rememberHistoryList||[];~i.indexOf(t)||(i.unshift(t),i.length>10&&(i.length=10),e.isAction?(a.actionSetting.actionClickValue.componentSetting.rememberHistoryList=i,n.dispatch("updateActionElement",a)):a.componentSetting.rememberHistoryList=i,n.dispatch("editComponent",a))}(i.value);let t=m.value.link;/\[0\]/.test(t)?t=t.replace(/\[0\]/,encodeURIComponent(i.value)):t+=encodeURIComponent(i.value),2===e.componentSetting.jumpType?window.location.href=t:window.open(t),i.value="",o.value=[],h.value.blur()},y=u((()=>e.componentSetting.focusBgAnimation&&n.state.global.background.includes("url")));async function S(){if(!i.value)return e.componentSetting.rememberHistory?o.value=e.componentSetting.rememberHistoryList||[]:o.value=[],void(l.value=-1);if(e.componentSetting.keywordLink)try{const e=await fetch(`${I}/getAutomatedKeywords?s=${i.value}`),{errCode:n,data:t}=await e.json();if(200!==n)throw new Error("403");c.value=!1,i.value&&(o.value=t)}catch(n){o.value=[],l.value=-1}}const k=r();function w(e){a.value&&!k.value.contains(e.target)&&(a.value=!1)}p((()=>{c.value=e.element.showTabTips,document.addEventListener("click",w)})),d((()=>{document.removeEventListener("click",w)}));const b=u((()=>x(e.componentSetting.position)));return{activeEngine:t,showEngine:a,searchKey:i,linkSearchArr:o,linkSearchArrActive:l,showTabTips:c,activeEngineItem:m,handleChangeEngine:e=>{t.value=e,a.value=!1},handleInputKeyDown:n=>{[9,13,38,40].includes(n.keyCode)?(9===n.keyCode&&(n.shiftKey?(t.value=t.value<=0?e.componentSetting.engineList.length-1:--t.value,n.preventDefault()):(t.value=t.value>=e.componentSetting.engineList.length-1?0:++t.value,n.preventDefault())),13===n.keyCode&&v(),38===n.keyCode&&(l.value=l.value<=0&&o.value.length>0?o.value.length-1:l.value-1,i.value=o.value[l.value]),40===n.keyCode&&(l.value=l.value<o.value.length-1&&o.value.length>0?l.value+1:0,i.value=o.value[l.value])):(g&&window.clearTimeout(g),g=window.setTimeout((()=>{S()}),400))},handleInputFocus:()=>{S(),e.componentSetting.showTabTips&&(e.componentSetting.rememberHistory&&0!==e.componentSetting.rememberHistoryList.length||(c.value=!0)),y.value&&n.dispatch("updateState",{key:"showBackgroundEffect",value:!0})},handleInputBlur:()=>{setTimeout((()=>{c.value=!1}),200),o.value=[],y.value&&n.dispatch("updateState",{key:"showBackgroundEffect",value:!1})},hanldeNoShowMore:()=>{c.value=!1;const t=JSON.parse(JSON.stringify(e.element));e.isAction?(t.actionSetting.actionClickValue.componentSetting.showTabTips=!1,n.dispatch("updateActionElement",t)):t.componentSetting.showTabTips=!1,n.dispatch("editComponent",t)},handleClear:()=>{i.value=""},handleLinkSearchJump:e=>{o.value=[],l.value=-1,i.value=e,setTimeout((()=>{v()}),200)},handleSearchBtnClick:v,searchInput:h,engineSelecotr:k,positionCSS:b,getTargetIcon:j,clearHistory:function(){const t=JSON.parse(JSON.stringify(e.element));e.isAction?(t.actionSetting.actionClickValue.componentSetting.rememberHistoryList=[],n.dispatch("updateActionElement",t)):t.componentSetting.rememberHistoryList=[],n.dispatch("editComponent",t)},contextmenu:e=>{n.state.isLock&&e.stopPropagation()}}}}),J=e=>(B("data-v-07824292"),e=e(),H(),e),U=["src"],P=["src"],R={key:2,class:"no-icon"},_={class:"engine-selecotr",ref:"engineSelecotr"},D=["onClick"],F=["src"],M=["src"],V={key:2,class:"no-icon"},$={class:"text"},z={class:"search-input-box-wrapper"},W=[J((()=>m("path",{d:"M519.02036023 459.47959989L221.8941505 162.35411435a37.07885742 37.07885742 0 1 0-52.45354772 52.40502656l297.12476134 297.15010821L169.44060278 809.05863314a37.07885742 37.07885742 0 1 0 52.42964924 52.42892505l297.15010821-297.12476136 297.15010822 297.12476136a37.07885742 37.07885742 0 1 0 52.42892504-52.40430237l-297.12476135-297.1740067 297.12476135-297.12548553a37.07885742 37.07885742 0 1 0-52.42892504-52.42964924L519.04498291 459.47959989z"},null,-1)))],q={key:0,class:"link-search-wrapper"},X=["onClick"],G={key:0,class:"clear-history"},Q=[J((()=>m("i",{class:"el-icon-delete"},null,-1))),K("清空历史记录 ")],Y=[J((()=>m("svg",{viewBox:"0 0 1024 1024",width:"22",height:"22"},[m("path",{d:"M419.405333 0c231.683703 0 419.456512 185.265077 419.456512 413.724553a408.862625 408.862625 0 0 1-101.179298 269.55557l275.748132 280.098278a35.108244 35.108244 0 0 1-0.767673 50.154634 36.336521 36.336521 0 0 1-50.819951-0.716495l-275.49224-279.944743a421.19657 421.19657 0 0 1-266.945482 94.628488C187.823987 827.500285 0 642.235208 0 413.724553 0 185.265077 187.823987 0 419.405333 0z m0 70.932983c-191.918243 0-347.499965 153.483416-347.499965 342.79157 0 189.359333 155.581722 342.842749 347.499965 342.842749s347.551143-153.534594 347.551144-342.842749c0-189.359333-155.581722-342.791571-347.499965-342.79157z"})],-1)))],Z={class:"tab-tooltips"},ee=J((()=>m("div",{class:"main"},"按Tab键可快速切换搜索引擎",-1)));var ne=l(N,[["render",function(e,n,t,a,i,l){return T(),h("div",{class:"wrapper",style:C(o({padding:e.componentSetting.padding+"px"},e.positionCSS))},[m("div",{class:"search-wrapper-box",style:C({boxShadow:e.componentSetting.boxShadow,borderRadius:`${e.componentSetting.boxRadius||4}px`,padding:`0 ${(e.componentSetting.boxRadius||4)/4}px`,background:e.componentSetting.boxBackground,maxWidth:`${e.componentSetting.maxWidth||600}px`}),onContextmenu:n[9]||(n[9]=(...n)=>e.contextmenu&&e.contextmenu(...n))},[m("div",{class:"search-engine-box",onClick:n[0]||(n[0]=g((n=>e.showEngine=!e.showEngine),["stop"]))},["local"===e.activeEngineItem.iconType||"network"===e.activeEngineItem.iconType?(T(),h("img",{key:0,src:e.activeEngineItem.iconPath,alt:"icon",width:"24",height:"24"},null,8,U)):v("",!0),"api"===e.activeEngineItem.iconType?(T(),h("img",{key:1,src:e.getTargetIcon(e.activeEngineItem.link),alt:"icon",width:"24",height:"24"},null,8,P)):v("",!0),"text"===e.activeEngineItem.iconType?(T(),h("div",R,y(e.activeEngineItem.name.slice(0,1)),1)):v("",!0)]),S(w,{name:"fadeInUp"},{default:k((()=>[b(m("div",_,[(T(!0),h(L,null,A(e.componentSetting.engineList,((n,t)=>(T(),h("div",{class:"engine-list-item",key:t,onClick:n=>e.handleChangeEngine(t)},["local"===n.iconType||"network"===n.iconType?(T(),h("img",{key:0,src:n.iconPath,alt:"icon",width:"24",height:"24"},null,8,F)):v("",!0),"api"===n.iconType?(T(),h("img",{key:1,src:e.getTargetIcon(n.link),alt:"icon",width:"24",height:"24"},null,8,M)):v("",!0),"text"===n.iconType?(T(),h("div",V,y(n.name.slice(0,1)),1)):v("",!0),m("div",$,y(n.name),1)],8,D)))),128))],512),[[E,e.showEngine]])])),_:1}),m("div",z,[b(m("input",{class:"search-input-box",ref:"searchInput","onUpdate:modelValue":n[1]||(n[1]=n=>e.searchKey=n),onKeydown:n[2]||(n[2]=g(((...n)=>e.handleInputKeyDown&&e.handleInputKeyDown(...n)),["stop"])),onFocus:n[3]||(n[3]=(...n)=>e.handleInputFocus&&e.handleInputFocus(...n)),onBlur:n[4]||(n[4]=(...n)=>e.handleInputBlur&&e.handleInputBlur(...n)),tabindex:"1"},null,544),[[f,e.searchKey]]),e.searchKey?(T(),h("svg",{key:0,class:"clear-btn icon",onClick:n[5]||(n[5]=(...n)=>e.handleClear&&e.handleClear(...n)),viewBox:"0 0 1024 1024",width:"20",height:"20"},W)):v("",!0),S(w,{name:"fadeInUp"},{default:k((()=>[e.linkSearchArr.length>0?(T(),h("div",q,[(T(!0),h(L,null,A(e.linkSearchArr,((n,t)=>(T(),h("div",{class:O(["link-search-item",{active:e.linkSearchArrActive===t}]),key:n,onClick:t=>e.handleLinkSearchJump(n)},y(n),11,X)))),128)),!e.searchKey&&e.componentSetting.rememberHistory?(T(),h("div",G,[m("div",{class:"clear-history-btn",onClick:n[6]||(n[6]=(...n)=>e.clearHistory&&e.clearHistory(...n))},Q)])):v("",!0)])):v("",!0)])),_:1})]),m("div",{class:"search-btn",onClick:n[7]||(n[7]=(...n)=>e.handleSearchBtnClick&&e.handleSearchBtnClick(...n))},Y),S(w,{name:"fadeInUp"},{default:k((()=>[b(m("div",Z,[ee,m("div",{class:"no-more",onClick:n[8]||(n[8]=g(((...n)=>e.hanldeNoShowMore&&e.hanldeNoShowMore(...n)),["stop"]))},"不再提示")],512),[[E,e.showTabTips]])])),_:1})],36)],4)}],["__scopeId","data-v-07824292"]]);export{ne as default};
