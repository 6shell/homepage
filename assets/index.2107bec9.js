var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,o=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,s=(e,s)=>{for(var i in s||(s={}))t.call(s,i)&&o(e,i,s[i]);if(a)for(var i of a(s))n.call(s,i)&&o(e,i,s[i]);return e};import{m as i,a as r}from"./index.a3032bb1.js";import{d as c,f as l,e as d,w as p,M as u,p as m,h as w,o as h,j as v,s as f,t as y,u as g}from"./element-plus.12542cf9.js";function S(e){return e.includes("风")?["龙卷风","狂爆风","飓风","热带风暴"].includes(e)?"龙卷风":"风":e.includes("霾")||e.includes("雾")?["重","大","浓","沙","尘"].some((t=>e.includes(t)))?"大雾":"小雾":e.includes("雨")?e.includes("雷")?"雷阵雨":e.includes("雪")?"雨夹雪":e.includes("大")||e.includes("暴")?"大雨":"小雨":e.includes("雪")?"雪":e}const b={"晴":"clear-day","少云":"cloudy","晴间多云":"overcast-day","多云":"overcast","阴":"overcast","平静":"overcast","风":"wind","龙卷风":"hurricane","大雾":"fog","小雾":"mist","雷阵雨":"thunderstorms-rain","大雨":"rain","小雨":"drizzle","雨夹雪":"sleet","雪":"snow","热":"high","冷":"low","未知":"new-moon"};var j=c({name:"Weather",props:{componentSetting:{type:Object,required:!0}},setup(e){const t=l((()=>i(e.componentSetting.position))),a=d(""),n=d(""),o=d("https://cdn.jsdelivr.net/gh/leon-kfd/weather-icons/production/line/all/clear-day.svg"),s=d("24"),c=d("未知"),m=async()=>{const e=await fetch(`${r}/tapi/amap/v3/weather/weatherInfo?extensions=base&city=${n.value}`),{status:t,lives:a}=await e.json();if("1"===t){const{weather:e,temperature:t}=a[0];o.value=function(e){const t=S(e)||"未知";return`https://cdn.jsdelivr.net/gh/leon-kfd/weather-icons/production/line/all/${b[t]||"new-moon"}.svg`}(e),c.value=S(e),s.value=t}};return p((()=>[e.componentSetting.weatherMode,e.componentSetting.cityName]),(async()=>{try{if(1===e.componentSetting.weatherMode){const e=await fetch(`${r}/tapi/amap/v3/ip`),{status:t,adcode:o,city:s}=await e.json();"1"===t&&(a.value=s.replace(/[市城区]/g,""),n.value=o)}else{const t=await fetch(`${r}/tapi/amap/v3/config/district?keywords=${e.componentSetting.cityName}&subdistrict=0`),{status:o,districts:s}=await t.json();if("1"===o&&s.length>0){const e=s.find((e=>"city"===e.level)),{adcode:t,name:o}=e;a.value=o.replace(/[市城区]/g,""),n.value=t}}}catch(t){u({title:"提示",type:"error",message:"无法识别出城市，请重新配置"})}m()}),{immediate:!0}),{positionCSS:t,cityName:a,adcode:n,weatherIcon:o,weatherText:c,temperature:s}}});const x=g();m("data-v-7d0819b0");const O={class:"weather-box"},$={class:"weather-icon-wrapper"},I={class:"weather-text-wrapper"},z={class:"temperature"},N={class:"city"};w();const k=x(((e,t,a,n,o,i)=>(h(),v("div",{class:"wrapper",style:s({fontSize:e.componentSetting.baseFontSize+"px",color:e.componentSetting.textColor,textShadow:e.componentSetting.textShadow,padding:e.componentSetting.padding+"px",fontFamily:e.componentSetting.fontFamily},e.positionCSS)},[f("div",O,[f("div",$,[f("img",{src:e.weatherIcon,style:{filter:`drop-shadow(${e.componentSetting.iconShadow})`},alt:"weather icon"},null,12,["src"])]),f("div",I,[f("div",z,y(e.temperature)+"°",1),f("div",N,y(e.cityName)+" | "+y(e.weatherText),1)])])],4))));j.render=k,j.__scopeId="data-v-7d0819b0";export default j;
