var e=Object.defineProperty,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,i=(n,a,t)=>a in n?e(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t,l=(e,l)=>{for(var o in l||(l={}))a.call(l,o)&&i(e,o,l[o]);if(n)for(var o of n(l))t.call(l,o)&&i(e,o,l[o]);return e};import{_ as o,d as c,u as s,r,c as u,f as d,e as h,a as v,g as p,h as g,b as m,t as w,i as y,j as k,T as S,k as f,v as b,n as C,l as I,m as T,o as E,p as x,F as L,q as j,s as B,x as K,y as A}from"./index.c10b2fd2.js";import{g as O}from"./images.08fe8d74.js";const U=c({name:"Search",props:{componentSetting:{type:Object,required:!0}},setup(e){const n=s(),a=r(0),t=r(!1),i=r(""),l=r([]),o=r(-1),c=r(!1),v=u((()=>e.componentSetting.engineList[a.value]||e.componentSetting.engineList[0]));let p;const g=()=>{let n=v.value.link;/\[0\]/.test(n)?n=n.replace(/\[0\]/,encodeURIComponent(i.value)):n+=encodeURIComponent(i.value),2===e.componentSetting.jumpType?window.location.href=n:window.open(n),i.value=""};async function m(){if(e.componentSetting.keywordLink){if(!i.value)return l.value=[],void(o.value=-1);try{const e=await fetch(`${I}/getAutomatedKeywords?s=${i.value}`),{errCode:n,data:a}=await e.json();if(200!==n)throw new Error("403");c.value=!1,l.value=a}catch(n){l.value=[],o.value=-1}}}const w=r();function y(e){t.value&&!w.value.contains(e.target)&&(t.value=!1)}d((()=>{document.addEventListener("click",y)})),h((()=>{document.removeEventListener("click",y)}));const k=u((()=>T(e.componentSetting.position)));return{activeEngine:a,showEngine:t,searchKey:i,linkSearchArr:l,linkSearchArrActive:o,showTabTips:c,activeEngineItem:v,handleChangeEngine:e=>{a.value=e,t.value=!1},handleInputKeyDown:n=>{[9,13,38,40].includes(n.keyCode)?(9===n.keyCode&&(n.shiftKey?(a.value=a.value<=0?e.componentSetting.engineList.length-1:--a.value,n.preventDefault()):(a.value=a.value>=e.componentSetting.engineList.length-1?0:++a.value,n.preventDefault())),13===n.keyCode&&g(),38===n.keyCode&&(o.value=o.value<=0&&l.value.length>0?l.value.length-1:o.value-1,i.value=l.value[o.value]),40===n.keyCode&&(o.value=o.value<l.value.length-1&&l.value.length>0?o.value+1:0,i.value=l.value[o.value])):(p&&window.clearTimeout(p),p=window.setTimeout((()=>{m()}),400))},handleInputFocus:()=>{m(),e.componentSetting.showTabTips&&(c.value=!0)},handleInputBlur:()=>{setTimeout((()=>{c.value=!1}),200),l.value=[]},hanldeNoShowMore:()=>{c.value=!1,n.commit("updateSearchShowTabTips",!1)},handleClear:()=>{i.value=""},handleLinkSearchJump:e=>{l.value=[],o.value=-1,i.value=e,setTimeout((()=>{g()}),200)},handleSearchBtnClick:g,engineSelecotr:w,positionCSS:k,getTargetIcon:O}}}),_=e=>(K("data-v-36101d52"),e=e(),A(),e),D=["src"],F=["src"],M={key:2,class:"no-icon"},P={class:"engine-selecotr",ref:"engineSelecotr"},z=["onClick"],N=["src"],q=["src"],J={key:2,class:"no-icon"},R={class:"text"},$={class:"search-input-box-wrapper"},V=[_((()=>p("path",{d:"M519.02036023 459.47959989L221.8941505 162.35411435a37.07885742 37.07885742 0 1 0-52.45354772 52.40502656l297.12476134 297.15010821L169.44060278 809.05863314a37.07885742 37.07885742 0 1 0 52.42964924 52.42892505l297.15010821-297.12476136 297.15010822 297.12476136a37.07885742 37.07885742 0 1 0 52.42892504-52.40430237l-297.12476135-297.1740067 297.12476135-297.12548553a37.07885742 37.07885742 0 1 0-52.42892504-52.42964924L519.04498291 459.47959989z"},null,-1)))],G={key:0,class:"link-search-wrapper"},H=["onClick"],Q=[_((()=>p("svg",{viewBox:"0 0 1024 1024",width:"22",height:"22"},[p("path",{d:"M419.405333 0c231.683703 0 419.456512 185.265077 419.456512 413.724553a408.862625 408.862625 0 0 1-101.179298 269.55557l275.748132 280.098278a35.108244 35.108244 0 0 1-0.767673 50.154634 36.336521 36.336521 0 0 1-50.819951-0.716495l-275.49224-279.944743a421.19657 421.19657 0 0 1-266.945482 94.628488C187.823987 827.500285 0 642.235208 0 413.724553 0 185.265077 187.823987 0 419.405333 0z m0 70.932983c-191.918243 0-347.499965 153.483416-347.499965 342.79157 0 189.359333 155.581722 342.842749 347.499965 342.842749s347.551143-153.534594 347.551144-342.842749c0-189.359333-155.581722-342.791571-347.499965-342.79157z"})],-1)))],W={class:"tab-tooltips"},X=_((()=>p("div",{class:"main"},"按Tab键可快速切换搜索引擎",-1)));var Y=o(U,[["render",function(e,n,a,t,i,o){return E(),v("div",{class:"wrapper",style:C(l({padding:e.componentSetting.padding+"px"},e.positionCSS))},[p("div",{class:"search-wrapper-box",style:C({boxShadow:e.componentSetting.boxShadow,background:e.componentSetting.boxBackground})},[p("div",{class:"search-engine-box",onClick:n[0]||(n[0]=g((n=>e.showEngine=!e.showEngine),["stop"]))},["local"===e.activeEngineItem.iconType||"network"===e.activeEngineItem.iconType?(E(),v("img",{key:0,src:e.activeEngineItem.iconPath,alt:"icon",width:"24",height:"24"},null,8,D)):m("",!0),"api"===e.activeEngineItem.iconType?(E(),v("img",{key:1,src:e.getTargetIcon(e.activeEngineItem.link),alt:"icon",width:"24",height:"24"},null,8,F)):m("",!0),"text"===e.activeEngineItem.iconType?(E(),v("div",M,w(e.activeEngineItem.name.slice(0,1)),1)):m("",!0)]),y(S,{name:"fadeInUp"},{default:k((()=>[f(p("div",P,[(E(!0),v(L,null,j(e.componentSetting.engineList,((n,a)=>(E(),v("div",{class:"engine-list-item",key:a,onClick:n=>e.handleChangeEngine(a)},["local"===n.iconType||"network"===n.iconType?(E(),v("img",{key:0,src:n.iconPath,alt:"icon",width:"24",height:"24"},null,8,N)):m("",!0),"api"===n.iconType?(E(),v("img",{key:1,src:e.getTargetIcon(n.link),alt:"icon",width:"24",height:"24"},null,8,q)):m("",!0),"text"===n.iconType?(E(),v("div",J,w(n.name.slice(0,1)),1)):m("",!0),p("div",R,w(n.name),1)],8,z)))),128))],512),[[x,e.showEngine]])])),_:1}),p("div",$,[f(p("input",{class:"search-input-box","onUpdate:modelValue":n[1]||(n[1]=n=>e.searchKey=n),onKeydown:n[2]||(n[2]=g(((...n)=>e.handleInputKeyDown&&e.handleInputKeyDown(...n)),["stop"])),onFocus:n[3]||(n[3]=(...n)=>e.handleInputFocus&&e.handleInputFocus(...n)),onBlur:n[4]||(n[4]=(...n)=>e.handleInputBlur&&e.handleInputBlur(...n)),tabindex:"-1"},null,544),[[b,e.searchKey]]),e.searchKey?(E(),v("svg",{key:0,class:"clear-btn icon",onClick:n[5]||(n[5]=(...n)=>e.handleClear&&e.handleClear(...n)),viewBox:"0 0 1024 1024",width:"20",height:"20"},V)):m("",!0),y(S,{name:"fadeInUp"},{default:k((()=>[e.linkSearchArr.length>0?(E(),v("div",G,[(E(!0),v(L,null,j(e.linkSearchArr,((n,a)=>(E(),v("div",{class:B(["link-search-item",{active:e.linkSearchArrActive===a}]),key:n,onClick:a=>e.handleLinkSearchJump(n)},w(n),11,H)))),128))])):m("",!0)])),_:1})]),p("div",{class:"search-btn",onClick:n[6]||(n[6]=(...n)=>e.handleSearchBtnClick&&e.handleSearchBtnClick(...n))},Q),y(S,{name:"fadeInUp"},{default:k((()=>[f(p("div",W,[X,p("div",{class:"no-more",onClick:n[7]||(n[7]=g(((...n)=>e.hanldeNoShowMore&&e.hanldeNoShowMore(...n)),["stop"]))},"不再提示")],512),[[x,e.showTabTips]])])),_:1})],4)],4)}],["__scopeId","data-v-36101d52"]]);export{Y as default};
